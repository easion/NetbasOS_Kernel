#ifndef lint
static const char ipf_yysccsid[] = "@(#)yaccpar	1.9 (Berkeley) 02/21/93";
#endif

#include <stdlib.h>

#define YYBYACC 1
#define YYMAJOR 1
#define YYMINOR 9
#define YYPATCH 20050813

#define YYEMPTY (-1)
#define ipf_yyclearin    (ipf_yychar = YYEMPTY)
#define ipf_yyerrok      (ipf_yyerrflag = 0)
#define YYRECOVERING (ipf_yyerrflag != 0)

extern int ipf_yyparse(void);

static int ipf_yygrowstack(void);
#define YYPREFIX "ipf_yy"
#line 7 "../tools/ipf_y.y"
#include "ipf.h"
#include <sys/ioctl.h>
#include <syslog.h>
#ifdef IPFILTER_BPF
# include "pcap-bpf.h"
# define _NET_BPF_H_
# include <pcap.h>
#endif
#include "netinet/ip_pool.h"
#include "netinet/ip_htable.h"
#include "netinet/ipl.h"
#include "ipf_l.h"

#define	YYDEBUG	1
#define	DOALL(x)	for (fr = frc; fr != NULL; fr = fr->fr_next) { x }
#define	DOREM(x)	for (; fr != NULL; fr = fr->fr_next) { x }

extern	void	ipf_yyerror __P((char *));
extern	int	ipf_yyparse __P((void));
extern	int	ipf_yylex __P((void));
extern	int	ipf_yydebug;
extern	FILE	*ipf_yyin;
extern	int	ipf_yylineNum;

static	void	newrule __P((void));
static	void	setipftype __P((void));
static	u_32_t	lookuphost __P((char *));
static	void	dobpf __P((int, char *));
static	void	resetaddr __P((void));
static	struct	alist_s	*newalist __P((struct alist_s *));
static	u_int	makehash __P((struct alist_s *));
static	int	makepool __P((struct alist_s *));
static	frentry_t *addrule __P((void));
static	void	setsyslog __P((void));
static	void	unsetsyslog __P((void));
static	void	fillgroup __P((frentry_t *));

frentry_t	*fr = NULL, *frc = NULL, *frtop = NULL, *frold = NULL;

static	int		ifpflag = 0;
static	int		nowith = 0;
static	int		dynamic = -1;
static	int		pooled = 0;
static	int		hashed = 0;
static	int		nrules = 0;
static	int		newlist = 0;
static	int		added = 0;
static	int		ipffd = -1;
static	int		*ipf_yycont = 0;
static	ioctlfunc_t	ipfioctl[IPL_LOGSIZE];
static	addfunc_t	ipfaddfunc = NULL;
static	struct	wordtab ipfwords[95];
static	struct	wordtab	addrwords[4];
static	struct	wordtab	maskwords[5];
static	struct	wordtab icmpcodewords[17];
static	struct	wordtab icmptypewords[16];
static	struct	wordtab ipv4optwords[25];
static	struct	wordtab ipv4secwords[9];
static	struct	wordtab ipv6optwords[9];
static	struct	wordtab logwords[33];

#line 69 "../tools/ipf_y.y"
typedef union	{
	char	*str;
	u_32_t	num;
	struct	in_addr	ipa;
	frentry_t	fr;
	frtuc_t	*frt;
	struct	alist_s	*alist;
	u_short	port;
	struct	{
		u_short	p1;
		u_short	p2;
		int	pc;
	} pc;
	struct	{
		union	i6addr	a;
		union	i6addr	m;
	} ipp;
	union	i6addr	ip6;
	struct	{
		char	*if1;
		char	*if2;
	} ifs;
} YYSTYPE;
#line 108 "y.tab.c"
#define YY_NUMBER 257
#define YY_HEX 258
#define YY_STR 259
#define YY_COMMENT 260
#define YY_CMP_EQ 261
#define YY_CMP_NE 262
#define YY_CMP_LE 263
#define YY_CMP_GE 264
#define YY_CMP_LT 265
#define YY_CMP_GT 266
#define YY_RANGE_OUT 267
#define YY_RANGE_IN 268
#define YY_IPV6 269
#define IPFY_PASS 270
#define IPFY_BLOCK 271
#define IPFY_COUNT 272
#define IPFY_CALL 273
#define IPFY_NOMATCH 274
#define IPFY_RETICMP 275
#define IPFY_RETRST 276
#define IPFY_RETICMPASDST 277
#define IPFY_IN 278
#define IPFY_OUT 279
#define IPFY_QUICK 280
#define IPFY_ON 281
#define IPFY_OUTVIA 282
#define IPFY_INVIA 283
#define IPFY_DUPTO 284
#define IPFY_TO 285
#define IPFY_FROUTE 286
#define IPFY_REPLY_TO 287
#define IPFY_ROUTETO 288
#define IPFY_TOS 289
#define IPFY_TTL 290
#define IPFY_PROTO 291
#define IPFY_HEAD 292
#define IPFY_GROUP 293
#define IPFY_AUTH 294
#define IPFY_PREAUTH 295
#define IPFY_LOG 296
#define IPFY_BODY 297
#define IPFY_FIRST 298
#define IPFY_LEVEL 299
#define IPFY_ORBLOCK 300
#define IPFY_LOGTAG 301
#define IPFY_MATCHTAG 302
#define IPFY_SETTAG 303
#define IPFY_SKIP 304
#define IPFY_FROM 305
#define IPFY_ALL 306
#define IPFY_ANY 307
#define IPFY_BPFV4 308
#define IPFY_BPFV6 309
#define IPFY_POOL 310
#define IPFY_HASH 311
#define IPFY_PPS 312
#define IPFY_ESP 313
#define IPFY_AH 314
#define IPFY_WITH 315
#define IPFY_AND 316
#define IPFY_NOT 317
#define IPFY_NO 318
#define IPFY_OPT 319
#define IPFY_TCPUDP 320
#define IPFY_TCP 321
#define IPFY_UDP 322
#define IPFY_FLAGS 323
#define IPFY_MULTICAST 324
#define IPFY_MASK 325
#define IPFY_BROADCAST 326
#define IPFY_NETWORK 327
#define IPFY_NETMASKED 328
#define IPFY_PEER 329
#define IPFY_PORT 330
#define IPFY_NOW 331
#define IPFY_ICMP 332
#define IPFY_ICMPTYPE 333
#define IPFY_ICMPCODE 334
#define IPFY_IPOPTS 335
#define IPFY_SHORT 336
#define IPFY_NAT 337
#define IPFY_BADSRC 338
#define IPFY_LOWTTL 339
#define IPFY_FRAG 340
#define IPFY_MBCAST 341
#define IPFY_BAD 342
#define IPFY_BADNAT 343
#define IPFY_OOW 344
#define IPFY_NEWISN 345
#define IPFY_NOICMPERR 346
#define IPFY_KEEP 347
#define IPFY_STATE 348
#define IPFY_FRAGS 349
#define IPFY_LIMIT 350
#define IPFY_STRICT 351
#define IPFY_AGE 352
#define IPFY_SYNC 353
#define IPFY_FRAGBODY 354
#define IPFY_IPOPT_NOP 355
#define IPFY_IPOPT_RR 356
#define IPFY_IPOPT_ZSU 357
#define IPFY_IPOPT_MTUP 358
#define IPFY_IPOPT_MTUR 359
#define IPFY_IPOPT_ENCODE 360
#define IPFY_IPOPT_TS 361
#define IPFY_IPOPT_TR 362
#define IPFY_IPOPT_SEC 363
#define IPFY_IPOPT_LSRR 364
#define IPFY_IPOPT_ESEC 365
#define IPFY_IPOPT_CIPSO 366
#define IPFY_IPOPT_SATID 367
#define IPFY_IPOPT_SSRR 368
#define IPFY_IPOPT_ADDEXT 369
#define IPFY_IPOPT_VISA 370
#define IPFY_IPOPT_IMITD 371
#define IPFY_IPOPT_EIP 372
#define IPFY_IPOPT_FINN 373
#define IPFY_IPOPT_DPS 374
#define IPFY_IPOPT_SDB 375
#define IPFY_IPOPT_NSAPA 376
#define IPFY_IPOPT_RTRALRT 377
#define IPFY_IPOPT_UMP 378
#define IPFY_SECCLASS 379
#define IPFY_SEC_UNC 380
#define IPFY_SEC_CONF 381
#define IPFY_SEC_RSV1 382
#define IPFY_SEC_RSV2 383
#define IPFY_SEC_RSV4 384
#define IPFY_SEC_SEC 385
#define IPFY_SEC_TS 386
#define IPFY_SEC_RSV3 387
#define IPF6_V6HDRS 388
#define IPFY_IPV6OPT 389
#define IPFY_IPV6OPT_DSTOPTS 390
#define IPFY_IPV6OPT_HOPOPTS 391
#define IPFY_IPV6OPT_IPV6 392
#define IPFY_IPV6OPT_NONE 393
#define IPFY_IPV6OPT_ROUTING 394
#define IPFY_IPV6OPT_MOBILITY 395
#define IPFY_IPV6OPT_ESP 396
#define IPFY_IPV6OPT_FRAG 397
#define IPFY_ICMPT_UNR 398
#define IPFY_ICMPT_ECHO 399
#define IPFY_ICMPT_ECHOR 400
#define IPFY_ICMPT_SQUENCH 401
#define IPFY_ICMPT_REDIR 402
#define IPFY_ICMPT_TIMEX 403
#define IPFY_ICMPT_PARAMP 404
#define IPFY_ICMPT_TIMEST 405
#define IPFY_ICMPT_TIMESTREP 406
#define IPFY_ICMPT_INFOREQ 407
#define IPFY_ICMPT_INFOREP 408
#define IPFY_ICMPT_MASKREQ 409
#define IPFY_ICMPT_MASKREP 410
#define IPFY_ICMPT_ROUTERAD 411
#define IPFY_ICMPT_ROUTERSOL 412
#define IPFY_ICMPC_NETUNR 413
#define IPFY_ICMPC_HSTUNR 414
#define IPFY_ICMPC_PROUNR 415
#define IPFY_ICMPC_PORUNR 416
#define IPFY_ICMPC_NEEDF 417
#define IPFY_ICMPC_SRCFAIL 418
#define IPFY_ICMPC_NETUNK 419
#define IPFY_ICMPC_HSTUNK 420
#define IPFY_ICMPC_ISOLATE 421
#define IPFY_ICMPC_NETPRO 422
#define IPFY_ICMPC_HSTPRO 423
#define IPFY_ICMPC_NETTOS 424
#define IPFY_ICMPC_HSTTOS 425
#define IPFY_ICMPC_FLTPRO 426
#define IPFY_ICMPC_HSTPRE 427
#define IPFY_ICMPC_CUTPRE 428
#define IPFY_FAC_KERN 429
#define IPFY_FAC_USER 430
#define IPFY_FAC_MAIL 431
#define IPFY_FAC_DAEMON 432
#define IPFY_FAC_AUTH 433
#define IPFY_FAC_SYSLOG 434
#define IPFY_FAC_LPR 435
#define IPFY_FAC_NEWS 436
#define IPFY_FAC_UUCP 437
#define IPFY_FAC_CRON 438
#define IPFY_FAC_LOCAL0 439
#define IPFY_FAC_LOCAL1 440
#define IPFY_FAC_LOCAL2 441
#define IPFY_FAC_LOCAL3 442
#define IPFY_FAC_LOCAL4 443
#define IPFY_FAC_LOCAL5 444
#define IPFY_FAC_LOCAL6 445
#define IPFY_FAC_LOCAL7 446
#define IPFY_FAC_SECURITY 447
#define IPFY_FAC_FTP 448
#define IPFY_FAC_AUTHPRIV 449
#define IPFY_FAC_AUDIT 450
#define IPFY_FAC_LFMT 451
#define IPFY_FAC_CONSOLE 452
#define IPFY_PRI_EMERG 453
#define IPFY_PRI_ALERT 454
#define IPFY_PRI_CRIT 455
#define IPFY_PRI_ERR 456
#define IPFY_PRI_WARN 457
#define IPFY_PRI_NOTICE 458
#define IPFY_PRI_INFO 459
#define IPFY_PRI_DEBUG 460
#define YYERRCODE 256
short ipf_yylhs[] = {                                        -1,
    0,    0,    0,    0,   34,   34,   37,   35,   38,   36,
   36,   40,   40,   39,   41,   42,   42,   43,   49,   45,
   45,   55,   56,   56,   46,   48,   47,   51,   54,   52,
   52,   53,   53,   53,   53,   53,   53,   53,   53,   53,
   72,   72,   76,   77,   77,   77,   77,   77,   73,   73,
   74,   74,   74,   75,   44,   44,   80,   80,   80,   80,
   80,   80,   80,   50,   50,   88,   88,   88,   88,   88,
   88,   57,   57,   57,   57,   89,   91,   91,   91,   91,
   58,   58,   58,   90,   92,   93,   96,   96,   94,   95,
   95,   59,   59,   97,   60,   64,   64,   64,   63,   63,
   63,   68,   68,  102,  102,  103,  105,  105,  104,   70,
   70,  106,  106,  107,  107,   69,   69,   71,   71,   65,
   65,   67,   67,  108,  109,   81,   82,   83,   83,   83,
   83,  110,  110,   33,   33,  111,  111,   84,   84,   84,
  112,   85,   86,   86,   86,  113,  113,   87,   87,   79,
   79,  114,  114,  114,  114,   78,  117,   99,   99,   99,
   98,   98,   98,  119,  118,  118,  118,  120,  122,   61,
   61,  124,  124,  100,  100,  100,  100,  100,  100,  100,
  100,  100,  126,   12,   12,  128,  121,  121,  121,  129,
  129,  131,  131,  130,  130,  130,  130,  127,  127,  127,
  132,  132,  132,  132,  132,  132,  134,  123,  123,  123,
  135,  135,  137,  137,  136,  136,  136,  136,  133,  133,
  133,  138,  138,  138,  138,  138,  138,   24,   24,   24,
   24,   24,   24,   24,   25,   25,  142,  143,   25,   25,
  144,  145,   25,  141,  141,   20,   20,   20,   20,   20,
   20,   20,   23,   23,   23,   23,   23,   18,   18,   18,
   18,   31,   31,  139,  140,   32,   32,   32,   32,  146,
   16,   16,   17,  147,   30,   29,  101,  101,  148,  148,
  150,  149,  149,  149,  152,  151,  151,  153,  153,   66,
   66,   66,   62,   62,   62,  154,  155,  155,  157,  157,
  158,  158,  159,  156,  156,  160,  160,  161,  161,  161,
  161,  161,  161,  161,    1,    1,  125,  125,  125,  162,
  162,  162,  162,  162,  164,  166,  163,  163,   11,   11,
   11,   11,   11,   11,   11,   11,   11,   11,   11,   11,
   11,   11,   11,  165,   13,   13,  167,   14,   14,    6,
    6,    5,    5,    5,    5,    5,    5,    5,    5,    7,
    7,    7,    7,    7,    7,    7,    7,    7,    7,    7,
    7,    7,    7,    7,    7,    4,    4,    4,    4,    4,
    4,    4,    4,    4,    4,    4,    4,    4,    4,    4,
    4,    4,    8,    8,    8,    8,    8,    8,    8,    8,
    8,    8,    8,    8,    8,    8,    8,    8,    8,    8,
    8,    8,    8,    8,    8,    8,    8,  168,   15,   15,
   15,   15,   15,   15,   15,   15,   15,  115,  116,  116,
    2,    2,    2,    2,    2,    2,    2,    2,    2,    2,
    2,    2,    2,    2,    2,    2,    2,    2,    2,    2,
    2,    2,    2,    3,    3,    3,    3,    3,    3,    3,
    3,    9,    9,    9,    9,    9,    9,   10,   10,   10,
   26,   28,   28,   27,   27,   21,   22,   19,   19,   19,
};
short ipf_yylen[] = {                                         2,
    1,    1,    2,    2,    1,    1,    0,    4,    1,    2,
    2,    0,    1,    7,    7,    3,    4,    1,    1,    1,
    1,    4,    4,    4,    4,    3,    2,    2,    2,    0,
    1,    1,    1,    1,    1,    1,    1,    2,    2,    3,
    1,    2,    1,    1,    2,    1,    2,    1,    1,    2,
    1,    2,    1,    3,    0,    2,    1,    1,    1,    1,
    1,    1,    1,    0,    2,    1,    1,    1,    1,    1,
    1,    0,    2,    2,    4,    1,    1,    1,    3,    3,
    0,    2,    4,    1,    1,    1,    0,    1,    1,    1,
    3,    0,    2,    1,    3,    0,    2,    2,    0,    2,
    2,    0,    4,    1,    3,    1,    3,    3,    3,    0,
    4,    1,    3,    1,    1,    0,    4,    0,    4,    0,
    2,    0,    3,    1,    1,    1,    1,    2,    4,    4,
    4,    1,    3,    1,    3,    1,    3,    2,    4,    4,
    1,    1,    2,    4,    4,    1,    1,    2,    4,    1,
    2,    1,    1,    1,    2,    3,    1,    0,    1,    1,
    1,    1,    3,    1,    4,    2,    2,    1,    1,    0,
    2,    1,    1,    0,    2,    4,    3,    2,    3,    4,
    4,    4,    1,    1,    1,    0,    2,    2,    3,    1,
    3,    1,    3,    0,    1,    1,    4,    1,    1,    4,
    1,    3,    3,    3,    5,    5,    0,    2,    2,    3,
    1,    3,    1,    3,    0,    1,    1,    4,    1,    1,
    4,    1,    3,    3,    3,    5,    5,    3,    3,    5,
    3,    3,    5,    1,    1,    1,    0,    0,    5,    1,
    0,    0,    5,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    3,    1,    1,    1,    2,    3,    4,    1,
    2,    1,    2,    1,    2,    4,    0,    2,    2,    4,
    1,    0,    2,    4,    1,    1,    3,    1,    3,    0,
    2,    4,    0,    3,    3,    2,    2,    2,    0,    3,
    3,    1,    1,    0,    3,    3,    1,    2,    1,    1,
    1,    1,    2,    4,    1,    1,    1,    2,    3,    1,
    2,    2,    3,    2,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    3,    1,    1,    3,    1,
    3,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    2,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    3,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
    1,    1,    3,    1,    1,    3,    3,    3,    1,    1,
};
short ipf_yydefred[] = {                                      0,
    0,    6,    0,    1,    2,    5,    0,    0,    0,    0,
    9,    0,    3,    4,   31,    0,    0,    0,   13,   10,
   11,   18,   19,   55,   64,    0,   29,   33,   43,   36,
    0,   34,    0,   53,    0,    0,   16,   32,   35,   37,
    0,    0,    0,    0,    8,    0,    0,   39,    0,   48,
    0,   52,  152,  153,  428,  154,    0,  150,    0,   38,
   42,   17,  127,    0,    0,  146,  142,    0,  147,   76,
    0,    0,    0,   20,   21,    0,  126,   56,   57,   58,
   59,   60,   61,   62,   63,    0,    0,    0,   66,   67,
   68,   69,   70,   71,   65,    0,   40,  157,   45,    0,
   47,  151,  431,  432,  433,  434,  435,  436,  437,  438,
  439,  440,  445,  446,  447,  448,  449,  450,  451,  452,
  453,  441,  442,  443,  444,  454,  455,  456,  457,  458,
  459,  460,  461,    0,  429,  155,  474,   84,  475,    0,
    0,    0,    0,    0,    0,    0,    0,  172,  173,    0,
    0,    0,   89,    0,    0,   73,   74,    0,    0,    0,
   54,  376,  377,  378,  379,  380,  381,  382,  383,  384,
  385,  386,  387,  388,  389,  390,  391,  392,    0,    0,
    0,    0,    0,    0,  132,    0,  141,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  327,  328,  325,  340,
  341,  329,  330,  331,  334,  335,  336,  339,  332,  333,
  343,  342,  338,  337,  326,  320,    0,  317,    0,    0,
    0,   94,    0,    0,   82,    0,   77,   78,    0,    0,
    0,    0,    0,  156,  430,  473,  135,    0,  131,  130,
   85,   88,  129,    0,   86,    0,  260,  261,  140,  139,
  258,    0,    0,  149,   23,   24,    0,    0,   14,    0,
    0,   27,    0,    0,    0,    0,    0,    0,    0,    0,
  318,  321,    0,  393,  394,  395,  396,  397,  398,  399,
  400,  401,  402,  403,  404,  405,  406,  407,  408,  409,
  410,  411,  412,  413,  414,  415,  416,  418,  345,    0,
  322,    0,  419,  420,  422,  423,  424,  425,  427,  421,
  426,    0,  348,  324,  169,  168,  159,   22,    0,  160,
    0,    0,  161,    0,   93,   90,    0,   75,    0,  145,
  144,    0,   15,    0,   28,    0,  133,    0,    0,    0,
    0,    0,  104,  106,  121,    0,    0,    0,    0,  298,
    0,  296,  297,  294,  295,  101,  100,    0,   25,  319,
  323,    0,  352,  353,  354,  355,  357,  358,  359,  356,
  350,    0,    0,  183,    0,    0,    0,  235,  264,  265,
    0,    0,  190,  234,    0,    0,    0,    0,    0,    0,
    0,  211,    0,  166,    0,    0,  164,    0,   83,    0,
   79,   80,    0,  114,  115,    0,  112,    0,  137,  476,
  477,  478,    0,  103,    0,    0,  124,   26,    0,    0,
  303,    0,    0,  310,  311,    0,  309,    0,  312,    0,
    0,   98,   97,  346,    0,  349,  281,   95,    0,    0,
    0,  185,  184,    0,    0,    0,    0,    0,  192,    0,
    0,    0,    0,    0,  199,  198,  187,    0,    0,    0,
  196,  195,  188,    0,    0,    0,    0,    0,  213,    0,
    0,  220,  219,  208,    0,  217,  216,  209,  163,   91,
    0,  111,    0,    0,  109,  105,    0,    0,  117,  300,
    0,  308,    0,  305,    0,  351,  285,  278,    0,  360,
  361,  362,  363,  364,  365,  366,  367,  368,  369,  370,
  371,  372,  373,  374,  375,  279,    0,    0,  179,  177,
    0,  245,  244,  242,  189,  238,  191,    0,  165,  316,
  471,  275,  315,    0,  462,  463,  465,  467,  464,  466,
  273,  271,    0,    0,    0,  228,  229,    0,  231,  232,
  210,  212,    0,    0,    0,  108,  107,  113,  119,  292,
  125,  123,  301,    0,  306,  283,    0,  286,    0,  180,
  182,  181,  176,    0,    0,  193,    0,    0,  469,  468,
  470,    0,    0,    0,  266,    0,  262,    0,  214,    0,
    0,    0,  314,  288,    0,  280,    0,  253,  254,  255,
  256,  257,  243,    0,  247,  249,  250,  251,  252,  246,
  239,    0,    0,  200,    0,  276,  197,  267,  230,    0,
  233,    0,    0,    0,  221,    0,  218,  284,    0,  287,
  203,  202,    0,    0,  268,  263,  224,  223,    0,  289,
    0,    0,  269,    0,    0,  206,  205,  227,  226,
};
short ipf_yydgoto[] = {                                       3,
  577,  134,  135,  179,  371,  372,  516,  299,  542,  582,
  216,  445,  300,  312,  313,  453,  460,  382,  251,  611,
  252,  253,  603,  392,  384,  533,  140,  141,  461,  462,
  588,  586,  142,    4,    5,    6,    7,   12,    8,   20,
    9,   10,   24,   43,   73,  150,  193,  259,   25,   44,
  232,   17,   37,   18,   74,   75,   76,  154,  223,  318,
  151,  196,  269,  359,  260,  347,  418,  194,  262,  233,
  335,   38,   39,   40,   48,   41,   52,   99,   57,   78,
   79,   80,   81,   82,   83,   84,   85,   95,   86,  393,
  229,  243,  615,  155,  327,  245,  224,  325,  319,  375,
  438,  342,  343,  344,  405,  406,  407,  419,  562,  186,
  239,  188,   87,   58,   59,  136,  100,  320,  398,  321,
  386,  322,  394,  152,  217,  376,  457,  387,  388,  463,
  450,  578,  474,  395,  396,  478,  470,  591,  389,  390,
  524,  448,  575,  446,  574,  458,  459,  439,  498,  440,
  569,  499,  595,  266,  267,  352,  350,  422,  423,  430,
  431,  218,  219,  220,  301,  221,  314,  302,
};
short ipf_yysindex[] = {                                   -139,
   -8,    0, -139,    0,    0,    0,  -45,   12,   12, -128,
    0, -178,    0,    0,    0, -165,  755,  -98,    0,    0,
    0,    0,    0,    0,    0,   28,    0,    0,    0,    0,
 -216,    0,   59,    0, -135,  -73,    0,    0,    0,    0,
   59,  755,  354,  640,    0,  171,  -30,    0,  174,    0,
  174,    0,    0,    0,    0,    0, -135,    0, 3486,    0,
    0,    0,    0,  -23,  -34,    0,    0,  -34,    0,    0,
  114,  116, -106,    0,    0,  -41,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   -1,  -34, -106,    0,    0,
    0,    0,    0,    0,    0,    1,    0,    0,    0, -224,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  225,    0,    0,    0,    0,    0,  222,
  260,  -18,  -34,  255,  255,   69,   78,    0,    0,   62,
    6, 3560,    0,   57,  -22,    0,    0,   30,  255,   67,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,  321,  665,
  151,  -34,  -34,  -34,    0,   50,    0, -140,  102,  256,
  287,  389,  121,  137, -192,  177,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  550,    0,  883, 3594,
 -256,    0, -226, -148,    0,  219,    0,    0,   50,  -52,
  438,  121,  178,    0,    0,    0,    0,  435,    0,    0,
    0,    0,    0,  -34,    0,  436,    0,    0,    0,    0,
    0,  437,  442,    0,    0,    0,  185,  227,    0,  138,
  449,    0,  451,  452,  451,    6,    6, -132,  201, 3560,
    0,    0, 3594,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,  453,
    0,  926,    0,    0,    0,    0,    0,    0,    0,    0,
    0,  454,    0,    0,    0,    0,    0,    0,  172,    0,
  -26,  -17,    0,  455,    0,    0,   50,    0,   53,    0,
    0, -251,    0,  456,    0,  -34,    0,  242,  243,  248,
  445,   64,    0,    0,    0,  250,  386, -251,  162,    0,
 -130,    0,    0,    0,    0,    0,    0,   97,    0,    0,
    0, 3594,    0,    0,    0,    0,    0,    0,    0,    0,
    0,  475, -256,    0,  208,   43,    0,    0,    0,    0,
  447,    0,    0,    0,  595,  257,  214,  214,   38,   41,
  447,    0,  595,    0,  214,  214,    0,  286,    0,  293,
    0,    0,  490,    0,    0,  142,    0,  185,    0,    0,
    0,    0,  296,    0,  185,  507,    0,    0, -139,  144,
    0,  516,  514,    0,    0,  302,    0,  303,    0,  523,
  514,    0,    0,    0,  926,    0,    0,    0,  231,  211,
  519,    0,    0,  127,  542,  -39,  214,  -39,    0,   50,
  -17,    0,  109,  555,    0,    0,    0,  340,  109,  555,
    0,    0,    0,  557,  117,  559,  120,  214,    0,   50,
  555,    0,    0,    0,  555,    0,    0,    0,    0,    0,
  173,    0, -251,  167,    0,    0,  333,  -99,    0,    0,
  162,    0,  553,    0, -130,    0,    0,    0,  107,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0, -232,  163,    0,    0,
  195,    0,    0,    0,    0,    0,    0,  595,    0,    0,
    0,    0,    0,  109,    0,    0,    0,    0,    0,    0,
    0,    0,   24,  109,    9,    0,    0, -194,    0,    0,
    0,    0,  595,  109,  109,    0,    0,    0,    0,    0,
    0,    0,    0,  350,    0,    0, -224,    0,   50,    0,
    0,    0,    0, -184, -174,    0,  -14,   50,    0,    0,
    0,  109,   50, -194,    0,  183,    0,  268,    0,   -7,
   50,   50,    0,    0,   50,    0, -232,    0,    0,    0,
    0,    0,    0,  436,    0,    0,    0,    0,    0,    0,
    0,  109,  109,    0,  109,    0,    0,    0,    0,  186,
    0, -194,  109,  109,    0,  109,    0,    0, -224,    0,
    0,    0,   11, -194,    0,    0,    0,    0,   14,    0,
  109,  109,    0,  109,  109,    0,    0,    0,    0,
};
short ipf_yyrindex[] = {                                    479,
    0,    0,  479,    0,    0,    0,  839, 2975, 2975,    0,
    0,    0,    0,    0,    0,    0,    0,  839,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   39,    0,  981,    0,    0,    0,    0,    0,
   45,    0, 2032, 2032,    0,    0,    0,    0,  111,    0,
  124,    0,    0,    0,    0,    0, 1083,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0, 2907,    0,    0, 1943,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0, 2907,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,  784,
  881, 1180,    0, 1280, 1382,    0,    0,    0,    0, 3300,
 3161,    0,    0, 2097,    0,    0,    0,    0, 1479, 3363,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,  -25,    0,    0,    0,    0,
    0,    0, 3502, 3412,    0, 3224,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0, 2970,    0,    0,    0,
    0,    0, 2316,    0,    0,    0,    0,    0,  166,    0,
    0, 3502, 3474,    0,    0,    0,    0, 1579,    0,    0,
    0,    0,    0,    0,    0,  387,    0,    0,    0,    0,
    0,  508,  684,    0,    0,    0,    0,    0,    0, 3551,
    0,    0, 3033, 3098, 3033, 3161, 3161,    0, 3251,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    3,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,  123,    0,    0,    0,    0,    0,    0, 2535,    0,
  278,  294,    0, 2162,    0,    0,  368,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0, 2878,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,  244,    0,    0, 2754,    0, 1681,    0,    0,    0,
    0, 1778,    0,    0,    0, 2381,    0, 2251,    0,    0,
    0,    0,    0,    0,    0, 2470,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0, 3579,    0,    0,  479,    0,
    0,    0,  -37,    0,    0,    0,    0,    0,    0,    0,
  -20,    0,    0,    0,    0,    0,    0,    0, 2816,    0,
 2600,    0,    0,    0, 2689,    0, 2251,    0,    0,  604,
  294,  312,    0,  179,    0,    0,    0,    0,    0,  179,
    0,    0,    0,    0,    0,    0,    0, 2470,    0,  604,
  179,    0,    0,    0,  179,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,  479,    0,    0,
    0,    0,   54,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0, 2785,    0,
    0,    0,    0,    0,    0,    0,  -31,  191,    0,    0,
    0,    0,  191,    0,    0,    0,    0,    0,    0,  -12,
  191,  191,    0,    0, 2504,    0,    0,    0,    0,    0,
    0,    0,    0, 1878,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   -4,    0,    0,    0,    0,    0,   13,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,
};
short ipf_yygindex[] = {                                    207,
 3246,    0,  448, -471,  192,    0, -481,  267,    0,    0,
  411, -417,    0,    0,  263,    0, -346, -133,   73,    0,
    0,    0,    0, -315, -510,    0,  -53,  467, -335, -319,
    0,    0, -112,   -3,   -2,    0,    0,    0,    0,  628,
    0,    0,    0,    0,  607,  564,    0,  421,    0,    0,
    0,  636,  613,    0,    0,    0,    0,    0,    0,    0,
    0,  190,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,  430,    0,  617,    0,  624,  615,    0,    0,
  625,  626,  641,  642,    0,  643,  644,    0,    0,  -62,
    0, -220, -181,    0,    0, -317,    0,    0,    0,    0,
    0,  292,  298, -302,    0,  353,  224,    0,    0,    0,
  524,  -56,    0,  652,    0,    0,    0,    0,    0,    0,
    0,  325,  264,    0,    0,    0,    0,    0,  337,  272,
    0,  170,    0,    0,  330,  254,    0,  168,    0,    0,
  276,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  461,  236,    0,  234,
    0, -170,    0,  511,  459,    0,    0,    0,
};
#define YYTABLESIZE 3973
short ipf_yytable[] = {                                      13,
   14,  143,  344,  302,  244,  383,  381,  523,  328,  201,
  139,  144,  201,  138,  145,  391,  138,  138,   16,   87,
  307,  139,  138,  158,  500,  561,  520,  566,  222,  404,
  185,  222,  162,  159,  585,  568,  204,  587,  138,  204,
  454,  584,   46,  613,  341,  404,  271,  329,  471,  475,
  624,  455,   11,  225,  250,  254,  225,  303,  315,  472,
  476,  344,  246,  247,  248,  383,  344,  456,  642,  449,
   19,  645,  598,  618,  377,  473,  477,  469,  316,  317,
   26,  581,  604,  605,  465,  403,   45,  467,  189,  444,
  241,   27,  226,  242,  313,  594,  331,  313,  464,  360,
  571,  466,  230,  573,  414,  491,  399,  415,  323,  635,
  324,  636,  378,  495,   47,  630,  246,  247,  248,    1,
    2,  475,  347,  643,  356,  344,  357,  344,  249,  238,
  238,  337,  476,  304,  305,  306,  307,  308,  309,  310,
  311,  599,  600,  601,  602,  400,  138,  263,  477,   22,
   23,  606,  607,  608,  609,  264,  265,  640,   15,    1,
    2,   53,   54,   55,   56,  501,  502,  503,  504,  505,
  506,  507,  508,  509,  510,  511,  512,  513,  514,  515,
  404,  347,  482,   60,  489,  483,  347,  483,  163,  164,
  165,  166,  167,  168,  169,  170,  171,  172,  173,  174,
  175,  176,  177,  178,  246,  247,  248,  559,  148,  149,
  415,   15,  576,   98,  424,  425,  330,   96,  634,  426,
  427,  428,  429,  619,  137,  201,  620,  201,   46,  527,
  246,  247,  248,   87,  225,  137,  146,  589,  147,  246,
  247,  248,  377,  417,  222,  347,  222,  347,  153,  552,
  138,  377,  204,  612,  204,  156,  157,  161,  385,  344,
  623,  344,  344,  183,  184,  246,  247,  248,  528,  225,
  180,  225,  344,  344,  344,  344,  344,  377,  641,  181,
  378,  644,  409,  379,  380,  522,  227,  228,  553,  378,
  579,  580,  379,  380,  344,  344,  344,  344,  344,  441,
  442,  443,  417,  182,  344,  344,  344,  417,  621,  401,
  402,  622,  187,   87,  344,  378,   51,   51,  385,  344,
  344,  344,   41,   41,   87,   87,  344,  190,  344,   87,
   87,   87,   87,   49,   50,   51,  191,  344,  344,  344,
  344,  344,  344,  344,  344,  344,  344,  222,  596,  344,
  344,  344,  195,  432,  344,  433,  344,  614,  246,  247,
  248,  234,  617,  162,  192,  530,  417,  531,  417,  231,
  625,  627,  270,  546,  628,  547,  549,  517,  550,  347,
  255,  347,  347,  519,  442,  443,  259,  597,   44,   44,
  344,  534,  347,  347,  347,  347,  347,  544,  313,  313,
  541,   46,   46,  313,  313,  313,  313,  236,  554,  626,
  626,  256,  555,  629,  347,  347,  347,  347,  347,  570,
  442,  443,   87,   87,  347,  347,  347,  259,  257,  556,
  259,  557,  258,  259,  347,  272,  567,  272,  261,  347,
  347,  347,  246,  247,  248,  259,  347,   87,  347,   87,
  259,  572,  442,  443,  377,  354,  355,  347,  347,  347,
  347,  347,  347,  347,  347,  347,  347,  500,  268,  347,
  347,  347,   77,   77,  347,  326,  347,  332,  336,  334,
  341,  338,  339,  345,   13,   14,  138,  340,  348,  346,
  349,  351,  378,  358,  374,  408,  362,  373,  410,  411,
  417,  397,  417,  417,  412,  413,  416,  480,  417,  259,
  347,  259,  421,  417,  417,  417,  417,  417,  435,  163,
  164,  165,  166,  167,  168,  169,  170,  171,  172,  173,
  174,  175,  176,  177,  178,  417,  417,  417,  417,  417,
  437,  315,    7,  452,  479,  417,  417,  417,  480,  480,
  481,  480,  485,  487,  480,  417,  490,  242,  492,  493,
  417,  417,  417,  494,  497,  518,  480,  417,  274,  417,
  274,  480,  270,  270,  270,  270,  270,  270,  417,  417,
  417,  417,  417,  417,  417,  417,  417,  417,  521,  560,
  417,  417,  417,  270,  138,  417,  545,  417,  548,  564,
  535,  536,  537,  538,  539,  540,  593,  186,  501,  502,
  503,  504,  505,  506,  507,  508,  509,  510,  511,  512,
  513,  514,  515,  207,   87,  488,  496,  235,  434,  272,
  480,  417,  480,   63,   64,  436,   21,   65,   66,   67,
   68,   69,   70,  259,  259,  259,  259,  610,  237,   35,
   88,  160,  333,   42,   62,  259,  259,  259,  259,  259,
  259,   71,   72,   97,   61,  101,  259,  259,   89,   90,
  259,  259,  259,  259,  259,  259,  259,  259,  259,  259,
  259,  259,  259,  479,   91,   92,   93,   94,  259,  259,
  259,  259,  259,  259,  259,  259,  259,  259,  259,  484,
  420,  259,  259,  246,  247,  248,  558,  240,  102,  259,
  451,  259,  486,  583,  529,  377,  259,  447,  525,  259,
  468,  551,  592,  526,  479,  353,  563,  479,  565,  273,
  479,  361,    0,  259,    0,    7,    0,    0,  259,    0,
    0,    0,  479,    0,    0,    0,    0,  479,    7,    7,
    7,    7,    7,  378,    0,    0,  379,  380,    0,    0,
    0,    0,    0,    0,  480,  480,  480,  480,    0,    0,
    0,    0,    7,    7,    7,    0,  480,  480,  480,  480,
  480,  480,    7,  472,    0,    0,    0,  480,  480,    0,
    0,  480,  480,  480,  480,  480,  480,  480,  480,  480,
  480,  480,  480,  480,    0,    0,  479,    0,  479,  480,
  480,  480,  480,  480,  480,  480,  480,  480,  480,  480,
    0,    0,  480,  480,  472,    0,    0,  472,  472,    0,
  480,    0,  480,    0,    0,    0,    0,  480,    0,    0,
  480,    0,  472,    0,    0,    0,    0,  472,    0,    0,
    0,  246,  247,  248,  480,    0,    0,    0,    0,  480,
   87,   87,   87,  377,    0,    0,  197,  198,  199,    0,
    0,    0,   87,  200,    0,  201,    0,    0,    0,    0,
  134,    0,    0,    0,  202,  203,  204,  205,  206,  207,
  208,  209,  210,  211,    0,    0,    0,  212,  213,    0,
    0,  378,    0,  214,  379,  380,  472,    0,  472,    0,
   87,    0,    0,   87,   87,    0,    0,    0,    0,   63,
   64,  134,    0,   65,   66,  134,   68,   69,   70,    0,
    0,    0,    0,    0,    0,   35,    0,  215,    0,  134,
  479,  479,  479,  479,  134,    0,    0,   71,   72,    0,
    0,    0,  479,  479,  479,  479,  479,  479,    0,    0,
    0,    0,    0,  479,  479,    0,    0,  479,  479,  479,
  479,  479,  479,  479,  479,  479,  479,  479,  479,  479,
   49,    0,    0,    0,    0,  479,  479,  479,  479,  479,
  479,  479,  479,  479,  479,  479,    0,    0,  479,  479,
    0,    0,    0,  134,    0,  134,  479,    0,  479,    0,
    0,    0,    0,  479,    0,    0,  479,    0,    0,    0,
    0,    0,    0,    0,   28,   29,   30,   31,   32,    0,
  479,    0,    0,    0,    0,  479,    0,    0,    0,   49,
  472,    0,  472,  472,   49,    0,    0,    0,   33,   34,
   35,    0,    0,  472,  472,  472,  472,  472,   36,    0,
    0,    0,    0,  472,  472,  472,  472,  472,  472,  472,
  472,  472,  472,  472,  472,  472,  472,  472,  472,  472,
    0,    0,   50,    0,    0,  472,  472,  472,  472,  472,
    0,  472,  472,    0,    0,  472,    0,    0,  472,  472,
    0,    0,    0,   49,    0,   49,  472,    0,   30,   30,
   30,   30,   30,    0,    0,    0,  472,  126,  127,  128,
  129,  130,  131,  132,  133,    0,    0,    0,    0,    0,
  472,    0,   30,   30,   30,  472,    0,  134,    0,  134,
  134,   50,   30,    0,    0,    0,   50,    0,    0,    0,
  134,  134,  134,  134,  134,    0,    0,    0,    0,    0,
  134,  134,  134,  134,  134,  134,  134,  134,  134,  134,
  134,  134,  134,  134,  134,  134,  134,    0,    0,  128,
    0,    0,  134,  134,  134,  134,  134,    0,  134,  134,
    0,    0,  134,    0,    0,  134,  134,    0,    0,    0,
    0,  199,    0,  134,    0,   50,  200,   50,  201,    0,
    0,    0,    0,  134,    0,    0,    0,  202,  203,  204,
  205,  206,  207,  208,  209,  210,  211,  134,    0,    0,
  212,  213,  134,    0,    0,    0,  214,   49,  128,   49,
   49,    0,    0,  128,    0,    0,    0,    0,    0,    0,
   49,   49,   49,   49,   49,    0,    0,    0,   49,   49,
   49,   49,    0,    0,   49,   49,   49,   49,   49,   49,
   49,   49,   49,   49,   49,   49,   49,    0,    0,  138,
    0,    0,   49,   49,   49,   49,   49,    0,   49,   49,
    0,    0,   49,    0,    0,   49,   49,    0,    0,    0,
    0,    0,  128,   49,  128,  363,  364,  365,  366,  367,
  368,  369,  370,   49,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   49,    0,    0,
    0,    0,   49,    0,    0,    0,    0,    0,  138,   50,
    0,   50,   50,  138,    0,    0,    0,    0,    0,    0,
    0,    0,   50,   50,   50,   50,   50,    0,    0,    0,
   50,   50,   50,   50,    0,    0,   50,   50,   50,   50,
   50,   50,   50,   50,   50,   50,   50,   50,   50,    0,
    0,  148,    0,    0,   50,   50,   50,   50,   50,    0,
   50,   50,    0,    0,   50,    0,    0,   50,   50,    0,
    0,    0,  138,    0,  138,   50,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   50,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   50,
    0,    0,    0,    0,   50,    0,  128,    0,  128,  128,
  148,    0,    0,    0,    0,  148,    0,    0,    0,  128,
  128,  128,  128,  128,    0,    0,    0,    0,    0,  128,
  128,    0,    0,  128,  128,  128,  128,  128,  128,  128,
  128,  128,  128,  128,  128,  128,    0,    0,  143,    0,
    0,  128,  128,  128,  128,  128,    0,  128,  128,    0,
    0,  128,    0,    0,  128,  128,    0,    0,    0,    0,
    0,    0,  128,    0,  148,    0,  148,    0,    0,    0,
    0,    0,  128,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  128,    0,    0,    0,
    0,  128,    0,    0,    0,    0,  138,  143,  138,  138,
    0,    0,  143,    0,    0,    0,    0,    0,    0,  138,
  138,  138,  138,  138,    0,    0,    0,    0,    0,  138,
  138,    0,    0,  138,  138,  138,  138,  138,  138,  138,
  138,  138,  138,  138,  138,  138,    0,    0,  136,    0,
    0,  138,  138,  138,  138,  138,    0,  138,  138,    0,
    0,  138,    0,    0,  138,  138,    0,    0,    0,    0,
    0,  143,  138,  143,    0,    0,    0,    0,    0,    0,
    0,    0,  138,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  138,    0,    0,    0,
    0,  138,    0,    0,    0,    0,    0,  136,  148,    0,
  148,  148,  136,    0,    0,    0,    0,    0,    0,    0,
    0,  148,  148,  148,  148,  148,    0,    0,    0,    0,
    0,  148,  148,    0,    0,  148,  148,  148,  148,  148,
  148,  148,  148,  148,  148,  148,  148,  148,    0,    0,
  240,    0,    0,  148,  148,  148,  148,  148,    0,  148,
  148,    0,    0,  148,    0,    0,  148,  148,    0,    0,
    0,  136,    0,  136,  148,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  148,    0,    0,    0,    0,    0,
    0,  240,    0,    0,  240,    0,    0,  241,  148,    0,
    0,    0,    0,  148,    0,  143,    0,  143,  143,  240,
    0,    0,    0,    0,  240,    0,    0,    0,  143,  143,
  143,  143,  143,    0,    0,    0,    0,    0,  143,  143,
    0,    0,  143,  143,  143,  143,  143,  143,  143,  143,
  143,  143,  143,  143,  143,    0,    0,  236,    0,    0,
  143,  143,  143,  143,  143,    0,  143,  143,    0,    0,
  143,    0,    0,  143,  143,    0,    0,    0,    0,    0,
    0,  143,    0,  240,    0,  240,    0,    0,    0,    0,
    0,  143,    0,    0,    0,    0,    0,    0,  236,    0,
    0,  236,    0,    0,  237,  143,    0,    0,    0,    0,
  143,    0,    0,    0,    0,  136,  236,  136,  136,    0,
    0,  236,    0,    0,    0,    0,    0,    0,  136,  136,
  136,  136,  136,    0,    0,    0,    0,    0,  136,  136,
    0,    0,  136,  136,  136,  136,  136,  136,  136,  136,
  136,  136,  136,  136,  136,    0,    0,  248,    0,    0,
  136,  136,  136,  136,  136,    0,  136,  136,    0,    0,
  136,    0,    0,  136,  136,    0,    0,    0,    0,    0,
  236,  136,  236,    0,    0,    0,    0,    0,    0,    0,
    0,  136,    0,    0,    0,    0,    0,    0,  248,    0,
    0,  248,    0,    0,    0,  136,    0,    0,    0,    0,
  136,    0,    0,    0,    0,    0,  248,  240,  240,  240,
  240,  248,   81,    0,    0,    0,    0,    0,    0,  240,
  240,  240,  240,  240,  240,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,  240,    0,    0,    0,    0,
    0,    0,  240,  240,  240,  240,  240,    0,    0,    0,
    0,    0,  240,  240,  240,    0,    0,  240,    0,    0,
  240,  240,  240,    0,    0,  240,  240,    0,    0,    0,
  248,   81,  248,  240,    0,  241,   81,    0,    0,    0,
  240,    0,    0,  240,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,  240,    0,    0,
    0,   72,  240,    0,  236,  236,  236,  236,    0,    0,
    0,    0,    0,    0,    0,    0,  236,  236,  236,  236,
  236,  236,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,  236,    0,    0,   81,    0,   81,    0,  236,
  236,  236,  236,  236,    0,    0,    0,    0,    0,  236,
  236,  236,    0,    0,  236,    0,    0,  236,  236,  236,
   72,    0,  236,  236,    0,   72,   92,    0,    0,    0,
  236,    0,  237,    0,    0,    0,    0,  236,    0,    0,
  236,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  236,    0,    0,    0,    0,  236,
    0,    0,    0,    0,  248,  248,  248,  248,    0,    0,
    0,    0,    0,    0,    0,    0,  248,  248,  248,  248,
  248,  248,    0,    0,   72,   92,   72,    0,    0,    0,
   92,  162,  248,    0,    0,    0,    0,    0,    0,  248,
  248,  248,  248,  248,    0,    0,    0,    0,    0,  248,
  248,  248,    0,    0,  248,    0,    0,  248,  248,  248,
    0,    0,  248,  248,    0,    0,    0,    0,    0,   81,
  248,   81,   81,    0,    0,    0,    0,  248,    0,    0,
  248,    0,   81,   81,   81,   81,   81,    0,    0,   92,
  162,   92,    0,    0,  248,  162,    0,   81,    0,  248,
    0,    0,    0,   81,   81,   81,   81,   81,   81,    0,
    0,    0,    0,    0,   81,   81,   81,   81,   81,    0,
  194,    0,    0,    0,   81,    0,    0,   81,   81,    0,
    0,    0,    0,    0,    0,   81,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   81,    0,    0,    0,    0,
    0,    0,    0,    0,  162,    0,  162,    0,   72,   81,
   72,   72,    0,    0,   81,    0,    0,    0,    0,    0,
    0,   72,   72,   72,   72,   72,    0,    0,    0,  194,
    0,    0,    0,    0,  194,  158,    0,    0,    0,    0,
    0,   72,   72,   72,   72,   72,   72,    0,    0,    0,
    0,    0,    0,   72,   72,   72,   72,   72,    0,    0,
    0,    0,    0,   72,    0,    0,   72,   72,    0,    0,
    0,    0,    0,   92,   72,   92,   92,    0,    0,    0,
    0,    0,    0,    0,   72,    0,   92,   92,   92,   92,
   92,    0,    0,  194,  158,  194,    0,    0,   72,  158,
  167,   92,    0,   72,    0,    0,    0,    0,   92,   92,
   92,   92,   92,    0,    0,    0,    0,    0,   92,   92,
   92,   92,   92,    0,    0,    0,    0,    0,   92,    0,
    0,   92,   92,    0,    0,    0,    0,    0,  162,   92,
  162,  162,    0,    0,    0,    0,    0,    0,    0,   92,
    0,  162,  162,  162,  162,  162,    0,    0,  158,  167,
  158,    0,    0,   92,  167,    0,  162,    0,   92,    0,
    0,    0,    0,  162,  162,  162,  162,  162,    0,    0,
    0,    0,    0,  162,  162,  162,  162,  162,    0,  215,
    0,    0,    0,  162,    0,    0,  162,  162,    0,    0,
    0,    0,    0,    0,  162,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  162,    0,    0,    0,    0,    0,
    0,    0,    0,  167,    0,  167,    0,  194,  162,  194,
  194,    0,    0,  162,    0,    0,    0,    0,    0,    0,
  194,  194,  194,  194,  194,    0,    0,    0,  215,    0,
    0,    0,    0,  215,  174,  194,    0,    0,    0,    0,
    0,    0,  194,  194,  194,  194,  194,    0,    0,    0,
    0,    0,  194,  194,  194,    0,    0,    0,    0,    0,
    0,    0,  194,    0,    0,  194,  194,    0,    0,    0,
    0,    0,  158,  194,  158,  158,    0,    0,    0,    0,
    0,    0,    0,  194,    0,  158,  158,  158,  158,  158,
    0,    0,  215,  174,  215,    0,    0,  194,  174,  178,
    0,    0,  194,    0,    0,    0,    0,  158,  158,  158,
  158,  158,    0,    0,    0,    0,    0,  158,  158,  158,
    0,    0,    0,    0,    0,    0,    0,  158,    0,    0,
  158,  158,    0,    0,    0,    0,    0,  167,  158,  167,
  167,    0,    0,    0,    0,    0,    0,    0,  158,    0,
  167,  167,  167,  167,  167,    0,    0,  174,  178,  174,
    0,    0,  158,  178,    0,    0,    0,  158,    0,    0,
    0,    0,  167,  167,  167,  167,  167,    0,    0,    0,
    0,    0,  167,  167,  167,    0,    0,    0,  175,    0,
    0,    0,  167,    0,    0,  167,  167,    0,    0,    0,
    0,    0,    0,  167,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  167,    0,    0,    0,    0,    0,    0,
    0,    0,  178,    0,  178,    0,  215,  167,  215,  215,
    0,    0,  167,    0,    0,    0,    0,    0,    0,  215,
  215,  215,  215,  215,    0,    0,    0,  175,    0,    0,
    0,    0,  175,  277,    0,    0,    0,    0,    0,    0,
   87,  215,  215,  215,  215,  215,    0,    0,    0,    0,
    0,  215,  215,  215,    0,    0,    0,    0,    0,    0,
    0,  215,    0,    0,  215,  215,    0,    0,    0,    0,
    0,  174,  215,  174,  174,    0,    0,    0,    0,    0,
    0,    0,  215,    0,  174,  174,  174,  174,  174,    0,
    0,  175,  277,  175,    0,  282,  215,  277,    0,    0,
    0,  215,    0,    0,    0,    0,  174,  174,  174,  174,
  174,    0,    0,    0,    0,    0,  174,  174,  174,    0,
    0,    0,    0,    0,    0,    0,  174,    0,    0,  174,
  174,    0,    0,    0,    0,    0,  178,    0,  178,  178,
    0,    0,    0,    0,    0,    0,    0,  174,    0,  178,
  178,  178,  178,  178,  282,    0,  277,  122,  277,  282,
    0,  174,    0,    0,    0,    0,  174,    0,    0,    0,
    0,  178,  178,  178,  178,  178,    0,    0,    0,    0,
    0,  178,  178,  178,    0,    0,  170,    0,    0,    0,
    0,  178,    0,    0,  178,  178,   87,   87,   87,   87,
   87,   87,   87,   87,   87,   87,   87,   87,   87,   87,
   87,   87,  178,    0,    0,    0,  122,    0,  282,    0,
  282,  122,    0,    0,    0,  175,  178,  175,  175,    0,
    0,  178,    0,    0,    0,    0,    0,    0,  175,  175,
  175,  175,  175,    0,    0,  170,    0,    0,    0,  171,
  170,    0,    0,    0,   12,    0,    0,    0,    0,    0,
  175,  175,  175,  175,  175,    0,    0,    0,    0,    0,
  175,  175,  175,    0,    0,    0,    0,    0,    0,    0,
  175,    0,  122,  175,  175,    0,    0,    0,    0,    0,
  277,    0,  277,  277,    0,    0,    0,    0,    0,    0,
    0,  175,    0,  277,  277,  277,  277,  277,  171,  170,
    0,  170,  299,  171,    0,  175,    0,    0,   12,    0,
  175,   87,    0,    0,    0,  277,  277,  277,  277,  277,
    0,    0,    0,    0,    0,  277,  277,  277,    0,    0,
    0,    0,    0,    0,    0,  277,    0,    0,  277,  277,
    0,    0,  282,    0,  282,  282,    0,    0,    0,    0,
    0,    0,    0,    0,    0,  282,  282,  282,  282,  282,
    0,  299,  171,    0,  171,    0,  299,  304,    0,   12,
  277,    0,    0,    0,    0,  277,    0,  282,  282,  282,
  282,  282,    0,    0,    0,    0,    0,  282,  282,  282,
    0,    0,    0,    0,    0,    0,    0,  282,    0,    0,
  282,  282,    0,    0,  122,    0,  122,  122,    0,    0,
    0,    0,    0,    0,    0,    0,    0,  122,  122,  122,
  122,  122,    0,    0,    0,  299,  304,  299,    0,    0,
  293,  304,  282,  170,    0,  170,  170,  282,    0,    0,
    0,  122,  122,  122,    0,    0,  170,  170,  170,  170,
  170,  122,   87,   87,   87,   87,   87,   87,   87,   87,
   87,   87,   87,   87,   87,   87,   87,    0,  170,  170,
  170,  170,  170,    0,    0,    0,    0,    0,  170,  170,
  170,    0,    0,    0,    0,    0,    0,    0,  170,  293,
  304,    0,  304,   99,  293,    0,  171,    0,  171,  171,
    0,   12,    0,   12,   12,    0,    0,    0,    0,  171,
  171,  171,  171,  171,   12,   12,   12,   12,   12,    0,
   96,    0,    0,  170,    0,    0,    0,    0,  170,    0,
    0,  171,  171,  171,  171,  171,    0,    0,   12,   12,
   12,  171,  171,  171,    0,    0,    0,    0,   12,    0,
    0,  171,   99,  293,    0,  293,    0,   99,    0,  299,
    0,  299,  299,    0,    0,    0,    0,    0,    0,  102,
    0,    0,  299,  299,  299,  299,  299,    0,    0,   96,
    0,    0,    0,    0,   96,    0,  171,    0,    0,    0,
    0,  171,    0,    0,  299,  299,  299,  299,  299,    0,
    0,    0,    0,    0,  299,  299,  299,    0,    0,    0,
    0,    0,    0,    0,  299,    0,   99,    0,   99,    0,
    0,    0,    0,    0,  304,    0,  304,  304,  102,    0,
    0,    0,  110,  102,    0,    0,    0,  304,  304,  304,
  304,  304,    0,   96,    0,   96,    0,    0,    0,  299,
    0,    0,    0,    0,  299,    0,    0,    0,    0,  304,
  304,  304,  304,  304,    0,    0,    0,    0,    0,  304,
  304,  304,    0,    0,    0,    0,    0,    0,    0,  304,
    0,  116,    0,    0,    0,    0,    0,  293,    0,  293,
  293,  110,  102,    0,  102,    0,  110,    0,    0,    0,
  293,  293,  293,  293,  293,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  304,    0,    0,    0,    0,  304,
    0,    0,  293,  293,  293,  293,  293,    0,    0,    0,
    0,    0,  293,  293,  293,    0,    0,    0,    0,    0,
  116,    0,  293,  118,    0,  116,    0,    0,    0,    0,
   99,    0,   99,   99,    0,  110,    0,  110,    0,    0,
    0,    0,    0,   99,   99,   99,   99,   99,    0,    0,
    0,  120,    0,    0,    0,    0,    0,   96,    0,   96,
   96,    0,  293,    0,    0,    0,   99,   99,   99,   99,
   96,   96,   96,   96,   96,   99,   99,   99,    0,    0,
    0,    0,  118,    0,  116,   99,  116,  118,    0,    0,
    0,    0,    0,    0,   96,   96,   96,    0,    0,    0,
  290,    0,   96,   96,   96,    0,  102,    0,  102,  102,
  120,    0,   96,    0,    0,  120,    0,    0,    0,  102,
  102,  102,  102,  102,    0,   99,    0,    0,  291,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  102,  102,  102,  118,    0,  118,    0,
    0,  102,   96,  102,    0,    0,    0,    0,    0,  290,
    0,  102,    0,    0,  290,    0,    0,    0,    0,  110,
    0,  110,  110,    0,  120,    0,  120,    0,    0,    0,
    0,    0,  110,  110,  110,  110,  110,  291,    0,    0,
    0,    0,  291,    0,    0,    0,    0,    0,    0,    0,
    0,  102,    0,    0,    0,    0,  110,  110,  110,    0,
    0,    0,    0,    0,  110,    0,  110,    0,  116,    0,
  116,  116,    0,  290,  110,  290,    0,    0,    0,    0,
    0,  116,  116,  116,  116,  116,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,  532,    0,
    0,  291,    0,  291,  543,  116,  116,  116,    0,    0,
    0,    0,    0,    0,  110,  116,    0,    0,    0,    0,
    0,    0,    0,  116,    0,    0,    0,    0,    0,    0,
  118,    0,  118,  118,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  118,  118,  118,  118,  118,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,  120,    0,
  120,  120,    0,  116,    0,    0,    0,  118,  118,  118,
    0,  120,  120,  120,  120,  120,    0,  118,    0,    0,
    0,    0,    0,    0,    0,  118,    0,    0,    0,    0,
    0,    0,    0,    0,    0,  120,  120,  120,    0,  590,
  590,    0,    0,    0,    0,  120,    0,  290,    0,  290,
  290,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  290,  290,  290,  290,  290,  118,    0,  616,    0,    0,
    0,    0,    0,    0,    0,  291,    0,  291,  291,    0,
    0,    0,    0,    0,  290,  290,  290,    0,  291,  291,
  291,  291,  291,  120,  290,    0,    0,  631,  632,    0,
  633,    0,    0,    0,    0,    0,    0,    0,  637,  638,
    0,  639,  291,  291,  291,    0,  197,  198,  199,    0,
    0,    0,  291,  200,    0,  201,  646,  647,    0,  648,
  649,    0,    0,    0,  202,  203,  204,  205,  206,  207,
  208,  209,  210,  211,    0,    0,    0,  212,  213,    0,
    0,    0,    0,  214,  103,  104,  105,  106,  107,  108,
  109,  110,  111,  112,  113,  114,  115,  116,  117,  118,
  119,  120,  121,  122,  123,  124,  125,    0,  126,  127,
  128,  129,  130,  131,  132,  133,    0,  215,  274,  275,
  276,  277,  278,  279,  280,  281,  282,  283,  284,  285,
  286,  287,  288,  289,  290,  291,  292,  293,  294,  295,
  296,  297,  298,
};
short ipf_yycheck[] = {                                       3,
    3,   64,    0,   41,  186,  321,   33,   47,  229,   41,
   45,   65,   44,   40,   68,   33,   40,   40,   64,   45,
   41,   45,   40,   86,  257,  125,  444,  499,   41,  332,
  143,   44,  257,   87,  545,  517,   41,  548,   40,   44,
  387,   33,  259,   58,  296,  348,  217,  229,  395,  396,
   58,  387,   61,   41,  188,  189,   44,  314,  285,  395,
  396,   59,  257,  258,  259,  381,   64,  387,   58,  385,
   59,   58,  257,  584,  269,  395,  396,  393,  305,  306,
  259,   58,  257,  258,   47,  337,   59,   47,  145,   47,
   41,  257,  155,   44,   41,  567,  230,   44,   61,  270,
  518,   61,  159,  521,   41,  423,  327,   44,  257,  620,
  259,  622,  307,  431,  331,  597,  257,  258,  259,  259,
  260,  468,    0,  634,  257,  123,  259,  125,  269,  183,
  184,  244,  468,  390,  391,  392,  393,  394,  395,  396,
  397,  326,  327,  328,  329,  327,   40,  340,  468,  278,
  279,  326,  327,  328,  329,  348,  349,  629,  257,  259,
  260,  297,  298,  299,  300,  398,  399,  400,  401,  402,
  403,  404,  405,  406,  407,  408,  409,  410,  411,  412,
  483,   59,   41,  257,   41,   44,   64,   44,  413,  414,
  415,  416,  417,  418,  419,  420,  421,  422,  423,  424,
  425,  426,  427,  428,  257,  258,  259,   41,  315,  316,
   44,  257,  528,   40,  345,  346,  269,   47,   33,  350,
  351,  352,  353,   41,  259,  257,   44,  259,  259,  450,
  257,  258,  259,  259,  257,  259,  123,  553,  123,  257,
  258,  259,  269,    0,  257,  123,  259,  125,  290,  470,
   40,  269,  257,  268,  259,  257,  258,  257,  321,  257,
  268,  259,  260,  282,  283,  257,  258,  259,  450,  257,
   46,  259,  270,  271,  272,  273,  274,  269,  268,   58,
  307,  268,  336,  310,  311,  325,  257,  258,  470,  307,
  267,  268,  310,  311,  292,  293,  294,  295,  296,  257,
  258,  259,   59,   44,  302,  303,  304,   64,   41,  257,
  258,   44,   58,  351,  312,  307,  278,  279,  381,  317,
  318,  319,  278,  279,  345,  346,  324,  259,  326,  350,
  351,  352,  353,  275,  276,  277,  259,  335,  336,  337,
  338,  339,  340,  341,  342,  343,  344,  291,  569,  347,
  348,  349,  347,  257,  352,  259,  354,  578,  257,  258,
  259,   41,  583,  257,  303,  257,  123,  259,  125,  303,
  591,  592,   61,  257,  595,  259,  257,  440,  259,  257,
  125,  259,  260,  257,  258,  259,    0,  569,  278,  279,
  388,  454,  270,  271,  272,  273,  274,  460,  345,  346,
   61,  278,  279,  350,  351,  352,  353,  257,  471,  591,
  592,  125,  475,  595,  292,  293,  294,  295,  296,  257,
  258,  259,  257,  258,  302,  303,  304,   41,   40,  257,
   44,  259,  312,   47,  312,  257,  499,  259,  302,  317,
  318,  319,  257,  258,  259,   59,  324,  257,  326,  259,
   64,  257,  258,  259,  269,  266,  267,  335,  336,  337,
  338,  339,  340,  341,  342,  343,  344,  257,  292,  347,
  348,  349,   43,   44,  352,  257,  354,   40,   44,  302,
  296,   46,   46,  257,  488,  488,   40,   46,   40,  352,
   40,   40,  307,  293,  323,   40,   44,   44,  257,  257,
  257,   47,  259,  260,  257,   61,  257,    0,  123,  123,
  388,  125,  351,  270,  271,  272,  273,  274,   44,  413,
  414,  415,  416,  417,  418,  419,  420,  421,  422,  423,
  424,  425,  426,  427,  428,  292,  293,  294,  295,  296,
  333,  285,   64,  330,  259,  302,  303,  304,   41,  257,
   61,   44,  257,   47,   47,  312,   41,   44,  257,  257,
  317,  318,  319,   41,  334,   47,   59,  324,  257,  326,
  259,   64,  261,  262,  263,  264,  265,  266,  335,  336,
  337,  338,  339,  340,  341,  342,  343,  344,   47,  257,
  347,  348,  349,   44,   40,  352,   40,  354,   40,   47,
  261,  262,  263,  264,  265,  266,  257,  330,  398,  399,
  400,  401,  402,  403,  404,  405,  406,  407,  408,  409,
  410,  411,  412,  330,  257,  419,  435,  180,  362,  219,
  123,  388,  125,  280,  281,  373,    9,  284,  285,  286,
  287,  288,  289,  257,  258,  259,  260,  575,  182,  296,
   44,   88,  232,   18,   42,  269,  270,  271,  272,  273,
  274,  308,  309,   47,   41,   51,  280,  281,   44,   44,
  284,  285,  286,  287,  288,  289,  290,  291,  292,  293,
  294,  295,  296,    0,   44,   44,   44,   44,  302,  303,
  304,  305,  306,  307,  308,  309,  310,  311,  312,  408,
  348,  315,  316,  257,  258,  259,  483,  184,   57,  323,
  386,  325,  415,  544,  451,  269,  330,  381,  447,  333,
  391,  468,  555,  448,   41,  265,  491,   44,  495,  219,
   47,  273,   -1,  347,   -1,  257,   -1,   -1,  352,   -1,
   -1,   -1,   59,   -1,   -1,   -1,   -1,   64,  270,  271,
  272,  273,  274,  307,   -1,   -1,  310,  311,   -1,   -1,
   -1,   -1,   -1,   -1,  257,  258,  259,  260,   -1,   -1,
   -1,   -1,  294,  295,  296,   -1,  269,  270,  271,  272,
  273,  274,  304,    0,   -1,   -1,   -1,  280,  281,   -1,
   -1,  284,  285,  286,  287,  288,  289,  290,  291,  292,
  293,  294,  295,  296,   -1,   -1,  123,   -1,  125,  302,
  303,  304,  305,  306,  307,  308,  309,  310,  311,  312,
   -1,   -1,  315,  316,   41,   -1,   -1,   44,   45,   -1,
  323,   -1,  325,   -1,   -1,   -1,   -1,  330,   -1,   -1,
  333,   -1,   59,   -1,   -1,   -1,   -1,   64,   -1,   -1,
   -1,  257,  258,  259,  347,   -1,   -1,   -1,   -1,  352,
  257,  258,  259,  269,   -1,   -1,  317,  318,  319,   -1,
   -1,   -1,  269,  324,   -1,  326,   -1,   -1,   -1,   -1,
    0,   -1,   -1,   -1,  335,  336,  337,  338,  339,  340,
  341,  342,  343,  344,   -1,   -1,   -1,  348,  349,   -1,
   -1,  307,   -1,  354,  310,  311,  123,   -1,  125,   -1,
  307,   -1,   -1,  310,  311,   -1,   -1,   -1,   -1,  280,
  281,   41,   -1,  284,  285,   45,  287,  288,  289,   -1,
   -1,   -1,   -1,   -1,   -1,  296,   -1,  388,   -1,   59,
  257,  258,  259,  260,   64,   -1,   -1,  308,  309,   -1,
   -1,   -1,  269,  270,  271,  272,  273,  274,   -1,   -1,
   -1,   -1,   -1,  280,  281,   -1,   -1,  284,  285,  286,
  287,  288,  289,  290,  291,  292,  293,  294,  295,  296,
    0,   -1,   -1,   -1,   -1,  302,  303,  304,  305,  306,
  307,  308,  309,  310,  311,  312,   -1,   -1,  315,  316,
   -1,   -1,   -1,  123,   -1,  125,  323,   -1,  325,   -1,
   -1,   -1,   -1,  330,   -1,   -1,  333,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  270,  271,  272,  273,  274,   -1,
  347,   -1,   -1,   -1,   -1,  352,   -1,   -1,   -1,   59,
  257,   -1,  259,  260,   64,   -1,   -1,   -1,  294,  295,
  296,   -1,   -1,  270,  271,  272,  273,  274,  304,   -1,
   -1,   -1,   -1,  280,  281,  282,  283,  284,  285,  286,
  287,  288,  289,  290,  291,  292,  293,  294,  295,  296,
   -1,   -1,    0,   -1,   -1,  302,  303,  304,  305,  306,
   -1,  308,  309,   -1,   -1,  312,   -1,   -1,  315,  316,
   -1,   -1,   -1,  123,   -1,  125,  323,   -1,  270,  271,
  272,  273,  274,   -1,   -1,   -1,  333,  453,  454,  455,
  456,  457,  458,  459,  460,   -1,   -1,   -1,   -1,   -1,
  347,   -1,  294,  295,  296,  352,   -1,  257,   -1,  259,
  260,   59,  304,   -1,   -1,   -1,   64,   -1,   -1,   -1,
  270,  271,  272,  273,  274,   -1,   -1,   -1,   -1,   -1,
  280,  281,  282,  283,  284,  285,  286,  287,  288,  289,
  290,  291,  292,  293,  294,  295,  296,   -1,   -1,    0,
   -1,   -1,  302,  303,  304,  305,  306,   -1,  308,  309,
   -1,   -1,  312,   -1,   -1,  315,  316,   -1,   -1,   -1,
   -1,  319,   -1,  323,   -1,  123,  324,  125,  326,   -1,
   -1,   -1,   -1,  333,   -1,   -1,   -1,  335,  336,  337,
  338,  339,  340,  341,  342,  343,  344,  347,   -1,   -1,
  348,  349,  352,   -1,   -1,   -1,  354,  257,   59,  259,
  260,   -1,   -1,   64,   -1,   -1,   -1,   -1,   -1,   -1,
  270,  271,  272,  273,  274,   -1,   -1,   -1,  278,  279,
  280,  281,   -1,   -1,  284,  285,  286,  287,  288,  289,
  290,  291,  292,  293,  294,  295,  296,   -1,   -1,    0,
   -1,   -1,  302,  303,  304,  305,  306,   -1,  308,  309,
   -1,   -1,  312,   -1,   -1,  315,  316,   -1,   -1,   -1,
   -1,   -1,  123,  323,  125,  380,  381,  382,  383,  384,
  385,  386,  387,  333,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  347,   -1,   -1,
   -1,   -1,  352,   -1,   -1,   -1,   -1,   -1,   59,  257,
   -1,  259,  260,   64,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  270,  271,  272,  273,  274,   -1,   -1,   -1,
  278,  279,  280,  281,   -1,   -1,  284,  285,  286,  287,
  288,  289,  290,  291,  292,  293,  294,  295,  296,   -1,
   -1,    0,   -1,   -1,  302,  303,  304,  305,  306,   -1,
  308,  309,   -1,   -1,  312,   -1,   -1,  315,  316,   -1,
   -1,   -1,  123,   -1,  125,  323,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  333,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  347,
   -1,   -1,   -1,   -1,  352,   -1,  257,   -1,  259,  260,
   59,   -1,   -1,   -1,   -1,   64,   -1,   -1,   -1,  270,
  271,  272,  273,  274,   -1,   -1,   -1,   -1,   -1,  280,
  281,   -1,   -1,  284,  285,  286,  287,  288,  289,  290,
  291,  292,  293,  294,  295,  296,   -1,   -1,    0,   -1,
   -1,  302,  303,  304,  305,  306,   -1,  308,  309,   -1,
   -1,  312,   -1,   -1,  315,  316,   -1,   -1,   -1,   -1,
   -1,   -1,  323,   -1,  123,   -1,  125,   -1,   -1,   -1,
   -1,   -1,  333,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  347,   -1,   -1,   -1,
   -1,  352,   -1,   -1,   -1,   -1,  257,   59,  259,  260,
   -1,   -1,   64,   -1,   -1,   -1,   -1,   -1,   -1,  270,
  271,  272,  273,  274,   -1,   -1,   -1,   -1,   -1,  280,
  281,   -1,   -1,  284,  285,  286,  287,  288,  289,  290,
  291,  292,  293,  294,  295,  296,   -1,   -1,    0,   -1,
   -1,  302,  303,  304,  305,  306,   -1,  308,  309,   -1,
   -1,  312,   -1,   -1,  315,  316,   -1,   -1,   -1,   -1,
   -1,  123,  323,  125,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  333,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  347,   -1,   -1,   -1,
   -1,  352,   -1,   -1,   -1,   -1,   -1,   59,  257,   -1,
  259,  260,   64,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  270,  271,  272,  273,  274,   -1,   -1,   -1,   -1,
   -1,  280,  281,   -1,   -1,  284,  285,  286,  287,  288,
  289,  290,  291,  292,  293,  294,  295,  296,   -1,   -1,
    0,   -1,   -1,  302,  303,  304,  305,  306,   -1,  308,
  309,   -1,   -1,  312,   -1,   -1,  315,  316,   -1,   -1,
   -1,  123,   -1,  125,  323,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  333,   -1,   -1,   -1,   -1,   -1,
   -1,   41,   -1,   -1,   44,   -1,   -1,   47,  347,   -1,
   -1,   -1,   -1,  352,   -1,  257,   -1,  259,  260,   59,
   -1,   -1,   -1,   -1,   64,   -1,   -1,   -1,  270,  271,
  272,  273,  274,   -1,   -1,   -1,   -1,   -1,  280,  281,
   -1,   -1,  284,  285,  286,  287,  288,  289,  290,  291,
  292,  293,  294,  295,  296,   -1,   -1,    0,   -1,   -1,
  302,  303,  304,  305,  306,   -1,  308,  309,   -1,   -1,
  312,   -1,   -1,  315,  316,   -1,   -1,   -1,   -1,   -1,
   -1,  323,   -1,  123,   -1,  125,   -1,   -1,   -1,   -1,
   -1,  333,   -1,   -1,   -1,   -1,   -1,   -1,   41,   -1,
   -1,   44,   -1,   -1,   47,  347,   -1,   -1,   -1,   -1,
  352,   -1,   -1,   -1,   -1,  257,   59,  259,  260,   -1,
   -1,   64,   -1,   -1,   -1,   -1,   -1,   -1,  270,  271,
  272,  273,  274,   -1,   -1,   -1,   -1,   -1,  280,  281,
   -1,   -1,  284,  285,  286,  287,  288,  289,  290,  291,
  292,  293,  294,  295,  296,   -1,   -1,    0,   -1,   -1,
  302,  303,  304,  305,  306,   -1,  308,  309,   -1,   -1,
  312,   -1,   -1,  315,  316,   -1,   -1,   -1,   -1,   -1,
  123,  323,  125,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  333,   -1,   -1,   -1,   -1,   -1,   -1,   41,   -1,
   -1,   44,   -1,   -1,   -1,  347,   -1,   -1,   -1,   -1,
  352,   -1,   -1,   -1,   -1,   -1,   59,  257,  258,  259,
  260,   64,    0,   -1,   -1,   -1,   -1,   -1,   -1,  269,
  270,  271,  272,  273,  274,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  285,   -1,   -1,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,  296,   -1,   -1,   -1,
   -1,   -1,  302,  303,  304,   -1,   -1,  307,   -1,   -1,
  310,  311,  312,   -1,   -1,  315,  316,   -1,   -1,   -1,
  123,   59,  125,  323,   -1,  325,   64,   -1,   -1,   -1,
  330,   -1,   -1,  333,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  347,   -1,   -1,
   -1,    0,  352,   -1,  257,  258,  259,  260,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  269,  270,  271,  272,
  273,  274,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  285,   -1,   -1,  123,   -1,  125,   -1,  292,
  293,  294,  295,  296,   -1,   -1,   -1,   -1,   -1,  302,
  303,  304,   -1,   -1,  307,   -1,   -1,  310,  311,  312,
   59,   -1,  315,  316,   -1,   64,    0,   -1,   -1,   -1,
  323,   -1,  325,   -1,   -1,   -1,   -1,  330,   -1,   -1,
  333,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  347,   -1,   -1,   -1,   -1,  352,
   -1,   -1,   -1,   -1,  257,  258,  259,  260,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  269,  270,  271,  272,
  273,  274,   -1,   -1,  123,   59,  125,   -1,   -1,   -1,
   64,    0,  285,   -1,   -1,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,  296,   -1,   -1,   -1,   -1,   -1,  302,
  303,  304,   -1,   -1,  307,   -1,   -1,  310,  311,  312,
   -1,   -1,  315,  316,   -1,   -1,   -1,   -1,   -1,  257,
  323,  259,  260,   -1,   -1,   -1,   -1,  330,   -1,   -1,
  333,   -1,  270,  271,  272,  273,  274,   -1,   -1,  123,
   59,  125,   -1,   -1,  347,   64,   -1,  285,   -1,  352,
   -1,   -1,   -1,  291,  292,  293,  294,  295,  296,   -1,
   -1,   -1,   -1,   -1,  302,  303,  304,  305,  306,   -1,
    0,   -1,   -1,   -1,  312,   -1,   -1,  315,  316,   -1,
   -1,   -1,   -1,   -1,   -1,  323,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  333,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  123,   -1,  125,   -1,  257,  347,
  259,  260,   -1,   -1,  352,   -1,   -1,   -1,   -1,   -1,
   -1,  270,  271,  272,  273,  274,   -1,   -1,   -1,   59,
   -1,   -1,   -1,   -1,   64,    0,   -1,   -1,   -1,   -1,
   -1,  290,  291,  292,  293,  294,  295,   -1,   -1,   -1,
   -1,   -1,   -1,  302,  303,  304,  305,  306,   -1,   -1,
   -1,   -1,   -1,  312,   -1,   -1,  315,  316,   -1,   -1,
   -1,   -1,   -1,  257,  323,  259,  260,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  333,   -1,  270,  271,  272,  273,
  274,   -1,   -1,  123,   59,  125,   -1,   -1,  347,   64,
    0,  285,   -1,  352,   -1,   -1,   -1,   -1,  292,  293,
  294,  295,  296,   -1,   -1,   -1,   -1,   -1,  302,  303,
  304,  305,  306,   -1,   -1,   -1,   -1,   -1,  312,   -1,
   -1,  315,  316,   -1,   -1,   -1,   -1,   -1,  257,  323,
  259,  260,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  333,
   -1,  270,  271,  272,  273,  274,   -1,   -1,  123,   59,
  125,   -1,   -1,  347,   64,   -1,  285,   -1,  352,   -1,
   -1,   -1,   -1,  292,  293,  294,  295,  296,   -1,   -1,
   -1,   -1,   -1,  302,  303,  304,  305,  306,   -1,    0,
   -1,   -1,   -1,  312,   -1,   -1,  315,  316,   -1,   -1,
   -1,   -1,   -1,   -1,  323,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  333,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  123,   -1,  125,   -1,  257,  347,  259,
  260,   -1,   -1,  352,   -1,   -1,   -1,   -1,   -1,   -1,
  270,  271,  272,  273,  274,   -1,   -1,   -1,   59,   -1,
   -1,   -1,   -1,   64,    0,  285,   -1,   -1,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,  296,   -1,   -1,   -1,
   -1,   -1,  302,  303,  304,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  312,   -1,   -1,  315,  316,   -1,   -1,   -1,
   -1,   -1,  257,  323,  259,  260,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  333,   -1,  270,  271,  272,  273,  274,
   -1,   -1,  123,   59,  125,   -1,   -1,  347,   64,    0,
   -1,   -1,  352,   -1,   -1,   -1,   -1,  292,  293,  294,
  295,  296,   -1,   -1,   -1,   -1,   -1,  302,  303,  304,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  312,   -1,   -1,
  315,  316,   -1,   -1,   -1,   -1,   -1,  257,  323,  259,
  260,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  333,   -1,
  270,  271,  272,  273,  274,   -1,   -1,  123,   59,  125,
   -1,   -1,  347,   64,   -1,   -1,   -1,  352,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,  296,   -1,   -1,   -1,
   -1,   -1,  302,  303,  304,   -1,   -1,   -1,    0,   -1,
   -1,   -1,  312,   -1,   -1,  315,  316,   -1,   -1,   -1,
   -1,   -1,   -1,  323,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  333,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  123,   -1,  125,   -1,  257,  347,  259,  260,
   -1,   -1,  352,   -1,   -1,   -1,   -1,   -1,   -1,  270,
  271,  272,  273,  274,   -1,   -1,   -1,   59,   -1,   -1,
   -1,   -1,   64,    0,   -1,   -1,   -1,   -1,   -1,   -1,
  257,  292,  293,  294,  295,  296,   -1,   -1,   -1,   -1,
   -1,  302,  303,  304,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  312,   -1,   -1,  315,  316,   -1,   -1,   -1,   -1,
   -1,  257,  323,  259,  260,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  333,   -1,  270,  271,  272,  273,  274,   -1,
   -1,  123,   59,  125,   -1,    0,  347,   64,   -1,   -1,
   -1,  352,   -1,   -1,   -1,   -1,  292,  293,  294,  295,
  296,   -1,   -1,   -1,   -1,   -1,  302,  303,  304,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  312,   -1,   -1,  315,
  316,   -1,   -1,   -1,   -1,   -1,  257,   -1,  259,  260,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  333,   -1,  270,
  271,  272,  273,  274,   59,   -1,  123,    0,  125,   64,
   -1,  347,   -1,   -1,   -1,   -1,  352,   -1,   -1,   -1,
   -1,  292,  293,  294,  295,  296,   -1,   -1,   -1,   -1,
   -1,  302,  303,  304,   -1,   -1,    0,   -1,   -1,   -1,
   -1,  312,   -1,   -1,  315,  316,  413,  414,  415,  416,
  417,  418,  419,  420,  421,  422,  423,  424,  425,  426,
  427,  428,  333,   -1,   -1,   -1,   59,   -1,  123,   -1,
  125,   64,   -1,   -1,   -1,  257,  347,  259,  260,   -1,
   -1,  352,   -1,   -1,   -1,   -1,   -1,   -1,  270,  271,
  272,  273,  274,   -1,   -1,   59,   -1,   -1,   -1,    0,
   64,   -1,   -1,   -1,    0,   -1,   -1,   -1,   -1,   -1,
  292,  293,  294,  295,  296,   -1,   -1,   -1,   -1,   -1,
  302,  303,  304,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  312,   -1,  125,  315,  316,   -1,   -1,   -1,   -1,   -1,
  257,   -1,  259,  260,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  333,   -1,  270,  271,  272,  273,  274,   59,  123,
   -1,  125,    0,   64,   -1,  347,   -1,   -1,   64,   -1,
  352,  257,   -1,   -1,   -1,  292,  293,  294,  295,  296,
   -1,   -1,   -1,   -1,   -1,  302,  303,  304,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  312,   -1,   -1,  315,  316,
   -1,   -1,  257,   -1,  259,  260,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  270,  271,  272,  273,  274,
   -1,   59,  123,   -1,  125,   -1,   64,    0,   -1,  125,
  347,   -1,   -1,   -1,   -1,  352,   -1,  292,  293,  294,
  295,  296,   -1,   -1,   -1,   -1,   -1,  302,  303,  304,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  312,   -1,   -1,
  315,  316,   -1,   -1,  257,   -1,  259,  260,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  270,  271,  272,
  273,  274,   -1,   -1,   -1,  123,   59,  125,   -1,   -1,
    0,   64,  347,  257,   -1,  259,  260,  352,   -1,   -1,
   -1,  294,  295,  296,   -1,   -1,  270,  271,  272,  273,
  274,  304,  398,  399,  400,  401,  402,  403,  404,  405,
  406,  407,  408,  409,  410,  411,  412,   -1,  292,  293,
  294,  295,  296,   -1,   -1,   -1,   -1,   -1,  302,  303,
  304,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  312,   59,
  123,   -1,  125,    0,   64,   -1,  257,   -1,  259,  260,
   -1,  257,   -1,  259,  260,   -1,   -1,   -1,   -1,  270,
  271,  272,  273,  274,  270,  271,  272,  273,  274,   -1,
    0,   -1,   -1,  347,   -1,   -1,   -1,   -1,  352,   -1,
   -1,  292,  293,  294,  295,  296,   -1,   -1,  294,  295,
  296,  302,  303,  304,   -1,   -1,   -1,   -1,  304,   -1,
   -1,  312,   59,  123,   -1,  125,   -1,   64,   -1,  257,
   -1,  259,  260,   -1,   -1,   -1,   -1,   -1,   -1,    0,
   -1,   -1,  270,  271,  272,  273,  274,   -1,   -1,   59,
   -1,   -1,   -1,   -1,   64,   -1,  347,   -1,   -1,   -1,
   -1,  352,   -1,   -1,  292,  293,  294,  295,  296,   -1,
   -1,   -1,   -1,   -1,  302,  303,  304,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  312,   -1,  123,   -1,  125,   -1,
   -1,   -1,   -1,   -1,  257,   -1,  259,  260,   59,   -1,
   -1,   -1,    0,   64,   -1,   -1,   -1,  270,  271,  272,
  273,  274,   -1,  123,   -1,  125,   -1,   -1,   -1,  347,
   -1,   -1,   -1,   -1,  352,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,  296,   -1,   -1,   -1,   -1,   -1,  302,
  303,  304,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  312,
   -1,    0,   -1,   -1,   -1,   -1,   -1,  257,   -1,  259,
  260,   59,  123,   -1,  125,   -1,   64,   -1,   -1,   -1,
  270,  271,  272,  273,  274,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  347,   -1,   -1,   -1,   -1,  352,
   -1,   -1,  292,  293,  294,  295,  296,   -1,   -1,   -1,
   -1,   -1,  302,  303,  304,   -1,   -1,   -1,   -1,   -1,
   59,   -1,  312,    0,   -1,   64,   -1,   -1,   -1,   -1,
  257,   -1,  259,  260,   -1,  123,   -1,  125,   -1,   -1,
   -1,   -1,   -1,  270,  271,  272,  273,  274,   -1,   -1,
   -1,    0,   -1,   -1,   -1,   -1,   -1,  257,   -1,  259,
  260,   -1,  352,   -1,   -1,   -1,  293,  294,  295,  296,
  270,  271,  272,  273,  274,  302,  303,  304,   -1,   -1,
   -1,   -1,   59,   -1,  123,  312,  125,   64,   -1,   -1,
   -1,   -1,   -1,   -1,  294,  295,  296,   -1,   -1,   -1,
    0,   -1,  302,  303,  304,   -1,  257,   -1,  259,  260,
   59,   -1,  312,   -1,   -1,   64,   -1,   -1,   -1,  270,
  271,  272,  273,  274,   -1,  352,   -1,   -1,    0,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  294,  295,  296,  123,   -1,  125,   -1,
   -1,  302,  352,  304,   -1,   -1,   -1,   -1,   -1,   59,
   -1,  312,   -1,   -1,   64,   -1,   -1,   -1,   -1,  257,
   -1,  259,  260,   -1,  123,   -1,  125,   -1,   -1,   -1,
   -1,   -1,  270,  271,  272,  273,  274,   59,   -1,   -1,
   -1,   -1,   64,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  352,   -1,   -1,   -1,   -1,  294,  295,  296,   -1,
   -1,   -1,   -1,   -1,  302,   -1,  304,   -1,  257,   -1,
  259,  260,   -1,  123,  312,  125,   -1,   -1,   -1,   -1,
   -1,  270,  271,  272,  273,  274,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  453,   -1,
   -1,  123,   -1,  125,  459,  294,  295,  296,   -1,   -1,
   -1,   -1,   -1,   -1,  352,  304,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  312,   -1,   -1,   -1,   -1,   -1,   -1,
  257,   -1,  259,  260,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  270,  271,  272,  273,  274,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  257,   -1,
  259,  260,   -1,  352,   -1,   -1,   -1,  294,  295,  296,
   -1,  270,  271,  272,  273,  274,   -1,  304,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  312,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  294,  295,  296,   -1,  554,
  555,   -1,   -1,   -1,   -1,  304,   -1,  257,   -1,  259,
  260,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  270,  271,  272,  273,  274,  352,   -1,  582,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  257,   -1,  259,  260,   -1,
   -1,   -1,   -1,   -1,  294,  295,  296,   -1,  270,  271,
  272,  273,  274,  352,  304,   -1,   -1,  612,  613,   -1,
  615,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  623,  624,
   -1,  626,  294,  295,  296,   -1,  317,  318,  319,   -1,
   -1,   -1,  304,  324,   -1,  326,  641,  642,   -1,  644,
  645,   -1,   -1,   -1,  335,  336,  337,  338,  339,  340,
  341,  342,  343,  344,   -1,   -1,   -1,  348,  349,   -1,
   -1,   -1,   -1,  354,  429,  430,  431,  432,  433,  434,
  435,  436,  437,  438,  439,  440,  441,  442,  443,  444,
  445,  446,  447,  448,  449,  450,  451,   -1,  453,  454,
  455,  456,  457,  458,  459,  460,   -1,  388,  355,  356,
  357,  358,  359,  360,  361,  362,  363,  364,  365,  366,
  367,  368,  369,  370,  371,  372,  373,  374,  375,  376,
  377,  378,  379,
};
#define YYFINAL 3
#ifndef YYDEBUG
#define YYDEBUG 0
#endif
#define YYMAXTOKEN 460
#if YYDEBUG
char *ipf_yyname[] = {
"end-of-file",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
"'!'",0,0,0,0,0,0,"'('","')'",0,0,"','","'-'","'.'","'/'",0,0,0,0,0,0,0,0,0,0,
"':'","';'",0,"'='",0,0,"'@'",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,"'{'",0,"'}'",
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,"YY_NUMBER","YY_HEX","YY_STR","YY_COMMENT","YY_CMP_EQ",
"YY_CMP_NE","YY_CMP_LE","YY_CMP_GE","YY_CMP_LT","YY_CMP_GT","YY_RANGE_OUT",
"YY_RANGE_IN","YY_IPV6","IPFY_PASS","IPFY_BLOCK","IPFY_COUNT","IPFY_CALL",
"IPFY_NOMATCH","IPFY_RETICMP","IPFY_RETRST","IPFY_RETICMPASDST","IPFY_IN",
"IPFY_OUT","IPFY_QUICK","IPFY_ON","IPFY_OUTVIA","IPFY_INVIA","IPFY_DUPTO",
"IPFY_TO","IPFY_FROUTE","IPFY_REPLY_TO","IPFY_ROUTETO","IPFY_TOS","IPFY_TTL",
"IPFY_PROTO","IPFY_HEAD","IPFY_GROUP","IPFY_AUTH","IPFY_PREAUTH","IPFY_LOG",
"IPFY_BODY","IPFY_FIRST","IPFY_LEVEL","IPFY_ORBLOCK","IPFY_LOGTAG",
"IPFY_MATCHTAG","IPFY_SETTAG","IPFY_SKIP","IPFY_FROM","IPFY_ALL","IPFY_ANY",
"IPFY_BPFV4","IPFY_BPFV6","IPFY_POOL","IPFY_HASH","IPFY_PPS","IPFY_ESP",
"IPFY_AH","IPFY_WITH","IPFY_AND","IPFY_NOT","IPFY_NO","IPFY_OPT","IPFY_TCPUDP",
"IPFY_TCP","IPFY_UDP","IPFY_FLAGS","IPFY_MULTICAST","IPFY_MASK",
"IPFY_BROADCAST","IPFY_NETWORK","IPFY_NETMASKED","IPFY_PEER","IPFY_PORT",
"IPFY_NOW","IPFY_ICMP","IPFY_ICMPTYPE","IPFY_ICMPCODE","IPFY_IPOPTS",
"IPFY_SHORT","IPFY_NAT","IPFY_BADSRC","IPFY_LOWTTL","IPFY_FRAG","IPFY_MBCAST",
"IPFY_BAD","IPFY_BADNAT","IPFY_OOW","IPFY_NEWISN","IPFY_NOICMPERR","IPFY_KEEP",
"IPFY_STATE","IPFY_FRAGS","IPFY_LIMIT","IPFY_STRICT","IPFY_AGE","IPFY_SYNC",
"IPFY_FRAGBODY","IPFY_IPOPT_NOP","IPFY_IPOPT_RR","IPFY_IPOPT_ZSU",
"IPFY_IPOPT_MTUP","IPFY_IPOPT_MTUR","IPFY_IPOPT_ENCODE","IPFY_IPOPT_TS",
"IPFY_IPOPT_TR","IPFY_IPOPT_SEC","IPFY_IPOPT_LSRR","IPFY_IPOPT_ESEC",
"IPFY_IPOPT_CIPSO","IPFY_IPOPT_SATID","IPFY_IPOPT_SSRR","IPFY_IPOPT_ADDEXT",
"IPFY_IPOPT_VISA","IPFY_IPOPT_IMITD","IPFY_IPOPT_EIP","IPFY_IPOPT_FINN",
"IPFY_IPOPT_DPS","IPFY_IPOPT_SDB","IPFY_IPOPT_NSAPA","IPFY_IPOPT_RTRALRT",
"IPFY_IPOPT_UMP","IPFY_SECCLASS","IPFY_SEC_UNC","IPFY_SEC_CONF","IPFY_SEC_RSV1",
"IPFY_SEC_RSV2","IPFY_SEC_RSV4","IPFY_SEC_SEC","IPFY_SEC_TS","IPFY_SEC_RSV3",
"IPF6_V6HDRS","IPFY_IPV6OPT","IPFY_IPV6OPT_DSTOPTS","IPFY_IPV6OPT_HOPOPTS",
"IPFY_IPV6OPT_IPV6","IPFY_IPV6OPT_NONE","IPFY_IPV6OPT_ROUTING",
"IPFY_IPV6OPT_MOBILITY","IPFY_IPV6OPT_ESP","IPFY_IPV6OPT_FRAG","IPFY_ICMPT_UNR",
"IPFY_ICMPT_ECHO","IPFY_ICMPT_ECHOR","IPFY_ICMPT_SQUENCH","IPFY_ICMPT_REDIR",
"IPFY_ICMPT_TIMEX","IPFY_ICMPT_PARAMP","IPFY_ICMPT_TIMEST",
"IPFY_ICMPT_TIMESTREP","IPFY_ICMPT_INFOREQ","IPFY_ICMPT_INFOREP",
"IPFY_ICMPT_MASKREQ","IPFY_ICMPT_MASKREP","IPFY_ICMPT_ROUTERAD",
"IPFY_ICMPT_ROUTERSOL","IPFY_ICMPC_NETUNR","IPFY_ICMPC_HSTUNR",
"IPFY_ICMPC_PROUNR","IPFY_ICMPC_PORUNR","IPFY_ICMPC_NEEDF","IPFY_ICMPC_SRCFAIL",
"IPFY_ICMPC_NETUNK","IPFY_ICMPC_HSTUNK","IPFY_ICMPC_ISOLATE",
"IPFY_ICMPC_NETPRO","IPFY_ICMPC_HSTPRO","IPFY_ICMPC_NETTOS","IPFY_ICMPC_HSTTOS",
"IPFY_ICMPC_FLTPRO","IPFY_ICMPC_HSTPRE","IPFY_ICMPC_CUTPRE","IPFY_FAC_KERN",
"IPFY_FAC_USER","IPFY_FAC_MAIL","IPFY_FAC_DAEMON","IPFY_FAC_AUTH",
"IPFY_FAC_SYSLOG","IPFY_FAC_LPR","IPFY_FAC_NEWS","IPFY_FAC_UUCP",
"IPFY_FAC_CRON","IPFY_FAC_LOCAL0","IPFY_FAC_LOCAL1","IPFY_FAC_LOCAL2",
"IPFY_FAC_LOCAL3","IPFY_FAC_LOCAL4","IPFY_FAC_LOCAL5","IPFY_FAC_LOCAL6",
"IPFY_FAC_LOCAL7","IPFY_FAC_SECURITY","IPFY_FAC_FTP","IPFY_FAC_AUTHPRIV",
"IPFY_FAC_AUDIT","IPFY_FAC_LFMT","IPFY_FAC_CONSOLE","IPFY_PRI_EMERG",
"IPFY_PRI_ALERT","IPFY_PRI_CRIT","IPFY_PRI_ERR","IPFY_PRI_WARN",
"IPFY_PRI_NOTICE","IPFY_PRI_INFO","IPFY_PRI_DEBUG",
};
char *ipf_yyrule[] = {
"$accept : file",
"file : line",
"file : assign",
"file : file line",
"file : file assign",
"line : rule",
"line : YY_COMMENT",
"xx :",
"assign : YY_STR assigning YY_STR ';'",
"assigning : '='",
"rule : inrule eol",
"rule : outrule eol",
"eol :",
"eol : ';'",
"inrule : rulehead markin inopts rulemain ruletail intag ruletail2",
"outrule : rulehead markout outopts rulemain ruletail outtag ruletail2",
"rulehead : xx collection action",
"rulehead : xx insert collection action",
"markin : IPFY_IN",
"markout : IPFY_OUT",
"rulemain : ipfrule",
"rulemain : bpfrule",
"ipfrule : tos ttl proto ip",
"bpfrule : IPFY_BPFV4 '{' YY_STR '}'",
"bpfrule : IPFY_BPFV6 '{' YY_STR '}'",
"ruletail : with keep head group",
"ruletail2 : pps age new",
"intag : settagin matchtagin",
"outtag : settagout matchtagout",
"insert : '@' YY_NUMBER",
"collection :",
"collection : YY_NUMBER",
"action : block",
"action : IPFY_PASS",
"action : IPFY_NOMATCH",
"action : log",
"action : IPFY_COUNT",
"action : auth",
"action : IPFY_SKIP YY_NUMBER",
"action : IPFY_CALL func",
"action : IPFY_CALL IPFY_NOW func",
"block : blocked",
"block : blocked blockreturn",
"blocked : IPFY_BLOCK",
"blockreturn : IPFY_RETICMP",
"blockreturn : IPFY_RETICMP returncode",
"blockreturn : IPFY_RETICMPASDST",
"blockreturn : IPFY_RETICMPASDST returncode",
"blockreturn : IPFY_RETRST",
"log : IPFY_LOG",
"log : IPFY_LOG logoptions",
"auth : IPFY_AUTH",
"auth : IPFY_AUTH blockreturn",
"auth : IPFY_PREAUTH",
"func : YY_STR '/' YY_NUMBER",
"inopts :",
"inopts : inopts inopt",
"inopt : logopt",
"inopt : quick",
"inopt : on",
"inopt : dup",
"inopt : froute",
"inopt : proute",
"inopt : replyto",
"outopts :",
"outopts : outopts outopt",
"outopt : logopt",
"outopt : quick",
"outopt : on",
"outopt : dup",
"outopt : proute",
"outopt : replyto",
"tos :",
"tos : settos YY_NUMBER",
"tos : settos YY_HEX",
"tos : settos lstart toslist lend",
"settos : IPFY_TOS",
"toslist : YY_NUMBER",
"toslist : YY_HEX",
"toslist : toslist lmore YY_NUMBER",
"toslist : toslist lmore YY_HEX",
"ttl :",
"ttl : setttl YY_NUMBER",
"ttl : setttl lstart ttllist lend",
"lstart : '('",
"lend : ')'",
"lmore : lanother",
"lanother :",
"lanother : ','",
"setttl : IPFY_TTL",
"ttllist : YY_NUMBER",
"ttllist : ttllist lmore YY_NUMBER",
"proto :",
"proto : protox protocol",
"protox : IPFY_PROTO",
"ip : srcdst flags icmp",
"group :",
"group : IPFY_GROUP YY_STR",
"group : IPFY_GROUP YY_NUMBER",
"head :",
"head : IPFY_HEAD YY_STR",
"head : IPFY_HEAD YY_NUMBER",
"settagin :",
"settagin : IPFY_SETTAG '(' taginlist ')'",
"taginlist : taginspec",
"taginlist : taginlist ',' taginspec",
"taginspec : logtag",
"nattag : IPFY_NAT '=' YY_STR",
"nattag : IPFY_NAT '=' YY_NUMBER",
"logtag : IPFY_LOG '=' YY_NUMBER",
"settagout :",
"settagout : IPFY_SETTAG '(' tagoutlist ')'",
"tagoutlist : tagoutspec",
"tagoutlist : tagoutlist ',' tagoutspec",
"tagoutspec : logtag",
"tagoutspec : nattag",
"matchtagin :",
"matchtagin : IPFY_MATCHTAG '(' tagoutlist ')'",
"matchtagout :",
"matchtagout : IPFY_MATCHTAG '(' taginlist ')'",
"pps :",
"pps : IPFY_PPS YY_NUMBER",
"new :",
"new : savegroup file restoregroup",
"savegroup : '{'",
"restoregroup : '}'",
"logopt : log",
"quick : IPFY_QUICK",
"on : IPFY_ON onname",
"on : IPFY_ON lstart onlist lend",
"on : IPFY_ON onname IPFY_INVIA vianame",
"on : IPFY_ON onname IPFY_OUTVIA vianame",
"onlist : onname",
"onlist : onlist lmore onname",
"onname : interfacename",
"onname : interfacename ',' interfacename",
"vianame : name",
"vianame : name ',' name",
"dup : IPFY_DUPTO name",
"dup : IPFY_DUPTO name duptoseparator hostname",
"dup : IPFY_DUPTO name duptoseparator YY_IPV6",
"duptoseparator : ':'",
"froute : IPFY_FROUTE",
"proute : routeto name",
"proute : routeto name duptoseparator hostname",
"proute : routeto name duptoseparator YY_IPV6",
"routeto : IPFY_TO",
"routeto : IPFY_ROUTETO",
"replyto : IPFY_REPLY_TO name",
"replyto : IPFY_REPLY_TO name duptoseparator hostname",
"logoptions : logoption",
"logoptions : logoptions logoption",
"logoption : IPFY_BODY",
"logoption : IPFY_FIRST",
"logoption : IPFY_ORBLOCK",
"logoption : level loglevel",
"returncode : starticmpcode icmpcode ')'",
"starticmpcode : '('",
"srcdst :",
"srcdst : IPFY_ALL",
"srcdst : fromto",
"protocol : YY_NUMBER",
"protocol : YY_STR",
"protocol : YY_STR nextstring YY_STR",
"nextstring : '/'",
"fromto : from srcobject to dstobject",
"fromto : to dstobject",
"fromto : from srcobject",
"from : IPFY_FROM",
"to : IPFY_TO",
"with :",
"with : andwith withlist",
"andwith : IPFY_WITH",
"andwith : IPFY_AND",
"flags :",
"flags : startflags flagset",
"flags : startflags flagset '/' flagset",
"flags : startflags '/' flagset",
"flags : startflags YY_NUMBER",
"flags : startflags '/' YY_NUMBER",
"flags : startflags YY_NUMBER '/' YY_NUMBER",
"flags : startflags flagset '/' YY_NUMBER",
"flags : startflags YY_NUMBER '/' flagset",
"startflags : IPFY_FLAGS",
"flagset : YY_STR",
"flagset : YY_HEX",
"$$1 :",
"srcobject : $$1 fromport",
"srcobject : srcaddr srcport",
"srcobject : '!' srcaddr srcport",
"srcaddr : addr",
"srcaddr : lstart srcaddrlist lend",
"srcaddrlist : addr",
"srcaddrlist : srcaddrlist lmore addr",
"srcport :",
"srcport : portcomp",
"srcport : portrange",
"srcport : porteq lstart srcportlist lend",
"fromport : portcomp",
"fromport : portrange",
"fromport : porteq lstart srcportlist lend",
"srcportlist : portnum",
"srcportlist : portnum ':' portnum",
"srcportlist : portnum YY_RANGE_IN portnum",
"srcportlist : srcportlist lmore portnum",
"srcportlist : srcportlist lmore portnum ':' portnum",
"srcportlist : srcportlist lmore portnum YY_RANGE_IN portnum",
"$$2 :",
"dstobject : $$2 toport",
"dstobject : dstaddr dstport",
"dstobject : '!' dstaddr dstport",
"dstaddr : addr",
"dstaddr : lstart dstaddrlist lend",
"dstaddrlist : addr",
"dstaddrlist : dstaddrlist lmore addr",
"dstport :",
"dstport : portcomp",
"dstport : portrange",
"dstport : porteq lstart dstportlist lend",
"toport : portcomp",
"toport : portrange",
"toport : porteq lstart dstportlist lend",
"dstportlist : portnum",
"dstportlist : portnum ':' portnum",
"dstportlist : portnum YY_RANGE_IN portnum",
"dstportlist : dstportlist lmore portnum",
"dstportlist : dstportlist lmore portnum ':' portnum",
"dstportlist : dstportlist lmore portnum YY_RANGE_IN portnum",
"addr : pool '/' YY_NUMBER",
"addr : pool '/' YY_STR",
"addr : pool '=' '(' poollist ')'",
"addr : hash '/' YY_NUMBER",
"addr : hash '/' YY_STR",
"addr : hash '=' '(' addrlist ')'",
"addr : ipaddr",
"ipaddr : IPFY_ANY",
"ipaddr : hostname",
"$$3 :",
"$$4 :",
"ipaddr : hostname $$3 maskspace $$4 ipv4mask",
"ipaddr : YY_IPV6",
"$$5 :",
"$$6 :",
"ipaddr : YY_IPV6 $$5 maskspace $$6 ipv6mask",
"maskspace : '/'",
"maskspace : IPFY_MASK",
"ipv4mask : ipv4",
"ipv4mask : YY_HEX",
"ipv4mask : YY_NUMBER",
"ipv4mask : IPFY_BROADCAST",
"ipv4mask : IPFY_NETWORK",
"ipv4mask : IPFY_NETMASKED",
"ipv4mask : IPFY_PEER",
"ipv6mask : YY_NUMBER",
"ipv6mask : IPFY_BROADCAST",
"ipv6mask : IPFY_NETWORK",
"ipv6mask : IPFY_NETMASKED",
"ipv6mask : IPFY_PEER",
"hostname : ipv4",
"hostname : YY_NUMBER",
"hostname : YY_HEX",
"hostname : YY_STR",
"addrlist : ipaddr",
"addrlist : addrlist ',' ipaddr",
"pool : IPFY_POOL",
"hash : IPFY_HASH",
"poollist : ipaddr",
"poollist : '!' ipaddr",
"poollist : poollist ',' ipaddr",
"poollist : poollist ',' '!' ipaddr",
"port : IPFY_PORT",
"portc : port compare",
"portc : porteq",
"porteq : port '='",
"portr : IPFY_PORT",
"portcomp : portc portnum",
"portrange : portr portnum range portnum",
"icmp :",
"icmp : itype icode",
"itype : seticmptype icmptype",
"itype : seticmptype lstart typelist lend",
"seticmptype : IPFY_ICMPTYPE",
"icode :",
"icode : seticmpcode icmpcode",
"icode : seticmpcode lstart codelist lend",
"seticmpcode : IPFY_ICMPCODE",
"typelist : icmptype",
"typelist : typelist lmore icmptype",
"codelist : icmpcode",
"codelist : codelist lmore icmpcode",
"age :",
"age : IPFY_AGE YY_NUMBER",
"age : IPFY_AGE YY_NUMBER '/' YY_NUMBER",
"keep :",
"keep : IPFY_KEEP keepstate keep",
"keep : IPFY_KEEP keepfrag keep",
"keepstate : IPFY_STATE stateoptlist",
"keepfrag : IPFY_FRAGS fragoptlist",
"keepfrag : IPFY_FRAG fragoptlist",
"fragoptlist :",
"fragoptlist : '(' fragopts ')'",
"fragopts : fragopt lanother fragopts",
"fragopts : fragopt",
"fragopt : IPFY_STRICT",
"stateoptlist :",
"stateoptlist : '(' stateopts ')'",
"stateopts : stateopt lanother stateopts",
"stateopts : stateopt",
"stateopt : IPFY_LIMIT YY_NUMBER",
"stateopt : IPFY_STRICT",
"stateopt : IPFY_NEWISN",
"stateopt : IPFY_NOICMPERR",
"stateopt : IPFY_SYNC",
"stateopt : IPFY_AGE YY_NUMBER",
"stateopt : IPFY_AGE YY_NUMBER '/' YY_NUMBER",
"portnum : servicename",
"portnum : YY_NUMBER",
"withlist : withopt",
"withlist : withlist withopt",
"withlist : withlist ',' withopt",
"withopt : opttype",
"withopt : notwith opttype",
"withopt : ipopt ipopts",
"withopt : notwith ipopt ipopts",
"withopt : startv6hdrs ipv6hdrs",
"ipopt : IPFY_OPT",
"startv6hdrs : IPF6_V6HDRS",
"notwith : IPFY_NOT",
"notwith : IPFY_NO",
"opttype : IPFY_IPOPTS",
"opttype : IPFY_SHORT",
"opttype : IPFY_NAT",
"opttype : IPFY_BAD",
"opttype : IPFY_BADNAT",
"opttype : IPFY_BADSRC",
"opttype : IPFY_LOWTTL",
"opttype : IPFY_FRAG",
"opttype : IPFY_FRAGBODY",
"opttype : IPFY_FRAGS",
"opttype : IPFY_MBCAST",
"opttype : IPFY_MULTICAST",
"opttype : IPFY_BROADCAST",
"opttype : IPFY_STATE",
"opttype : IPFY_OOW",
"ipopts : optlist",
"optlist : opt",
"optlist : optlist ',' opt",
"ipv6hdrs : ipv6hdrlist",
"ipv6hdrlist : ipv6hdr",
"ipv6hdrlist : ipv6hdrlist ',' ipv6hdr",
"secname : seclevel",
"secname : secname ',' seclevel",
"seclevel : IPFY_SEC_UNC",
"seclevel : IPFY_SEC_CONF",
"seclevel : IPFY_SEC_RSV1",
"seclevel : IPFY_SEC_RSV2",
"seclevel : IPFY_SEC_RSV3",
"seclevel : IPFY_SEC_RSV4",
"seclevel : IPFY_SEC_SEC",
"seclevel : IPFY_SEC_TS",
"icmptype : YY_NUMBER",
"icmptype : IPFY_ICMPT_UNR",
"icmptype : IPFY_ICMPT_ECHO",
"icmptype : IPFY_ICMPT_ECHOR",
"icmptype : IPFY_ICMPT_SQUENCH",
"icmptype : IPFY_ICMPT_REDIR",
"icmptype : IPFY_ICMPT_TIMEX",
"icmptype : IPFY_ICMPT_PARAMP",
"icmptype : IPFY_ICMPT_TIMEST",
"icmptype : IPFY_ICMPT_TIMESTREP",
"icmptype : IPFY_ICMPT_INFOREQ",
"icmptype : IPFY_ICMPT_INFOREP",
"icmptype : IPFY_ICMPT_MASKREQ",
"icmptype : IPFY_ICMPT_MASKREP",
"icmptype : IPFY_ICMPT_ROUTERAD",
"icmptype : IPFY_ICMPT_ROUTERSOL",
"icmpcode : YY_NUMBER",
"icmpcode : IPFY_ICMPC_NETUNR",
"icmpcode : IPFY_ICMPC_HSTUNR",
"icmpcode : IPFY_ICMPC_PROUNR",
"icmpcode : IPFY_ICMPC_PORUNR",
"icmpcode : IPFY_ICMPC_NEEDF",
"icmpcode : IPFY_ICMPC_SRCFAIL",
"icmpcode : IPFY_ICMPC_NETUNK",
"icmpcode : IPFY_ICMPC_HSTUNK",
"icmpcode : IPFY_ICMPC_ISOLATE",
"icmpcode : IPFY_ICMPC_NETPRO",
"icmpcode : IPFY_ICMPC_HSTPRO",
"icmpcode : IPFY_ICMPC_NETTOS",
"icmpcode : IPFY_ICMPC_HSTTOS",
"icmpcode : IPFY_ICMPC_FLTPRO",
"icmpcode : IPFY_ICMPC_HSTPRE",
"icmpcode : IPFY_ICMPC_CUTPRE",
"opt : IPFY_IPOPT_NOP",
"opt : IPFY_IPOPT_RR",
"opt : IPFY_IPOPT_ZSU",
"opt : IPFY_IPOPT_MTUP",
"opt : IPFY_IPOPT_MTUR",
"opt : IPFY_IPOPT_ENCODE",
"opt : IPFY_IPOPT_TS",
"opt : IPFY_IPOPT_TR",
"opt : IPFY_IPOPT_SEC",
"opt : IPFY_IPOPT_LSRR",
"opt : IPFY_IPOPT_ESEC",
"opt : IPFY_IPOPT_CIPSO",
"opt : IPFY_IPOPT_SATID",
"opt : IPFY_IPOPT_SSRR",
"opt : IPFY_IPOPT_ADDEXT",
"opt : IPFY_IPOPT_VISA",
"opt : IPFY_IPOPT_IMITD",
"opt : IPFY_IPOPT_EIP",
"opt : IPFY_IPOPT_FINN",
"opt : IPFY_IPOPT_DPS",
"opt : IPFY_IPOPT_SDB",
"opt : IPFY_IPOPT_NSAPA",
"opt : IPFY_IPOPT_RTRALRT",
"opt : IPFY_IPOPT_UMP",
"opt : setsecclass secname",
"setsecclass : IPFY_SECCLASS",
"ipv6hdr : IPFY_AH",
"ipv6hdr : IPFY_IPV6OPT_DSTOPTS",
"ipv6hdr : IPFY_IPV6OPT_ESP",
"ipv6hdr : IPFY_IPV6OPT_HOPOPTS",
"ipv6hdr : IPFY_IPV6OPT_IPV6",
"ipv6hdr : IPFY_IPV6OPT_NONE",
"ipv6hdr : IPFY_IPV6OPT_ROUTING",
"ipv6hdr : IPFY_IPV6OPT_FRAG",
"ipv6hdr : IPFY_IPV6OPT_MOBILITY",
"level : IPFY_LEVEL",
"loglevel : priority",
"loglevel : facility '.' priority",
"facility : IPFY_FAC_KERN",
"facility : IPFY_FAC_USER",
"facility : IPFY_FAC_MAIL",
"facility : IPFY_FAC_DAEMON",
"facility : IPFY_FAC_AUTH",
"facility : IPFY_FAC_SYSLOG",
"facility : IPFY_FAC_LPR",
"facility : IPFY_FAC_NEWS",
"facility : IPFY_FAC_UUCP",
"facility : IPFY_FAC_CRON",
"facility : IPFY_FAC_FTP",
"facility : IPFY_FAC_AUTHPRIV",
"facility : IPFY_FAC_AUDIT",
"facility : IPFY_FAC_LFMT",
"facility : IPFY_FAC_LOCAL0",
"facility : IPFY_FAC_LOCAL1",
"facility : IPFY_FAC_LOCAL2",
"facility : IPFY_FAC_LOCAL3",
"facility : IPFY_FAC_LOCAL4",
"facility : IPFY_FAC_LOCAL5",
"facility : IPFY_FAC_LOCAL6",
"facility : IPFY_FAC_LOCAL7",
"facility : IPFY_FAC_SECURITY",
"priority : IPFY_PRI_EMERG",
"priority : IPFY_PRI_ALERT",
"priority : IPFY_PRI_CRIT",
"priority : IPFY_PRI_ERR",
"priority : IPFY_PRI_WARN",
"priority : IPFY_PRI_NOTICE",
"priority : IPFY_PRI_INFO",
"priority : IPFY_PRI_DEBUG",
"compare : YY_CMP_EQ",
"compare : YY_CMP_NE",
"compare : YY_CMP_LT",
"compare : YY_CMP_LE",
"compare : YY_CMP_GT",
"compare : YY_CMP_GE",
"range : YY_RANGE_IN",
"range : YY_RANGE_OUT",
"range : ':'",
"servicename : YY_STR",
"interfacename : name",
"interfacename : name ':' YY_NUMBER",
"name : YY_STR",
"name : '-'",
"ipv4_16 : YY_NUMBER '.' YY_NUMBER",
"ipv4_24 : ipv4_16 '.' YY_NUMBER",
"ipv4 : ipv4_24 '.' YY_NUMBER",
"ipv4 : ipv4_24",
"ipv4 : ipv4_16",
};
#endif
#if YYDEBUG
#include <stdio.h>
#endif

/* define the initial stack-sizes */
#ifdef YYSTACKSIZE
#undef YYMAXDEPTH
#define YYMAXDEPTH  YYSTACKSIZE
#else
#ifdef YYMAXDEPTH
#define YYSTACKSIZE YYMAXDEPTH
#else
#define YYSTACKSIZE 500
#define YYMAXDEPTH  500
#endif
#endif

#define YYINITSTACKSIZE 500

int      ipf_yydebug;
int      ipf_yynerrs;
int      ipf_yyerrflag;
int      ipf_yychar;
short   *ipf_yyssp;
YYSTYPE *ipf_yyvsp;
YYSTYPE  ipf_yyval;
YYSTYPE  ipf_yylval;

/* variables for the parser stack */
static short   *ipf_yyss;
static short   *ipf_yysslim;
static YYSTYPE *ipf_yyvs;
static int      ipf_yystacksize;
#line 1467 "../tools/ipf_y.y"


static	struct	wordtab ipfwords[95] = {
	{ "age",			IPFY_AGE },
	{ "ah",				IPFY_AH },
	{ "all",			IPFY_ALL },
	{ "and",			IPFY_AND },
	{ "auth",			IPFY_AUTH },
	{ "bad",			IPFY_BAD },
	{ "bad-nat",			IPFY_BADNAT },
	{ "bad-src",			IPFY_BADSRC },
	{ "bcast",			IPFY_BROADCAST },
	{ "block",			IPFY_BLOCK },
	{ "body",			IPFY_BODY },
	{ "bpf-v4",			IPFY_BPFV4 },
#ifdef USE_INET6
	{ "bpf-v6",			IPFY_BPFV6 },
#endif
	{ "call",			IPFY_CALL },
	{ "code",			IPFY_ICMPCODE },
	{ "count",			IPFY_COUNT },
	{ "dup-to",			IPFY_DUPTO },
	{ "eq",				YY_CMP_EQ },
	{ "esp",			IPFY_ESP },
	{ "fastroute",			IPFY_FROUTE },
	{ "first",			IPFY_FIRST },
	{ "flags",			IPFY_FLAGS },
	{ "frag",			IPFY_FRAG },
	{ "frag-body",			IPFY_FRAGBODY },
	{ "frags",			IPFY_FRAGS },
	{ "from",			IPFY_FROM },
	{ "ge",				YY_CMP_GE },
	{ "group",			IPFY_GROUP },
	{ "gt",				YY_CMP_GT },
	{ "head",			IPFY_HEAD },
	{ "icmp",			IPFY_ICMP },
	{ "icmp-type",			IPFY_ICMPTYPE },
	{ "in",				IPFY_IN },
	{ "in-via",			IPFY_INVIA },
	{ "ipopt",			IPFY_IPOPTS },
	{ "ipopts",			IPFY_IPOPTS },
	{ "keep",			IPFY_KEEP },
	{ "le",				YY_CMP_LE },
	{ "level",			IPFY_LEVEL },
	{ "limit",			IPFY_LIMIT },
	{ "log",			IPFY_LOG },
	{ "lowttl",			IPFY_LOWTTL },
	{ "lt",				YY_CMP_LT },
	{ "mask",			IPFY_MASK },
	{ "match-tag",			IPFY_MATCHTAG },
	{ "mbcast",			IPFY_MBCAST },
	{ "mcast",			IPFY_MULTICAST },
	{ "multicast",			IPFY_MULTICAST },
	{ "nat",			IPFY_NAT },
	{ "ne",				YY_CMP_NE },
	{ "net",			IPFY_NETWORK },
	{ "newisn",			IPFY_NEWISN },
	{ "no",				IPFY_NO },
	{ "no-icmp-err",		IPFY_NOICMPERR },
	{ "nomatch",			IPFY_NOMATCH },
	{ "now",			IPFY_NOW },
	{ "not",			IPFY_NOT },
	{ "oow",			IPFY_OOW },
	{ "on",				IPFY_ON },
	{ "opt",			IPFY_OPT },
	{ "or-block",			IPFY_ORBLOCK },
	{ "out",			IPFY_OUT },
	{ "out-via",			IPFY_OUTVIA },
	{ "pass",			IPFY_PASS },
	{ "port",			IPFY_PORT },
	{ "pps",			IPFY_PPS },
	{ "preauth",			IPFY_PREAUTH },
	{ "proto",			IPFY_PROTO },
	{ "quick",			IPFY_QUICK },
	{ "reply-to",			IPFY_REPLY_TO },
	{ "return-icmp",		IPFY_RETICMP },
	{ "return-icmp-as-dest",	IPFY_RETICMPASDST },
	{ "return-rst",			IPFY_RETRST },
	{ "route-to",			IPFY_ROUTETO },
	{ "sec-class",			IPFY_SECCLASS },
	{ "set-tag",			IPFY_SETTAG },
	{ "skip",			IPFY_SKIP },
	{ "short",			IPFY_SHORT },
	{ "state",			IPFY_STATE },
	{ "state-age",			IPFY_AGE },
	{ "strict",			IPFY_STRICT },
	{ "sync",			IPFY_SYNC },
	{ "tcp",			IPFY_TCP },
	{ "tcp-udp",			IPFY_TCPUDP },
	{ "tos",			IPFY_TOS },
	{ "to",				IPFY_TO },
	{ "ttl",			IPFY_TTL },
	{ "udp",			IPFY_UDP },
	{ "v6hdrs",			IPF6_V6HDRS },
	{ "with",			IPFY_WITH },
	{ NULL,				0 }
};

static	struct	wordtab	addrwords[4] = {
	{ "any",			IPFY_ANY },
	{ "hash",			IPFY_HASH },
	{ "pool",			IPFY_POOL },
	{ NULL,				0 }
};

static	struct	wordtab	maskwords[5] = {
	{ "broadcast",			IPFY_BROADCAST },
	{ "netmasked",			IPFY_NETMASKED },
	{ "network",			IPFY_NETWORK },
	{ "peer",			IPFY_PEER },
	{ NULL,				0 }
};

static	struct	wordtab icmptypewords[16] = {
	{ "echo",			IPFY_ICMPT_ECHO },
	{ "echorep",			IPFY_ICMPT_ECHOR },
	{ "inforeq",			IPFY_ICMPT_INFOREQ },
	{ "inforep",			IPFY_ICMPT_INFOREP },
	{ "maskrep",			IPFY_ICMPT_MASKREP },
	{ "maskreq",			IPFY_ICMPT_MASKREQ },
	{ "paramprob",			IPFY_ICMPT_PARAMP },
	{ "redir",			IPFY_ICMPT_REDIR },
	{ "unreach",			IPFY_ICMPT_UNR },
	{ "routerad",			IPFY_ICMPT_ROUTERAD },
	{ "routersol",			IPFY_ICMPT_ROUTERSOL },
	{ "squench",			IPFY_ICMPT_SQUENCH },
	{ "timest",			IPFY_ICMPT_TIMEST },
	{ "timestrep",			IPFY_ICMPT_TIMESTREP },
	{ "timex",			IPFY_ICMPT_TIMEX },
	{ NULL,				0 },
};

static	struct	wordtab icmpcodewords[17] = {
	{ "cutoff-preced",		IPFY_ICMPC_CUTPRE },
	{ "filter-prohib",		IPFY_ICMPC_FLTPRO },
	{ "isolate",			IPFY_ICMPC_ISOLATE },
	{ "needfrag",			IPFY_ICMPC_NEEDF },
	{ "net-prohib",			IPFY_ICMPC_NETPRO },
	{ "net-tos",			IPFY_ICMPC_NETTOS },
	{ "host-preced",		IPFY_ICMPC_HSTPRE },
	{ "host-prohib",		IPFY_ICMPC_HSTPRO },
	{ "host-tos",			IPFY_ICMPC_HSTTOS },
	{ "host-unk",			IPFY_ICMPC_HSTUNK },
	{ "host-unr",			IPFY_ICMPC_HSTUNR },
	{ "net-unk",			IPFY_ICMPC_NETUNK },
	{ "net-unr",			IPFY_ICMPC_NETUNR },
	{ "port-unr",			IPFY_ICMPC_PORUNR },
	{ "proto-unr",			IPFY_ICMPC_PROUNR },
	{ "srcfail",			IPFY_ICMPC_SRCFAIL },
	{ NULL,				0 },
};

static	struct	wordtab ipv4optwords[25] = {
	{ "addext",			IPFY_IPOPT_ADDEXT },
	{ "cipso",			IPFY_IPOPT_CIPSO },
	{ "dps",			IPFY_IPOPT_DPS },
	{ "e-sec",			IPFY_IPOPT_ESEC },
	{ "eip",			IPFY_IPOPT_EIP },
	{ "encode",			IPFY_IPOPT_ENCODE },
	{ "finn",			IPFY_IPOPT_FINN },
	{ "imitd",			IPFY_IPOPT_IMITD },
	{ "lsrr",			IPFY_IPOPT_LSRR },
	{ "mtup",			IPFY_IPOPT_MTUP },
	{ "mtur",			IPFY_IPOPT_MTUR },
	{ "nop",			IPFY_IPOPT_NOP },
	{ "nsapa",			IPFY_IPOPT_NSAPA },
	{ "rr",				IPFY_IPOPT_RR },
	{ "rtralrt",			IPFY_IPOPT_RTRALRT },
	{ "satid",			IPFY_IPOPT_SATID },
	{ "sdb",			IPFY_IPOPT_SDB },
	{ "sec",			IPFY_IPOPT_SEC },
	{ "ssrr",			IPFY_IPOPT_SSRR },
	{ "tr",				IPFY_IPOPT_TR },
	{ "ts",				IPFY_IPOPT_TS },
	{ "ump",			IPFY_IPOPT_UMP },
	{ "visa",			IPFY_IPOPT_VISA },
	{ "zsu",			IPFY_IPOPT_ZSU },
	{ NULL,				0 },
};

static	struct	wordtab ipv4secwords[9] = {
	{ "confid",			IPFY_SEC_CONF },
	{ "reserv-1",			IPFY_SEC_RSV1 },
	{ "reserv-2",			IPFY_SEC_RSV2 },
	{ "reserv-3",			IPFY_SEC_RSV3 },
	{ "reserv-4",			IPFY_SEC_RSV4 },
	{ "secret",			IPFY_SEC_SEC },
	{ "topsecret",			IPFY_SEC_TS },
	{ "unclass",			IPFY_SEC_UNC },
	{ NULL,				0 },
};

static	struct	wordtab ipv6optwords[9] = {
	{ "dstopts",			IPFY_IPV6OPT_DSTOPTS },
	{ "esp",			IPFY_IPV6OPT_ESP },
	{ "frag",			IPFY_IPV6OPT_FRAG },
	{ "hopopts",			IPFY_IPV6OPT_HOPOPTS },
	{ "ipv6",			IPFY_IPV6OPT_IPV6 },
	{ "mobility",			IPFY_IPV6OPT_MOBILITY },
	{ "none",			IPFY_IPV6OPT_NONE },
	{ "routing",			IPFY_IPV6OPT_ROUTING },
	{ NULL,				0 },
};

static	struct	wordtab logwords[33] = {
	{ "kern",			IPFY_FAC_KERN },
	{ "user",			IPFY_FAC_USER },
	{ "mail",			IPFY_FAC_MAIL },
	{ "daemon",			IPFY_FAC_DAEMON },
	{ "auth",			IPFY_FAC_AUTH },
	{ "syslog",			IPFY_FAC_SYSLOG },
	{ "lpr",			IPFY_FAC_LPR },
	{ "news",			IPFY_FAC_NEWS },
	{ "uucp",			IPFY_FAC_UUCP },
	{ "cron",			IPFY_FAC_CRON },
	{ "ftp",			IPFY_FAC_FTP },
	{ "authpriv",			IPFY_FAC_AUTHPRIV },
	{ "audit",			IPFY_FAC_AUDIT },
	{ "logalert",			IPFY_FAC_LFMT },
	{ "console",			IPFY_FAC_CONSOLE },
	{ "security",			IPFY_FAC_SECURITY },
	{ "local0",			IPFY_FAC_LOCAL0 },
	{ "local1",			IPFY_FAC_LOCAL1 },
	{ "local2",			IPFY_FAC_LOCAL2 },
	{ "local3",			IPFY_FAC_LOCAL3 },
	{ "local4",			IPFY_FAC_LOCAL4 },
	{ "local5",			IPFY_FAC_LOCAL5 },
	{ "local6",			IPFY_FAC_LOCAL6 },
	{ "local7",			IPFY_FAC_LOCAL7 },
	{ "emerg",			IPFY_PRI_EMERG },
	{ "alert",			IPFY_PRI_ALERT },
	{ "crit",			IPFY_PRI_CRIT },
	{ "err",			IPFY_PRI_ERR },
	{ "warn",			IPFY_PRI_WARN },
	{ "notice",			IPFY_PRI_NOTICE },
	{ "info",			IPFY_PRI_INFO },
	{ "debug",			IPFY_PRI_DEBUG },
	{ NULL,				0 },
};




int ipf_parsefile(fd, addfunc, iocfuncs, filename)
int fd;
addfunc_t addfunc;
ioctlfunc_t *iocfuncs;
char *filename;
{
	FILE *fp = NULL;
	char *s;

	ipf_yylineNum = 1;
	ipf_yysettab(ipfwords);

	s = getenv("YYDEBUG");
	if (s != NULL)
		ipf_yydebug = atoi(s);
	else
		ipf_yydebug = 0;

	if (strcmp(filename, "-")) {
		fp = fopen(filename, "r");
		if (fp == NULL) {
			fprintf(stderr, "fopen(%s) failed: %s\n", filename,
				STRERROR(errno));
			return -1;
		}
	} else
		fp = stdin;

	while (ipf_parsesome(fd, addfunc, iocfuncs, fp) == 1)
		;
	if (fp != NULL)
		fclose(fp);
	return 0;
}


int ipf_parsesome(fd, addfunc, iocfuncs, fp)
int fd;
addfunc_t addfunc;
ioctlfunc_t *iocfuncs;
FILE *fp;
{
	char *s;
	int i;

	ipffd = fd;
	for (i = 0; i <= IPL_LOGMAX; i++)
		ipfioctl[i] = iocfuncs[i];
	ipfaddfunc = addfunc;

	if (feof(fp))
		return 0;
	i = fgetc(fp);
	if (i == EOF)
		return 0;
	if (ungetc(i, fp) == 0)
		return 0;
	if (feof(fp))
		return 0;
	s = getenv("YYDEBUG");
	if (s != NULL)
		ipf_yydebug = atoi(s);
	else
		ipf_yydebug = 0;

	ipf_yyin = fp;
	ipf_yyparse();
	return 1;
}


static void newrule()
{
	frentry_t *frn;

	frn = (frentry_t *)calloc(1, sizeof(frentry_t));
	for (fr = frtop; fr != NULL && fr->fr_next != NULL; fr = fr->fr_next)
		;
	if (fr != NULL)
		fr->fr_next = frn;
	if (frtop == NULL)
		frtop = frn;
	fr = frn;
	frc = frn;
	fr->fr_loglevel = 0xffff;
	fr->fr_isc = (void *)-1;
	fr->fr_logtag = FR_NOLOGTAG;
	fr->fr_type = FR_T_NONE;
	if (use_inet6 != 0)
		fr->fr_v = 6;
	else
		fr->fr_v = 4;

	nrules = 1;
}


static void setipftype()
{
	for (fr = frc; fr != NULL; fr = fr->fr_next) {
		if (fr->fr_type == FR_T_NONE) {
			fr->fr_type = FR_T_IPF;
			fr->fr_data = (void *)calloc(sizeof(fripf_t), 1);
			fr->fr_dsize = sizeof(fripf_t);
			fr->fr_ip.fi_v = frc->fr_v;
			fr->fr_mip.fi_v = 0xf;
			fr->fr_ipf->fri_sifpidx = -1;
			fr->fr_ipf->fri_difpidx = -1;
		}
		if (fr->fr_type != FR_T_IPF) {
			fprintf(stderr, "IPF Type not set\n");
		}
	}
}


static frentry_t *addrule()
{
	frentry_t *f, *f1, *f2;
	int count;

	for (f2 = frc; f2->fr_next != NULL; f2 = f2->fr_next)
		;

	count = nrules;
	f = f2;
	for (f1 = frc; count > 0; count--, f1 = f1->fr_next) {
		f->fr_next = (frentry_t *)calloc(sizeof(*f), 1);
		added++;
		f = f->fr_next;
		bcopy(f1, f, sizeof(*f));
		f->fr_next = NULL;
		if (f->fr_caddr != NULL) {
			f->fr_caddr = malloc(f->fr_dsize);
			bcopy(f1->fr_caddr, f->fr_caddr, f->fr_dsize);
		}
	}

	return f2->fr_next;
}


static u_32_t lookuphost(name)
char *name;
{
	u_32_t addr;
	int i;

	hashed = 0;
	pooled = 0;
	dynamic = -1;

	for (i = 0; i < 4; i++) {
		if (strncmp(name, frc->fr_ifnames[i],
			    sizeof(frc->fr_ifnames[i])) == 0) {
			ifpflag = FRI_DYNAMIC;
			dynamic = i;
			return 0;
		}
	}

	if (gethost(name, &addr) == -1) {
		fprintf(stderr, "unknown name \"%s\"\n", name);
		return 0;
	}
	return addr;
}


static void dobpf(v, phrase)
int v;
char *phrase;
{
#ifdef IPFILTER_BPF
	struct bpf_program bpf;
	struct pcap *p;
#endif
	fakebpf_t *fb;
	u_32_t l;
	char *s;
	int i;

	for (fr = frc; fr != NULL; fr = fr->fr_next) {
		if (fr->fr_type != FR_T_NONE) {
			fprintf(stderr, "cannot mix IPF and BPF matching\n");
			return;
		}
		fr->fr_v = v;
		fr->fr_type = FR_T_BPFOPC;

		if (!strncmp(phrase, "0x", 2)) {
			fb = malloc(sizeof(fakebpf_t));

			for (i = 0, s = strtok(phrase, " \r\n\t"); s != NULL;
			     s = strtok(NULL, " \r\n\t"), i++) {
				fb = realloc(fb, (i / 4 + 1) * sizeof(*fb));
				l = (u_32_t)strtol(s, NULL, 0);
				switch (i & 3)
				{
				case 0 :
					fb[i / 4].fb_c = l & 0xffff;
					break;
				case 1 :
					fb[i / 4].fb_t = l & 0xff;
					break;
				case 2 :
					fb[i / 4].fb_f = l & 0xff;
					break;
				case 3 :
					fb[i / 4].fb_k = l;
					break;
				}
			}
			if ((i & 3) != 0) {
				fprintf(stderr,
					"Odd number of bytes in BPF code\n");
				exit(1);
			}
			i--;
			fr->fr_dsize = (i / 4 + 1) * sizeof(*fb);
			fr->fr_data = fb;
			return;
		}

#ifdef IPFILTER_BPF
		bzero((char *)&bpf, sizeof(bpf));
		p = pcap_open_dead(DLT_RAW, 1);
		if (!p) {
			fprintf(stderr, "pcap_open_dead failed\n");
			return;
		}

		if (pcap_compile(p, &bpf, phrase, 1, 0xffffffff)) {
			pcap_perror(p, "ipf");
			pcap_close(p);
			fprintf(stderr, "pcap parsing failed (%s)\n", phrase);
			return;
		}
		pcap_close(p);

		fr->fr_dsize = bpf.bf_len * sizeof(struct bpf_insn);
		fr->fr_data = malloc(fr->fr_dsize);
		bcopy((char *)bpf.bf_insns, fr->fr_data, fr->fr_dsize);
		if (!bpf_validate(fr->fr_data, bpf.bf_len)) {
			fprintf(stderr, "BPF validation failed\n");
			return;
		}
#endif
	}

#ifdef IPFILTER_BPF
	if (opts & OPT_DEBUG)
		bpf_dump(&bpf, 0);
#else
	fprintf(stderr, "BPF filter expressions not supported\n");
	exit(1);
#endif
}


static void resetaddr()
{
	hashed = 0;
	pooled = 0;
	dynamic = -1;
}


static alist_t *newalist(ptr)
alist_t *ptr;
{
	alist_t *al;

	al = malloc(sizeof(*al));
	if (al == NULL)
		return NULL;
	al->al_not = 0;
	al->al_next = ptr;
	return al;
}


static int makepool(list)
alist_t *list;
{
	ip_pool_node_t *n, *top;
	ip_pool_t pool;
	alist_t *a;
	int num;

	if (list == NULL)
		return 0;
	top = calloc(1, sizeof(*top));
	if (top == NULL)
		return 0;

	for (n = top, a = list; (n != NULL) && (a != NULL); a = a->al_next) {
		n->ipn_addr.adf_addr.in4.s_addr = a->al_1;
		n->ipn_mask.adf_addr.in4.s_addr = a->al_2;
		n->ipn_info = a->al_not;
		if (a->al_next != NULL) {
			n->ipn_next = calloc(1, sizeof(*n));
			n = n->ipn_next;
		}
	}

	bzero((char *)&pool, sizeof(pool));
	pool.ipo_unit = IPL_LOGIPF;
	pool.ipo_list = top;
	num = load_pool(&pool, ipfioctl[IPL_LOGLOOKUP]);

	while ((n = top) != NULL) {
		top = n->ipn_next;
		free(n);
	}
	return num;
}


static u_int makehash(list)
alist_t *list;
{
	iphtent_t *n, *top;
	iphtable_t iph;
	alist_t *a;
	int num;

	if (list == NULL)
		return 0;
	top = calloc(1, sizeof(*top));
	if (top == NULL)
		return 0;

	for (n = top, a = list; (n != NULL) && (a != NULL); a = a->al_next) {
		n->ipe_addr.in4_addr = a->al_1;
		n->ipe_mask.in4_addr = a->al_2;
		n->ipe_value = 0;
		if (a->al_next != NULL) {
			n->ipe_next = calloc(1, sizeof(*n));
			n = n->ipe_next;
		}
	}

	bzero((char *)&iph, sizeof(iph));
	iph.iph_unit = IPL_LOGIPF;
	iph.iph_type = IPHASH_LOOKUP;
	*iph.iph_name = '\0';

	if (load_hash(&iph, top, ipfioctl[IPL_LOGLOOKUP]) == 0)
		sscanf(iph.iph_name, "%u", &num);
	else
		num = 0;

	while ((n = top) != NULL) {
		top = n->ipe_next;
		free(n);
	}
	return num;
}


void ipf_addrule(fd, ioctlfunc, ptr)
int fd;
ioctlfunc_t ioctlfunc;
void *ptr;
{
	ioctlcmd_t add, del;
	frentry_t *fr;
	ipfobj_t obj;

	if (ptr == NULL)
		return;

	fr = ptr;
	add = 0;
	del = 0;

	bzero((char *)&obj, sizeof(obj));
	obj.ipfo_rev = IPFILTER_VERSION;
	obj.ipfo_size = sizeof(*fr);
	obj.ipfo_type = IPFOBJ_FRENTRY;
	obj.ipfo_ptr = ptr;

	if ((opts & OPT_DONOTHING) != 0)
		fd = -1;

	if (opts & OPT_ZERORULEST) {
		add = SIOCZRLST;
	} else if (opts & OPT_INACTIVE) {
		add = (u_int)fr->fr_hits ? SIOCINIFR :
					   SIOCADIFR;
		del = SIOCRMIFR;
	} else {
		add = (u_int)fr->fr_hits ? SIOCINAFR :
					   SIOCADAFR;
		del = SIOCRMAFR;
	}

	if ((opts & OPT_OUTQUE) != 0)
		fr->fr_flags |= FR_OUTQUE;
	if (fr->fr_hits)
		fr->fr_hits--;
	if ((opts & OPT_VERBOSE) != 0)
		printfr(fr, ioctlfunc);

	if ((opts & OPT_DEBUG) != 0) {
		binprint(fr, sizeof(*fr));
		if (fr->fr_data != NULL)
			binprint(fr->fr_data, fr->fr_dsize);
	}

	if ((opts & OPT_ZERORULEST) != 0) {
		if ((*ioctlfunc)(fd, add, (void *)&obj) == -1) {
			if ((opts & OPT_DONOTHING) == 0) {
				fprintf(stderr, "%d:", ipf_yylineNum);
				perror("ioctl(SIOCZRLST)");
			}
		} else {
#ifdef	USE_QUAD_T
			printf("hits %qd bytes %qd ",
				(long long)fr->fr_hits,
				(long long)fr->fr_bytes);
#else
			printf("hits %ld bytes %ld ",
				fr->fr_hits, fr->fr_bytes);
#endif
			printfr(fr, ioctlfunc);
		}
	} else if ((opts & OPT_REMOVE) != 0) {
		if ((*ioctlfunc)(fd, del, (void *)&obj) == -1) {
			if ((opts & OPT_DONOTHING) != 0) {
				fprintf(stderr, "%d:", ipf_yylineNum);
				perror("ioctl(delete rule)");
			}
		}
	} else {
		if ((*ioctlfunc)(fd, add, (void *)&obj) == -1) {
			if (!(opts & OPT_DONOTHING)) {
				fprintf(stderr, "%d:", ipf_yylineNum);
				perror("ioctl(add/insert rule)");
			}
		}
	}
}

static void setsyslog()
{
	ipf_yysetdict(logwords);
	ipf_yybreakondot = 1;
}


static void unsetsyslog()
{
	ipf_yyresetdict();
	ipf_yybreakondot = 0;
}


static void fillgroup(fr)
frentry_t *fr;
{
	frentry_t *f;

	for (f = frold; f != NULL; f = f->fr_next)
		if (strncmp(f->fr_grhead, fr->fr_group, FR_GROUPLEN) == 0)
			break;
	if (f == NULL)
		return;

	/*
	 * Only copy down matching fields if the rules are of the same type
	 * and are of ipf type.   The only fields that are copied are those
	 * that impact the rule parsing itself, eg. need for knowing what the
	 * protocol should be for rules with port comparisons in them.
	 */
	if (f->fr_type != fr->fr_type || f->fr_type != FR_T_IPF)
		return;

	if (fr->fr_v == 0 && f->fr_v != 0)
		fr->fr_v = f->fr_v;

	if (fr->fr_mproto == 0 && f->fr_mproto != 0)
		fr->fr_mproto = f->fr_mproto;
	if (fr->fr_proto == 0 && f->fr_proto != 0)
		fr->fr_proto = f->fr_proto;

	if ((fr->fr_mproto == 0) && ((fr->fr_flx & FI_TCPUDP) == 0) &&
	    ((f->fr_flx & FI_TCPUDP) != 0))
		fr->fr_flx |= FI_TCPUDP;
}
#line 2766 "y.tab.c"
/* allocate initial stack or double stack size, up to YYMAXDEPTH */
static int ipf_yygrowstack(void)
{
    int newsize, i;
    short *newss;
    YYSTYPE *newvs;

    if ((newsize = ipf_yystacksize) == 0)
        newsize = YYINITSTACKSIZE;
    else if (newsize >= YYMAXDEPTH)
        return -1;
    else if ((newsize *= 2) > YYMAXDEPTH)
        newsize = YYMAXDEPTH;

    i = ipf_yyssp - ipf_yyss;
    newss = (ipf_yyss != 0)
          ? (short *)realloc(ipf_yyss, newsize * sizeof(*newss))
          : (short *)malloc(newsize * sizeof(*newss));
    if (newss == 0)
        return -1;

    ipf_yyss  = newss;
    ipf_yyssp = newss + i;
    newvs = (ipf_yyvs != 0)
          ? (YYSTYPE *)realloc(ipf_yyvs, newsize * sizeof(*newvs))
          : (YYSTYPE *)malloc(newsize * sizeof(*newvs));
    if (newvs == 0)
        return -1;

    ipf_yyvs = newvs;
    ipf_yyvsp = newvs + i;
    ipf_yystacksize = newsize;
    ipf_yysslim = ipf_yyss + newsize - 1;
    return 0;
}

#define YYABORT goto ipf_yyabort
#define YYREJECT goto ipf_yyabort
#define YYACCEPT goto ipf_yyaccept
#define YYERROR goto ipf_yyerrlab
int
ipf_yyparse(void)
{
    register int ipf_yym, ipf_yyn, ipf_yystate;
#if YYDEBUG
    register const char *ipf_yys;

    if ((ipf_yys = getenv("YYDEBUG")) != 0)
    {
        ipf_yyn = *ipf_yys;
        if (ipf_yyn >= '0' && ipf_yyn <= '9')
            ipf_yydebug = ipf_yyn - '0';
    }
#endif

    ipf_yynerrs = 0;
    ipf_yyerrflag = 0;
    ipf_yychar = YYEMPTY;

    if (ipf_yyss == NULL && ipf_yygrowstack()) goto ipf_yyoverflow;
    ipf_yyssp = ipf_yyss;
    ipf_yyvsp = ipf_yyvs;
    *ipf_yyssp = ipf_yystate = 0;

ipf_yyloop:
    if ((ipf_yyn = ipf_yydefred[ipf_yystate]) != 0) goto ipf_yyreduce;
    if (ipf_yychar < 0)
    {
        if ((ipf_yychar = ipf_yylex()) < 0) ipf_yychar = 0;
#if YYDEBUG
        if (ipf_yydebug)
        {
            ipf_yys = 0;
            if (ipf_yychar <= YYMAXTOKEN) ipf_yys = ipf_yyname[ipf_yychar];
            if (!ipf_yys) ipf_yys = "illegal-symbol";
            printf("%sdebug: state %d, reading %d (%s)\n",
                    YYPREFIX, ipf_yystate, ipf_yychar, ipf_yys);
        }
#endif
    }
    if ((ipf_yyn = ipf_yysindex[ipf_yystate]) && (ipf_yyn += ipf_yychar) >= 0 &&
            ipf_yyn <= YYTABLESIZE && ipf_yycheck[ipf_yyn] == ipf_yychar)
    {
#if YYDEBUG
        if (ipf_yydebug)
            printf("%sdebug: state %d, shifting to state %d\n",
                    YYPREFIX, ipf_yystate, ipf_yytable[ipf_yyn]);
#endif
        if (ipf_yyssp >= ipf_yysslim && ipf_yygrowstack())
        {
            goto ipf_yyoverflow;
        }
        *++ipf_yyssp = ipf_yystate = ipf_yytable[ipf_yyn];
        *++ipf_yyvsp = ipf_yylval;
        ipf_yychar = YYEMPTY;
        if (ipf_yyerrflag > 0)  --ipf_yyerrflag;
        goto ipf_yyloop;
    }
    if ((ipf_yyn = ipf_yyrindex[ipf_yystate]) && (ipf_yyn += ipf_yychar) >= 0 &&
            ipf_yyn <= YYTABLESIZE && ipf_yycheck[ipf_yyn] == ipf_yychar)
    {
        ipf_yyn = ipf_yytable[ipf_yyn];
        goto ipf_yyreduce;
    }
    if (ipf_yyerrflag) goto ipf_yyinrecovery;

    ipf_yyerror("syntax error");

#ifdef lint
    goto ipf_yyerrlab;
#endif

ipf_yyerrlab:
    ++ipf_yynerrs;

ipf_yyinrecovery:
    if (ipf_yyerrflag < 3)
    {
        ipf_yyerrflag = 3;
        for (;;)
        {
            if ((ipf_yyn = ipf_yysindex[*ipf_yyssp]) && (ipf_yyn += YYERRCODE) >= 0 &&
                    ipf_yyn <= YYTABLESIZE && ipf_yycheck[ipf_yyn] == YYERRCODE)
            {
#if YYDEBUG
                if (ipf_yydebug)
                    printf("%sdebug: state %d, error recovery shifting\
 to state %d\n", YYPREFIX, *ipf_yyssp, ipf_yytable[ipf_yyn]);
#endif
                if (ipf_yyssp >= ipf_yysslim && ipf_yygrowstack())
                {
                    goto ipf_yyoverflow;
                }
                *++ipf_yyssp = ipf_yystate = ipf_yytable[ipf_yyn];
                *++ipf_yyvsp = ipf_yylval;
                goto ipf_yyloop;
            }
            else
            {
#if YYDEBUG
                if (ipf_yydebug)
                    printf("%sdebug: error recovery discarding state %d\n",
                            YYPREFIX, *ipf_yyssp);
#endif
                if (ipf_yyssp <= ipf_yyss) goto ipf_yyabort;
                --ipf_yyssp;
                --ipf_yyvsp;
            }
        }
    }
    else
    {
        if (ipf_yychar == 0) goto ipf_yyabort;
#if YYDEBUG
        if (ipf_yydebug)
        {
            ipf_yys = 0;
            if (ipf_yychar <= YYMAXTOKEN) ipf_yys = ipf_yyname[ipf_yychar];
            if (!ipf_yys) ipf_yys = "illegal-symbol";
            printf("%sdebug: state %d, error recovery discards token %d (%s)\n",
                    YYPREFIX, ipf_yystate, ipf_yychar, ipf_yys);
        }
#endif
        ipf_yychar = YYEMPTY;
        goto ipf_yyloop;
    }

ipf_yyreduce:
#if YYDEBUG
    if (ipf_yydebug)
        printf("%sdebug: state %d, reducing by rule %d (%s)\n",
                YYPREFIX, ipf_yystate, ipf_yyn, ipf_yyrule[ipf_yyn]);
#endif
    ipf_yym = ipf_yylen[ipf_yyn];
    ipf_yyval = ipf_yyvsp[1-ipf_yym];
    switch (ipf_yyn)
    {
case 5:
#line 177 "../tools/ipf_y.y"
{ while ((fr = frtop) != NULL) {
				frtop = fr->fr_next;
				fr->fr_next = NULL;
				(*ipfaddfunc)(ipffd, ipfioctl[IPL_LOGIPF], fr);
				fr->fr_next = frold;
				frold = fr;
			  }
			  resetlexer();
			}
break;
case 7:
#line 189 "../tools/ipf_y.y"
{ newrule(); }
break;
case 8:
#line 192 "../tools/ipf_y.y"
{ set_variable(ipf_yyvsp[-3].str, ipf_yyvsp[-1].str);
					  resetlexer();
					  free(ipf_yyvsp[-3].str);
					  free(ipf_yyvsp[-1].str);
					  ipf_yyvarnext = 0;
					}
break;
case 9:
#line 201 "../tools/ipf_y.y"
{ ipf_yyvarnext = 1; }
break;
case 18:
#line 224 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_INQUE; }
break;
case 19:
#line 228 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_OUTQUE; }
break;
case 23:
#line 241 "../tools/ipf_y.y"
{ dobpf(4, ipf_yyvsp[-1].str); free(ipf_yyvsp[-1].str); }
break;
case 24:
#line 242 "../tools/ipf_y.y"
{ dobpf(6, ipf_yyvsp[-1].str); free(ipf_yyvsp[-1].str); }
break;
case 29:
#line 260 "../tools/ipf_y.y"
{ fr->fr_hits = (U_QUAD_T)ipf_yyvsp[0].num + 1; }
break;
case 31:
#line 264 "../tools/ipf_y.y"
{ fr->fr_collect = ipf_yyvsp[0].num; }
break;
case 33:
#line 268 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_PASS; }
break;
case 34:
#line 269 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_NOMATCH; }
break;
case 36:
#line 271 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_ACCOUNT; }
break;
case 38:
#line 273 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_SKIP;
					  fr->fr_arg = ipf_yyvsp[0].num; }
break;
case 40:
#line 276 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_CALLNOW; }
break;
case 43:
#line 284 "../tools/ipf_y.y"
{ fr->fr_flags = FR_BLOCK; }
break;
case 44:
#line 287 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_RETICMP; }
break;
case 45:
#line 288 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_RETICMP; }
break;
case 46:
#line 289 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_FAKEICMP; }
break;
case 47:
#line 290 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_FAKEICMP; }
break;
case 48:
#line 291 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_RETRST; }
break;
case 49:
#line 294 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_LOG; }
break;
case 50:
#line 295 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_LOG; }
break;
case 51:
#line 298 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_AUTH; }
break;
case 52:
#line 299 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_AUTH;}
break;
case 53:
#line 300 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_PREAUTH; }
break;
case 54:
#line 303 "../tools/ipf_y.y"
{ fr->fr_func = nametokva(ipf_yyvsp[-2].str,
							  ipfioctl[IPL_LOGIPF]);
				  fr->fr_arg = ipf_yyvsp[0].num;
				  free(ipf_yyvsp[-2].str); }
break;
case 73:
#line 336 "../tools/ipf_y.y"
{ DOALL(fr->fr_tos = ipf_yyvsp[0].num; fr->fr_mtos = 0xff;) }
break;
case 74:
#line 337 "../tools/ipf_y.y"
{ DOALL(fr->fr_tos = ipf_yyvsp[0].num; fr->fr_mtos = 0xff;) }
break;
case 76:
#line 341 "../tools/ipf_y.y"
{ setipftype(); }
break;
case 77:
#line 345 "../tools/ipf_y.y"
{ DOALL(fr->fr_tos = ipf_yyvsp[0].num; fr->fr_mtos = 0xff;) }
break;
case 78:
#line 346 "../tools/ipf_y.y"
{ DOREM(fr->fr_tos = ipf_yyvsp[0].num; fr->fr_mtos = 0xff;) }
break;
case 79:
#line 348 "../tools/ipf_y.y"
{ DOREM(fr->fr_tos = ipf_yyvsp[0].num; fr->fr_mtos = 0xff;) }
break;
case 80:
#line 350 "../tools/ipf_y.y"
{ DOREM(fr->fr_tos = ipf_yyvsp[0].num; fr->fr_mtos = 0xff;) }
break;
case 82:
#line 354 "../tools/ipf_y.y"
{ DOALL(fr->fr_ttl = ipf_yyvsp[0].num; fr->fr_mttl = 0xff;) }
break;
case 84:
#line 358 "../tools/ipf_y.y"
{ newlist = 1; fr = frc; added = 0; }
break;
case 85:
#line 361 "../tools/ipf_y.y"
{ nrules += added; }
break;
case 86:
#line 364 "../tools/ipf_y.y"
{ if (newlist == 1) {
						newlist = 0;
					  }
					  fr = addrule();
					  if (ipf_yycont != NULL)
						*ipf_yycont = 1;
					}
break;
case 89:
#line 377 "../tools/ipf_y.y"
{ setipftype(); }
break;
case 90:
#line 381 "../tools/ipf_y.y"
{ DOREM(fr->fr_ttl = ipf_yyvsp[0].num; fr->fr_mttl = 0xff;) }
break;
case 91:
#line 383 "../tools/ipf_y.y"
{ DOREM(fr->fr_ttl = ipf_yyvsp[0].num; fr->fr_mttl = 0xff;) }
break;
case 93:
#line 386 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 94:
#line 389 "../tools/ipf_y.y"
{ setipftype();
					  fr = frc;
					  ipf_yysetdict(NULL); }
break;
case 97:
#line 397 "../tools/ipf_y.y"
{ DOALL(strncpy(fr->fr_group, ipf_yyvsp[0].str, \
							FR_GROUPLEN); \
							fillgroup(fr););
					  free(ipf_yyvsp[0].str); }
break;
case 98:
#line 401 "../tools/ipf_y.y"
{ DOALL(sprintf(fr->fr_group, "%d", \
							ipf_yyvsp[0].num); \
							fillgroup(fr);) }
break;
case 100:
#line 406 "../tools/ipf_y.y"
{ DOALL(strncpy(fr->fr_grhead, ipf_yyvsp[0].str, \
							FR_GROUPLEN););
					  free(ipf_yyvsp[0].str); }
break;
case 101:
#line 409 "../tools/ipf_y.y"
{ DOALL(sprintf(fr->fr_grhead, "%d", \
							ipf_yyvsp[0].num);) }
break;
case 107:
#line 426 "../tools/ipf_y.y"
{ DOALL(strncpy(fr->fr_nattag.ipt_tag,\
						ipf_yyvsp[0].str, IPFTAG_LEN););
					  free(ipf_yyvsp[0].str); }
break;
case 108:
#line 429 "../tools/ipf_y.y"
{ DOALL(sprintf(fr->fr_nattag.ipt_tag,\
						"%d", ipf_yyvsp[0].num & 0xffffffff);) }
break;
case 109:
#line 433 "../tools/ipf_y.y"
{ DOALL(fr->fr_logtag = ipf_yyvsp[0].num;) }
break;
case 121:
#line 458 "../tools/ipf_y.y"
{ DOALL(fr->fr_pps = ipf_yyvsp[0].num;) }
break;
case 127:
#line 476 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_QUICK; }
break;
case 132:
#line 485 "../tools/ipf_y.y"
{ DOREM(strncpy(fr->fr_ifnames[0], ipf_yyvsp[0].ifs.if1, \
					sizeof(fr->fr_ifnames[0])); 	   \
					if (ipf_yyvsp[0].ifs.if2 != NULL) {		   \
						strncpy(fr->fr_ifnames[1], \
							ipf_yyvsp[0].ifs.if2,		   \
						sizeof(fr->fr_ifnames[1]));\
					}				   \
					) }
break;
case 133:
#line 493 "../tools/ipf_y.y"
{ DOREM(strncpy(fr->fr_ifnames[0], ipf_yyvsp[0].ifs.if1, \
					sizeof(fr->fr_ifnames[0])); 	   \
					if (ipf_yyvsp[0].ifs.if2 != NULL) {		   \
						strncpy(fr->fr_ifnames[1], \
							ipf_yyvsp[0].ifs.if2,		   \
						sizeof(fr->fr_ifnames[1]));\
					}				   \
					) }
break;
case 134:
#line 504 "../tools/ipf_y.y"
{ strncpy(fr->fr_ifnames[0], ipf_yyvsp[0].str, sizeof(fr->fr_ifnames[0]));
		  ipf_yyval.ifs.if1 = fr->fr_ifnames[0];
		  ipf_yyval.ifs.if2 = NULL;
		  free(ipf_yyvsp[0].str);
		}
break;
case 135:
#line 510 "../tools/ipf_y.y"
{ strncpy(fr->fr_ifnames[0], ipf_yyvsp[-2].str, sizeof(fr->fr_ifnames[0]));
		  ipf_yyval.ifs.if1 = fr->fr_ifnames[0];
		  free(ipf_yyvsp[-2].str);
		  strncpy(fr->fr_ifnames[1], ipf_yyvsp[0].str, sizeof(fr->fr_ifnames[1]));
		  ipf_yyval.ifs.if1 = fr->fr_ifnames[1];
		  free(ipf_yyvsp[0].str);
		}
break;
case 136:
#line 521 "../tools/ipf_y.y"
{ strncpy(fr->fr_ifnames[2], ipf_yyvsp[0].str, sizeof(fr->fr_ifnames[2]));
		  free(ipf_yyvsp[0].str);
		}
break;
case 137:
#line 525 "../tools/ipf_y.y"
{ strncpy(fr->fr_ifnames[2], ipf_yyvsp[-2].str, sizeof(fr->fr_ifnames[2]));
		  free(ipf_yyvsp[-2].str);
		  strncpy(fr->fr_ifnames[3], ipf_yyvsp[0].str, sizeof(fr->fr_ifnames[3]));
		  free(ipf_yyvsp[0].str);
		}
break;
case 138:
#line 533 "../tools/ipf_y.y"
{ strncpy(fr->fr_dif.fd_ifname, ipf_yyvsp[0].str, sizeof(fr->fr_dif.fd_ifname));
	  fr->fr_flags |= FR_DUP;
	  free(ipf_yyvsp[0].str);
	}
break;
case 139:
#line 538 "../tools/ipf_y.y"
{ strncpy(fr->fr_dif.fd_ifname, ipf_yyvsp[-2].str, sizeof(fr->fr_dif.fd_ifname));
	  fr->fr_flags |= FR_DUP;
	  fr->fr_dif.fd_ip = ipf_yyvsp[0].ipa;
	  ipf_yyexpectaddr = 0;
	  free(ipf_yyvsp[-2].str);
	}
break;
case 140:
#line 545 "../tools/ipf_y.y"
{ strncpy(fr->fr_dif.fd_ifname, ipf_yyvsp[-2].str, sizeof(fr->fr_dif.fd_ifname));
	  bcopy(&ipf_yyvsp[0].ip6, &fr->fr_dif.fd_ip6, sizeof(fr->fr_dif.fd_ip6));
	  fr->fr_flags |= FR_DUP;
	  ipf_yyexpectaddr = 0;
	  free(ipf_yyvsp[-2].str);
	}
break;
case 141:
#line 554 "../tools/ipf_y.y"
{ ipf_yyexpectaddr = 1; ipf_yycont = &ipf_yyexpectaddr; resetaddr(); }
break;
case 142:
#line 557 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_FASTROUTE; }
break;
case 143:
#line 561 "../tools/ipf_y.y"
{ strncpy(fr->fr_tif.fd_ifname, ipf_yyvsp[0].str, sizeof(fr->fr_tif.fd_ifname));
	  free(ipf_yyvsp[0].str);
	}
break;
case 144:
#line 565 "../tools/ipf_y.y"
{ strncpy(fr->fr_tif.fd_ifname, ipf_yyvsp[-2].str, sizeof(fr->fr_tif.fd_ifname));
	  fr->fr_tif.fd_ip = ipf_yyvsp[0].ipa;
	  ipf_yyexpectaddr = 0;
	  free(ipf_yyvsp[-2].str);
	}
break;
case 145:
#line 571 "../tools/ipf_y.y"
{ strncpy(fr->fr_tif.fd_ifname, ipf_yyvsp[-2].str, sizeof(fr->fr_tif.fd_ifname));
	  bcopy(&ipf_yyvsp[0].ip6, &fr->fr_tif.fd_ip6, sizeof(fr->fr_tif.fd_ip6));
	  ipf_yyexpectaddr = 0;
	  free(ipf_yyvsp[-2].str);
	}
break;
case 148:
#line 585 "../tools/ipf_y.y"
{ strncpy(fr->fr_rif.fd_ifname, ipf_yyvsp[0].str, sizeof(fr->fr_rif.fd_ifname));
	  free(ipf_yyvsp[0].str);
	}
break;
case 149:
#line 589 "../tools/ipf_y.y"
{ strncpy(fr->fr_rif.fd_ifname, ipf_yyvsp[-2].str, sizeof(fr->fr_rif.fd_ifname));
	  fr->fr_rif.fd_ip = ipf_yyvsp[0].ipa;
	  free(ipf_yyvsp[-2].str);
	}
break;
case 152:
#line 601 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_LOGBODY; }
break;
case 153:
#line 602 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_LOGFIRST; }
break;
case 154:
#line 603 "../tools/ipf_y.y"
{ fr->fr_flags |= FR_LOGORBLOCK; }
break;
case 155:
#line 604 "../tools/ipf_y.y"
{ unsetsyslog(); }
break;
case 156:
#line 608 "../tools/ipf_y.y"
{ fr->fr_icode = ipf_yyvsp[-1].num; ipf_yyresetdict(); }
break;
case 157:
#line 612 "../tools/ipf_y.y"
{ ipf_yysetdict(icmpcodewords); }
break;
case 161:
#line 620 "../tools/ipf_y.y"
{ DOREM(fr->fr_proto = ipf_yyvsp[0].num; \
					fr->fr_mproto = 0xff;) }
break;
case 162:
#line 622 "../tools/ipf_y.y"
{ if (!strcmp(ipf_yyvsp[0].str, "tcp-udp")) {
					DOREM(fr->fr_flx |= FI_TCPUDP; \
					      fr->fr_mflx |= FI_TCPUDP;)
				  } else {
					int p = getproto(ipf_yyvsp[0].str);
					if (p == -1)
						ipf_yyerror("protocol unknown");
					DOREM(fr->fr_proto = p; \
						fr->fr_mproto = 0xff;)
				  }
				  free(ipf_yyvsp[0].str);
					}
break;
case 163:
#line 635 "../tools/ipf_y.y"
{ if (!strcmp(ipf_yyvsp[-2].str, "tcp") &&
				      !strcmp(ipf_yyvsp[0].str, "udp")) {
					DOREM(fr->fr_flx |= FI_TCPUDP; \
					      fr->fr_mflx |= FI_TCPUDP;)
				  } else
					YYERROR;
				  free(ipf_yyvsp[-2].str);
				  free(ipf_yyvsp[0].str);
				}
break;
case 164:
#line 647 "../tools/ipf_y.y"
{ ipf_yysetdict(NULL); }
break;
case 165:
#line 650 "../tools/ipf_y.y"
{ ipf_yyexpectaddr = 0; ipf_yycont = NULL; }
break;
case 166:
#line 651 "../tools/ipf_y.y"
{ ipf_yyexpectaddr = 0; ipf_yycont = NULL; }
break;
case 167:
#line 652 "../tools/ipf_y.y"
{ ipf_yyexpectaddr = 0; ipf_yycont = NULL; }
break;
case 168:
#line 655 "../tools/ipf_y.y"
{ setipftype();
					  if (fr == NULL)
						fr = frc;
					  ipf_yyexpectaddr = 1;
					  if (ipf_yydebug)
						printf("set ipf_yyexpectaddr\n");
					  ipf_yycont = &ipf_yyexpectaddr;
					  ipf_yysetdict(addrwords);
					  resetaddr(); }
break;
case 169:
#line 666 "../tools/ipf_y.y"
{ if (fr == NULL)
						fr = frc;
					  ipf_yyexpectaddr = 1;
					  if (ipf_yydebug)
						printf("set ipf_yyexpectaddr\n");
					  ipf_yycont = &ipf_yyexpectaddr;
					  ipf_yysetdict(addrwords);
					  resetaddr(); }
break;
case 172:
#line 680 "../tools/ipf_y.y"
{ nowith = 0; setipftype(); }
break;
case 173:
#line 681 "../tools/ipf_y.y"
{ nowith = 0; setipftype(); }
break;
case 175:
#line 685 "../tools/ipf_y.y"
{ DOALL(fr->fr_tcpf = ipf_yyvsp[0].num; fr->fr_tcpfm = FR_TCPFMAX;) }
break;
case 176:
#line 687 "../tools/ipf_y.y"
{ DOALL(fr->fr_tcpf = ipf_yyvsp[-2].num; fr->fr_tcpfm = ipf_yyvsp[0].num;) }
break;
case 177:
#line 689 "../tools/ipf_y.y"
{ DOALL(fr->fr_tcpf = 0; fr->fr_tcpfm = ipf_yyvsp[0].num;) }
break;
case 178:
#line 691 "../tools/ipf_y.y"
{ DOALL(fr->fr_tcpf = ipf_yyvsp[0].num; fr->fr_tcpfm = FR_TCPFMAX;) }
break;
case 179:
#line 693 "../tools/ipf_y.y"
{ DOALL(fr->fr_tcpf = 0; fr->fr_tcpfm = ipf_yyvsp[0].num;) }
break;
case 180:
#line 695 "../tools/ipf_y.y"
{ DOALL(fr->fr_tcpf = ipf_yyvsp[-2].num; fr->fr_tcpfm = ipf_yyvsp[0].num;) }
break;
case 181:
#line 697 "../tools/ipf_y.y"
{ DOALL(fr->fr_tcpf = ipf_yyvsp[-2].num; fr->fr_tcpfm = ipf_yyvsp[0].num;) }
break;
case 182:
#line 699 "../tools/ipf_y.y"
{ DOALL(fr->fr_tcpf = ipf_yyvsp[-2].num; fr->fr_tcpfm = ipf_yyvsp[0].num;) }
break;
case 183:
#line 703 "../tools/ipf_y.y"
{ if (frc->fr_type != FR_T_IPF)
				ipf_yyerror("flags with non-ipf type rule");
			  if (frc->fr_proto != IPPROTO_TCP)
				ipf_yyerror("flags with non-TCP rule");
			}
break;
case 184:
#line 711 "../tools/ipf_y.y"
{ ipf_yyval.num = tcpflags(ipf_yyvsp[0].str); free(ipf_yyvsp[0].str); }
break;
case 185:
#line 712 "../tools/ipf_y.y"
{ ipf_yyval.num = ipf_yyvsp[0].num; }
break;
case 186:
#line 716 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 189:
#line 719 "../tools/ipf_y.y"
{ DOALL(fr->fr_flags |= FR_NOTSRCIP;) }
break;
case 190:
#line 723 "../tools/ipf_y.y"
{ DOREM(bcopy(&(ipf_yyvsp[0].ipp.a), &fr->fr_ip.fi_src, sizeof(ipf_yyvsp[0].ipp.a)); \
			bcopy(&(ipf_yyvsp[0].ipp.m), &fr->fr_mip.fi_src, sizeof(ipf_yyvsp[0].ipp.m)); \
			if (dynamic != -1) { \
				fr->fr_satype = ifpflag; \
				fr->fr_ipf->fri_sifpidx = dynamic; \
			} else if (pooled || hashed) \
				fr->fr_satype = FRI_LOOKUP;)
		}
break;
case 192:
#line 735 "../tools/ipf_y.y"
{ DOREM(bcopy(&(ipf_yyvsp[0].ipp.a), &fr->fr_ip.fi_src, sizeof(ipf_yyvsp[0].ipp.a)); \
			bcopy(&(ipf_yyvsp[0].ipp.m), &fr->fr_mip.fi_src, sizeof(ipf_yyvsp[0].ipp.m)); \
			if (dynamic != -1) { \
				fr->fr_satype = ifpflag; \
				fr->fr_ipf->fri_sifpidx = dynamic; \
			} else if (pooled || hashed) \
				fr->fr_satype = FRI_LOOKUP;)
		}
break;
case 193:
#line 744 "../tools/ipf_y.y"
{ DOREM(bcopy(&(ipf_yyvsp[0].ipp.a), &fr->fr_ip.fi_src, sizeof(ipf_yyvsp[0].ipp.a)); \
			bcopy(&(ipf_yyvsp[0].ipp.m), &fr->fr_mip.fi_src, sizeof(ipf_yyvsp[0].ipp.m)); \
			if (dynamic != -1) { \
				fr->fr_satype = ifpflag; \
				fr->fr_ipf->fri_sifpidx = dynamic; \
			} else if (pooled || hashed) \
				fr->fr_satype = FRI_LOOKUP;)
		}
break;
case 195:
#line 756 "../tools/ipf_y.y"
{ DOALL(fr->fr_scmp = ipf_yyvsp[0].pc.pc; fr->fr_sport = ipf_yyvsp[0].pc.p1;) }
break;
case 196:
#line 758 "../tools/ipf_y.y"
{ DOALL(fr->fr_scmp = ipf_yyvsp[0].pc.pc; fr->fr_sport = ipf_yyvsp[0].pc.p1; \
			fr->fr_stop = ipf_yyvsp[0].pc.p2;) }
break;
case 197:
#line 761 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 198:
#line 766 "../tools/ipf_y.y"
{ DOALL(fr->fr_scmp = ipf_yyvsp[0].pc.pc; fr->fr_sport = ipf_yyvsp[0].pc.p1;) }
break;
case 199:
#line 768 "../tools/ipf_y.y"
{ DOALL(fr->fr_scmp = ipf_yyvsp[0].pc.pc; fr->fr_sport = ipf_yyvsp[0].pc.p1; \
			fr->fr_stop = ipf_yyvsp[0].pc.p2;) }
break;
case 200:
#line 771 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 201:
#line 775 "../tools/ipf_y.y"
{ DOREM(fr->fr_scmp = FR_EQUAL; fr->fr_sport = ipf_yyvsp[0].port;) }
break;
case 202:
#line 777 "../tools/ipf_y.y"
{ DOREM(fr->fr_scmp = FR_INCRANGE; fr->fr_sport = ipf_yyvsp[-2].port; \
				fr->fr_stop = ipf_yyvsp[0].port;) }
break;
case 203:
#line 780 "../tools/ipf_y.y"
{ DOREM(fr->fr_scmp = FR_INRANGE; fr->fr_sport = ipf_yyvsp[-2].port; \
				fr->fr_stop = ipf_yyvsp[0].port;) }
break;
case 204:
#line 783 "../tools/ipf_y.y"
{ DOREM(fr->fr_scmp = FR_EQUAL; fr->fr_sport = ipf_yyvsp[0].port;) }
break;
case 205:
#line 785 "../tools/ipf_y.y"
{ DOREM(fr->fr_scmp = FR_INCRANGE; fr->fr_sport = ipf_yyvsp[-2].port; \
				fr->fr_stop = ipf_yyvsp[0].port;) }
break;
case 206:
#line 788 "../tools/ipf_y.y"
{ DOREM(fr->fr_scmp = FR_INRANGE; fr->fr_sport = ipf_yyvsp[-2].port; \
				fr->fr_stop = ipf_yyvsp[0].port;) }
break;
case 207:
#line 793 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 210:
#line 796 "../tools/ipf_y.y"
{ DOALL(fr->fr_flags |= FR_NOTDSTIP;) }
break;
case 211:
#line 800 "../tools/ipf_y.y"
{ DOREM(bcopy(&(ipf_yyvsp[0].ipp.a), &fr->fr_ip.fi_dst, sizeof(ipf_yyvsp[0].ipp.a)); \
			bcopy(&(ipf_yyvsp[0].ipp.m), &fr->fr_mip.fi_dst, sizeof(ipf_yyvsp[0].ipp.m)); \
			if (dynamic != -1) { \
				fr->fr_datype = ifpflag; \
				fr->fr_ipf->fri_difpidx = dynamic; \
			  } else if (pooled || hashed) \
				fr->fr_datype = FRI_LOOKUP;)
		}
break;
case 213:
#line 812 "../tools/ipf_y.y"
{ DOREM(bcopy(&(ipf_yyvsp[0].ipp.a), &fr->fr_ip.fi_dst, sizeof(ipf_yyvsp[0].ipp.a)); \
			bcopy(&(ipf_yyvsp[0].ipp.m), &fr->fr_mip.fi_dst, sizeof(ipf_yyvsp[0].ipp.m)); \
			if (dynamic != -1) { \
				fr->fr_datype = ifpflag; \
				fr->fr_ipf->fri_difpidx = dynamic; \
			} else if (pooled || hashed) \
				fr->fr_datype = FRI_LOOKUP;)
		}
break;
case 214:
#line 821 "../tools/ipf_y.y"
{ DOREM(bcopy(&(ipf_yyvsp[0].ipp.a), &fr->fr_ip.fi_dst, sizeof(ipf_yyvsp[0].ipp.a)); \
			bcopy(&(ipf_yyvsp[0].ipp.m), &fr->fr_mip.fi_dst, sizeof(ipf_yyvsp[0].ipp.m)); \
			if (dynamic != -1) { \
				fr->fr_datype = ifpflag; \
				fr->fr_ipf->fri_difpidx = dynamic; \
			} else if (pooled || hashed) \
				fr->fr_datype = FRI_LOOKUP;)
		}
break;
case 216:
#line 834 "../tools/ipf_y.y"
{ DOALL(fr->fr_dcmp = ipf_yyvsp[0].pc.pc; fr->fr_dport = ipf_yyvsp[0].pc.p1;) }
break;
case 217:
#line 836 "../tools/ipf_y.y"
{ DOALL(fr->fr_dcmp = ipf_yyvsp[0].pc.pc; fr->fr_dport = ipf_yyvsp[0].pc.p1; \
			fr->fr_dtop = ipf_yyvsp[0].pc.p2;) }
break;
case 218:
#line 839 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 219:
#line 844 "../tools/ipf_y.y"
{ DOALL(fr->fr_dcmp = ipf_yyvsp[0].pc.pc; fr->fr_dport = ipf_yyvsp[0].pc.p1;) }
break;
case 220:
#line 846 "../tools/ipf_y.y"
{ DOALL(fr->fr_dcmp = ipf_yyvsp[0].pc.pc; fr->fr_dport = ipf_yyvsp[0].pc.p1; \
			fr->fr_dtop = ipf_yyvsp[0].pc.p2;) }
break;
case 221:
#line 849 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 222:
#line 853 "../tools/ipf_y.y"
{ DOREM(fr->fr_dcmp = FR_EQUAL; fr->fr_dport = ipf_yyvsp[0].port;) }
break;
case 223:
#line 855 "../tools/ipf_y.y"
{ DOREM(fr->fr_dcmp = FR_INCRANGE; fr->fr_dport = ipf_yyvsp[-2].port; \
				fr->fr_dtop = ipf_yyvsp[0].port;) }
break;
case 224:
#line 858 "../tools/ipf_y.y"
{ DOREM(fr->fr_dcmp = FR_INRANGE; fr->fr_dport = ipf_yyvsp[-2].port; \
				fr->fr_dtop = ipf_yyvsp[0].port;) }
break;
case 225:
#line 861 "../tools/ipf_y.y"
{ DOREM(fr->fr_dcmp = FR_EQUAL; fr->fr_dport = ipf_yyvsp[0].port;) }
break;
case 226:
#line 863 "../tools/ipf_y.y"
{ DOREM(fr->fr_dcmp = FR_INCRANGE; fr->fr_dport = ipf_yyvsp[-2].port; \
				fr->fr_dtop = ipf_yyvsp[0].port;) }
break;
case 227:
#line 866 "../tools/ipf_y.y"
{ DOREM(fr->fr_dcmp = FR_INRANGE; fr->fr_dport = ipf_yyvsp[-2].port; \
				fr->fr_dtop = ipf_yyvsp[0].port;) }
break;
case 228:
#line 870 "../tools/ipf_y.y"
{ pooled = 1;
					  ipf_yyval.ipp.a.iplookuptype = IPLT_POOL;
					  ipf_yyval.ipp.a.iplookupsubtype = 0;
					  ipf_yyval.ipp.a.iplookupnum = ipf_yyvsp[0].num; }
break;
case 229:
#line 874 "../tools/ipf_y.y"
{ pooled = 1;
					  ipf_yyval.ipp.a.iplookuptype = IPLT_POOL;
					  ipf_yyval.ipp.a.iplookupsubtype = 1;
					  strncpy(ipf_yyval.ipp.a.iplookupname, ipf_yyvsp[0].str,
						  sizeof(ipf_yyval.ipp.a.iplookupname));
					}
break;
case 230:
#line 880 "../tools/ipf_y.y"
{ pooled = 1;
					  ipf_yyval.ipp.a.iplookuptype = IPLT_POOL;
					  ipf_yyval.ipp.a.iplookupsubtype = 0;
					  ipf_yyval.ipp.a.iplookupnum = makepool(ipf_yyvsp[-1].alist); }
break;
case 231:
#line 884 "../tools/ipf_y.y"
{ hashed = 1;
					  ipf_yyval.ipp.a.iplookuptype = IPLT_HASH;
					  ipf_yyval.ipp.a.iplookupsubtype = 0;
					  ipf_yyval.ipp.a.iplookupnum = ipf_yyvsp[0].num; }
break;
case 232:
#line 888 "../tools/ipf_y.y"
{ hashed = 1;
					  ipf_yyval.ipp.a.iplookuptype = IPLT_HASH;
					  ipf_yyval.ipp.a.iplookupsubtype = 1;
					  strncpy(ipf_yyval.ipp.a.iplookupname, ipf_yyvsp[0].str,
						  sizeof(ipf_yyval.ipp.a.iplookupname));
					}
break;
case 233:
#line 894 "../tools/ipf_y.y"
{ hashed = 1;
					  ipf_yyval.ipp.a.iplookuptype = IPLT_HASH;
					  ipf_yyval.ipp.a.iplookupsubtype = 0;
					  ipf_yyval.ipp.a.iplookupnum = makehash(ipf_yyvsp[-1].alist); }
break;
case 234:
#line 898 "../tools/ipf_y.y"
{ bcopy(&ipf_yyvsp[0].ipp, &ipf_yyval.ipp, sizeof(ipf_yyval.ipp));
					  ipf_yyexpectaddr = 0; }
break;
case 235:
#line 902 "../tools/ipf_y.y"
{ bzero(&(ipf_yyval.ipp), sizeof(ipf_yyval.ipp));
					  ipf_yyresetdict();
					  ipf_yyexpectaddr = 0; }
break;
case 236:
#line 905 "../tools/ipf_y.y"
{ ipf_yyval.ipp.a.in4 = ipf_yyvsp[0].ipa;
					  ipf_yyval.ipp.m.in4_addr = 0xffffffff;
					  ipf_yyexpectaddr = 0; }
break;
case 237:
#line 908 "../tools/ipf_y.y"
{ ipf_yyresetdict();
					  ipf_yyval.ipp.a.in4_addr = ipf_yyvsp[0].ipa.s_addr; }
break;
case 238:
#line 910 "../tools/ipf_y.y"
{ ipf_yysetdict(maskwords); }
break;
case 239:
#line 911 "../tools/ipf_y.y"
{ ipf_yyval.ipp.m.in4_addr = ipf_yyvsp[0].ipa.s_addr;
					  ipf_yyval.ipp.a.in4_addr &= ipf_yyvsp[0].ipa.s_addr;
					  ipf_yyresetdict();
					  ipf_yyexpectaddr = 0; }
break;
case 240:
#line 915 "../tools/ipf_y.y"
{ bcopy(&ipf_yyvsp[0].ip6, &ipf_yyval.ipp.a, sizeof(ipf_yyval.ipp.a));
					  fill6bits(128, (u_32_t *)&ipf_yyval.ipp.m);
					  ipf_yyresetdict();
					  ipf_yyexpectaddr = 0; }
break;
case 241:
#line 919 "../tools/ipf_y.y"
{ ipf_yyresetdict();
					  bcopy(&ipf_yyvsp[0].ip6, &ipf_yyval.ipp.a, sizeof(ipf_yyval.ipp.a)); }
break;
case 242:
#line 921 "../tools/ipf_y.y"
{ ipf_yysetdict(maskwords); }
break;
case 243:
#line 922 "../tools/ipf_y.y"
{ bcopy(&ipf_yyvsp[0].ip6, &ipf_yyval.ipp.m, sizeof(ipf_yyval.ipp.m));
					  ipf_yyresetdict();
					  ipf_yyexpectaddr = 0; }
break;
case 246:
#line 932 "../tools/ipf_y.y"
{ ipf_yyval.ipa = ipf_yyvsp[0].ipa; }
break;
case 247:
#line 933 "../tools/ipf_y.y"
{ ipf_yyval.ipa.s_addr = htonl(ipf_yyvsp[0].num); }
break;
case 248:
#line 934 "../tools/ipf_y.y"
{ ntomask(4, ipf_yyvsp[0].num, (u_32_t *)&ipf_yyval.ipa); }
break;
case 249:
#line 935 "../tools/ipf_y.y"
{ if (ifpflag == FRI_DYNAMIC) {
						ipf_yyval.ipa.s_addr = 0;
						ifpflag = FRI_BROADCAST;
					  } else
						YYERROR;
					}
break;
case 250:
#line 941 "../tools/ipf_y.y"
{ if (ifpflag == FRI_DYNAMIC) {
						ipf_yyval.ipa.s_addr = 0;
						ifpflag = FRI_NETWORK;
					  } else
						YYERROR;
					}
break;
case 251:
#line 947 "../tools/ipf_y.y"
{ if (ifpflag == FRI_DYNAMIC) {
						ipf_yyval.ipa.s_addr = 0;
						ifpflag = FRI_NETMASKED;
					  } else
						YYERROR;
					}
break;
case 252:
#line 953 "../tools/ipf_y.y"
{ if (ifpflag == FRI_DYNAMIC) {
						ipf_yyval.ipa.s_addr = 0;
						ifpflag = FRI_PEERADDR;
					  } else
						YYERROR;
					}
break;
case 253:
#line 962 "../tools/ipf_y.y"
{ ntomask(6, ipf_yyvsp[0].num, ipf_yyval.ip6.i6); }
break;
case 254:
#line 963 "../tools/ipf_y.y"
{ if (ifpflag == FRI_DYNAMIC) {
						bzero(&ipf_yyval.ip6, sizeof(ipf_yyval.ip6));
						ifpflag = FRI_BROADCAST;
					  } else
						YYERROR;
					}
break;
case 255:
#line 969 "../tools/ipf_y.y"
{ if (ifpflag == FRI_DYNAMIC) {
						bzero(&ipf_yyval.ip6, sizeof(ipf_yyval.ip6));
						ifpflag = FRI_BROADCAST;
					  } else
						YYERROR;
					}
break;
case 256:
#line 975 "../tools/ipf_y.y"
{ if (ifpflag == FRI_DYNAMIC) {
						bzero(&ipf_yyval.ip6, sizeof(ipf_yyval.ip6));
						ifpflag = FRI_BROADCAST;
					  } else
						YYERROR;
					}
break;
case 257:
#line 981 "../tools/ipf_y.y"
{ if (ifpflag == FRI_DYNAMIC) {
						bzero(&ipf_yyval.ip6, sizeof(ipf_yyval.ip6));
						ifpflag = FRI_BROADCAST;
					  } else
						YYERROR;
					}
break;
case 258:
#line 990 "../tools/ipf_y.y"
{ ipf_yyval.ipa = ipf_yyvsp[0].ipa; }
break;
case 259:
#line 991 "../tools/ipf_y.y"
{ ipf_yyval.ipa.s_addr = ipf_yyvsp[0].num; }
break;
case 260:
#line 992 "../tools/ipf_y.y"
{ ipf_yyval.ipa.s_addr = ipf_yyvsp[0].num; }
break;
case 261:
#line 993 "../tools/ipf_y.y"
{ ipf_yyval.ipa.s_addr = lookuphost(ipf_yyvsp[0].str);
					  free(ipf_yyvsp[0].str);
					}
break;
case 262:
#line 999 "../tools/ipf_y.y"
{ ipf_yyval.alist = newalist(NULL);
			  bcopy(&(ipf_yyvsp[0].ipp.a), &(ipf_yyval.alist->al_i6addr), sizeof(ipf_yyvsp[0].ipp.a));
			  bcopy(&(ipf_yyvsp[0].ipp.m), &(ipf_yyval.alist->al_i6mask), sizeof(ipf_yyvsp[0].ipp.m)); }
break;
case 263:
#line 1003 "../tools/ipf_y.y"
{ ipf_yyval.alist = newalist(ipf_yyvsp[-2].alist);
			  bcopy(&(ipf_yyvsp[0].ipp.a), &(ipf_yyval.alist->al_i6addr), sizeof(ipf_yyvsp[0].ipp.a));
			  bcopy(&(ipf_yyvsp[0].ipp.m), &(ipf_yyval.alist->al_i6mask), sizeof(ipf_yyvsp[0].ipp.m)); }
break;
case 264:
#line 1008 "../tools/ipf_y.y"
{ ipf_yyexpectaddr = 0; ipf_yycont = NULL; ipf_yyresetdict(); }
break;
case 265:
#line 1011 "../tools/ipf_y.y"
{ ipf_yyexpectaddr = 0; ipf_yycont = NULL; ipf_yyresetdict(); }
break;
case 266:
#line 1015 "../tools/ipf_y.y"
{ ipf_yyval.alist = newalist(NULL);
			  bcopy(&(ipf_yyvsp[0].ipp.a), &(ipf_yyval.alist->al_i6addr), sizeof(ipf_yyvsp[0].ipp.a));
			  bcopy(&(ipf_yyvsp[0].ipp.m), &(ipf_yyval.alist->al_i6mask), sizeof(ipf_yyvsp[0].ipp.m)); }
break;
case 267:
#line 1018 "../tools/ipf_y.y"
{ ipf_yyval.alist = newalist(NULL);
			  ipf_yyval.alist->al_not = 1;
			  bcopy(&(ipf_yyvsp[0].ipp.a), &(ipf_yyval.alist->al_i6addr), sizeof(ipf_yyvsp[0].ipp.a));
			  bcopy(&(ipf_yyvsp[0].ipp.m), &(ipf_yyval.alist->al_i6mask), sizeof(ipf_yyvsp[0].ipp.m)); }
break;
case 268:
#line 1023 "../tools/ipf_y.y"
{ ipf_yyval.alist = newalist(ipf_yyvsp[-2].alist);
			  bcopy(&(ipf_yyvsp[0].ipp.a), &(ipf_yyval.alist->al_i6addr), sizeof(ipf_yyvsp[0].ipp.a));
			  bcopy(&(ipf_yyvsp[0].ipp.m), &(ipf_yyval.alist->al_i6mask), sizeof(ipf_yyvsp[0].ipp.m)); }
break;
case 269:
#line 1027 "../tools/ipf_y.y"
{ ipf_yyval.alist = newalist(ipf_yyvsp[-3].alist);
			  ipf_yyval.alist->al_not = 1;
			  bcopy(&(ipf_yyvsp[0].ipp.a), &(ipf_yyval.alist->al_i6addr), sizeof(ipf_yyvsp[0].ipp.a));
			  bcopy(&(ipf_yyvsp[0].ipp.m), &(ipf_yyval.alist->al_i6mask), sizeof(ipf_yyvsp[0].ipp.m)); }
break;
case 270:
#line 1033 "../tools/ipf_y.y"
{ ipf_yyexpectaddr = 0;
					  ipf_yycont = NULL;
					}
break;
case 271:
#line 1038 "../tools/ipf_y.y"
{ ipf_yyval.num = ipf_yyvsp[0].num;
					  ipf_yysetdict(NULL); }
break;
case 272:
#line 1040 "../tools/ipf_y.y"
{ ipf_yyval.num = ipf_yyvsp[0].num; }
break;
case 273:
#line 1043 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_EQUAL;
					  ipf_yysetdict(NULL); }
break;
case 274:
#line 1047 "../tools/ipf_y.y"
{ ipf_yyexpectaddr = 0;
					  ipf_yycont = NULL;
					  ipf_yysetdict(NULL); }
break;
case 275:
#line 1053 "../tools/ipf_y.y"
{ ipf_yyval.pc.pc = ipf_yyvsp[-1].num;
					  ipf_yyval.pc.p1 = ipf_yyvsp[0].port;
					  ipf_yyresetdict(); }
break;
case 276:
#line 1059 "../tools/ipf_y.y"
{ ipf_yyval.pc.p1 = ipf_yyvsp[-2].port;
					  ipf_yyval.pc.pc = ipf_yyvsp[-1].num;
					  ipf_yyval.pc.p2 = ipf_yyvsp[0].port;
					  ipf_yyresetdict(); }
break;
case 279:
#line 1069 "../tools/ipf_y.y"
{ DOALL(fr->fr_icmp = htons(ipf_yyvsp[0].num << 8); fr->fr_icmpm = htons(0xff00););
	  ipf_yyresetdict();
	}
break;
case 280:
#line 1072 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 281:
#line 1076 "../tools/ipf_y.y"
{ setipftype();
						  ipf_yysetdict(icmptypewords); }
break;
case 283:
#line 1081 "../tools/ipf_y.y"
{ DOALL(fr->fr_icmp |= htons(ipf_yyvsp[0].num); fr->fr_icmpm |= htons(0xff););
	  ipf_yyresetdict();
	}
break;
case 284:
#line 1084 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 285:
#line 1088 "../tools/ipf_y.y"
{ ipf_yysetdict(icmpcodewords); }
break;
case 286:
#line 1093 "../tools/ipf_y.y"
{ DOREM(fr->fr_icmp = htons(ipf_yyvsp[0].num << 8); fr->fr_icmpm = htons(0xff00);) }
break;
case 287:
#line 1095 "../tools/ipf_y.y"
{ DOREM(fr->fr_icmp = htons(ipf_yyvsp[0].num << 8); fr->fr_icmpm = htons(0xff00);) }
break;
case 288:
#line 1100 "../tools/ipf_y.y"
{ DOREM(fr->fr_icmp |= htons(ipf_yyvsp[0].num); fr->fr_icmpm |= htons(0xff);) }
break;
case 289:
#line 1102 "../tools/ipf_y.y"
{ DOREM(fr->fr_icmp &= htons(0xff00); fr->fr_icmp |= htons(ipf_yyvsp[0].num); \
		fr->fr_icmpm |= htons(0xff);) }
break;
case 291:
#line 1106 "../tools/ipf_y.y"
{ DOALL(fr->fr_age[0] = ipf_yyvsp[0].num; \
						fr->fr_age[1] = ipf_yyvsp[0].num;) }
break;
case 292:
#line 1109 "../tools/ipf_y.y"
{ DOALL(fr->fr_age[0] = ipf_yyvsp[-2].num; \
						fr->fr_age[1] = ipf_yyvsp[0].num;) }
break;
case 296:
#line 1118 "../tools/ipf_y.y"
{ DOALL(fr->fr_flags |= FR_KEEPSTATE;)}
break;
case 297:
#line 1122 "../tools/ipf_y.y"
{ DOALL(fr->fr_flags |= FR_KEEPFRAG;) }
break;
case 298:
#line 1123 "../tools/ipf_y.y"
{ DOALL(fr->fr_flags |= FR_KEEPFRAG;) }
break;
case 303:
#line 1136 "../tools/ipf_y.y"
{ DOALL(fr->fr_flags |= FR_FRSTRICT;) }
break;
case 308:
#line 1149 "../tools/ipf_y.y"
{ DOALL(fr->fr_statemax = ipf_yyvsp[0].num;) }
break;
case 309:
#line 1150 "../tools/ipf_y.y"
{ DOALL(if (fr->fr_proto != IPPROTO_TCP) { \
						YYERROR; \
					  } else \
						fr->fr_flags |= FR_STSTRICT;)
				}
break;
case 310:
#line 1155 "../tools/ipf_y.y"
{ DOALL(if (fr->fr_proto != IPPROTO_TCP) { \
						YYERROR; \
					  } else \
						fr->fr_flags |= FR_NEWISN;)
				}
break;
case 311:
#line 1160 "../tools/ipf_y.y"
{ DOALL(fr->fr_flags |= FR_NOICMPERR;) }
break;
case 312:
#line 1162 "../tools/ipf_y.y"
{ DOALL(fr->fr_flags |= FR_STATESYNC;) }
break;
case 313:
#line 1163 "../tools/ipf_y.y"
{ DOALL(fr->fr_age[0] = ipf_yyvsp[0].num; \
						fr->fr_age[1] = ipf_yyvsp[0].num;) }
break;
case 314:
#line 1166 "../tools/ipf_y.y"
{ DOALL(fr->fr_age[0] = ipf_yyvsp[-2].num; \
						fr->fr_age[1] = ipf_yyvsp[0].num;) }
break;
case 315:
#line 1171 "../tools/ipf_y.y"
{ if (getport(frc, ipf_yyvsp[0].str, &(ipf_yyval.port)) == -1)
						ipf_yyerror("service unknown");
					  ipf_yyval.port = ntohs(ipf_yyval.port);
					  free(ipf_yyvsp[0].str);
					}
break;
case 316:
#line 1176 "../tools/ipf_y.y"
{ if (ipf_yyvsp[0].num > 65535)	/* Unsigned */
						ipf_yyerror("invalid port number");
					  else
						ipf_yyval.port = ipf_yyvsp[0].num;
					}
break;
case 317:
#line 1184 "../tools/ipf_y.y"
{ nowith = 0; }
break;
case 318:
#line 1185 "../tools/ipf_y.y"
{ nowith = 0; }
break;
case 319:
#line 1186 "../tools/ipf_y.y"
{ nowith = 0; }
break;
case 320:
#line 1190 "../tools/ipf_y.y"
{ DOALL(fr->fr_flx |= ipf_yyvsp[0].num; fr->fr_mflx |= ipf_yyvsp[0].num;) }
break;
case 321:
#line 1191 "../tools/ipf_y.y"
{ DOALL(fr->fr_mflx |= ipf_yyvsp[0].num;) }
break;
case 322:
#line 1192 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 323:
#line 1193 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 324:
#line 1194 "../tools/ipf_y.y"
{ ipf_yyresetdict(); }
break;
case 325:
#line 1197 "../tools/ipf_y.y"
{ ipf_yysetdict(ipv4optwords); }
break;
case 326:
#line 1201 "../tools/ipf_y.y"
{ if (use_inet6 == 0)
				ipf_yyerror("only available with IPv6");
			  ipf_yysetdict(ipv6optwords);
			}
break;
case 327:
#line 1208 "../tools/ipf_y.y"
{ nowith = 1; }
break;
case 328:
#line 1209 "../tools/ipf_y.y"
{ nowith = 1; }
break;
case 329:
#line 1213 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_OPTIONS; }
break;
case 330:
#line 1214 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_SHORT; }
break;
case 331:
#line 1215 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_NATED; }
break;
case 332:
#line 1216 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_BAD; }
break;
case 333:
#line 1217 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_BADNAT; }
break;
case 334:
#line 1218 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_BADSRC; }
break;
case 335:
#line 1219 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_LOWTTL; }
break;
case 336:
#line 1220 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_FRAG; }
break;
case 337:
#line 1221 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_FRAGBODY; }
break;
case 338:
#line 1222 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_FRAG; }
break;
case 339:
#line 1223 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_MBCAST; }
break;
case 340:
#line 1224 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_MULTICAST; }
break;
case 341:
#line 1225 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_BROADCAST; }
break;
case 342:
#line 1226 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_STATE; }
break;
case 343:
#line 1227 "../tools/ipf_y.y"
{ ipf_yyval.num = FI_OOW; }
break;
case 344:
#line 1230 "../tools/ipf_y.y"
{ DOALL(fr->fr_mip.fi_optmsk |= ipf_yyvsp[0].num;
				if (!nowith)
					fr->fr_ip.fi_optmsk |= ipf_yyvsp[0].num;)
			}
break;
case 345:
#line 1237 "../tools/ipf_y.y"
{ ipf_yyval.num |= ipf_yyvsp[0].num; }
break;
case 346:
#line 1238 "../tools/ipf_y.y"
{ ipf_yyval.num |= ipf_yyvsp[-2].num | ipf_yyvsp[0].num; }
break;
case 347:
#line 1242 "../tools/ipf_y.y"
{ DOALL(fr->fr_mip.fi_optmsk |= ipf_yyvsp[0].num;
				if (!nowith)
					fr->fr_ip.fi_optmsk |= ipf_yyvsp[0].num;)
			}
break;
case 348:
#line 1249 "../tools/ipf_y.y"
{ ipf_yyval.num |= ipf_yyvsp[0].num; }
break;
case 349:
#line 1250 "../tools/ipf_y.y"
{ ipf_yyval.num |= ipf_yyvsp[-2].num | ipf_yyvsp[0].num; }
break;
case 350:
#line 1254 "../tools/ipf_y.y"
{ ipf_yyval.num |= ipf_yyvsp[0].num; }
break;
case 351:
#line 1255 "../tools/ipf_y.y"
{ ipf_yyval.num |= ipf_yyvsp[-2].num | ipf_yyvsp[0].num; }
break;
case 352:
#line 1259 "../tools/ipf_y.y"
{ ipf_yyval.num = secbit(IPSO_CLASS_UNCL); }
break;
case 353:
#line 1260 "../tools/ipf_y.y"
{ ipf_yyval.num = secbit(IPSO_CLASS_CONF); }
break;
case 354:
#line 1261 "../tools/ipf_y.y"
{ ipf_yyval.num = secbit(IPSO_CLASS_RES1); }
break;
case 355:
#line 1262 "../tools/ipf_y.y"
{ ipf_yyval.num = secbit(IPSO_CLASS_RES2); }
break;
case 356:
#line 1263 "../tools/ipf_y.y"
{ ipf_yyval.num = secbit(IPSO_CLASS_RES3); }
break;
case 357:
#line 1264 "../tools/ipf_y.y"
{ ipf_yyval.num = secbit(IPSO_CLASS_RES4); }
break;
case 358:
#line 1265 "../tools/ipf_y.y"
{ ipf_yyval.num = secbit(IPSO_CLASS_SECR); }
break;
case 359:
#line 1266 "../tools/ipf_y.y"
{ ipf_yyval.num = secbit(IPSO_CLASS_TOPS); }
break;
case 360:
#line 1270 "../tools/ipf_y.y"
{ ipf_yyval.num = ipf_yyvsp[0].num; }
break;
case 361:
#line 1271 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH; }
break;
case 362:
#line 1272 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_ECHO; }
break;
case 363:
#line 1273 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_ECHOREPLY; }
break;
case 364:
#line 1274 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_SOURCEQUENCH; }
break;
case 365:
#line 1275 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_REDIRECT; }
break;
case 366:
#line 1276 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_TIMXCEED; }
break;
case 367:
#line 1277 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_PARAMPROB; }
break;
case 368:
#line 1278 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_TSTAMP; }
break;
case 369:
#line 1279 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_TSTAMPREPLY; }
break;
case 370:
#line 1280 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_IREQ; }
break;
case 371:
#line 1281 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_IREQREPLY; }
break;
case 372:
#line 1282 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_MASKREQ; }
break;
case 373:
#line 1283 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_MASKREPLY; }
break;
case 374:
#line 1284 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_ROUTERADVERT; }
break;
case 375:
#line 1285 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_ROUTERSOLICIT; }
break;
case 376:
#line 1289 "../tools/ipf_y.y"
{ ipf_yyval.num = ipf_yyvsp[0].num; }
break;
case 377:
#line 1290 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_NET; }
break;
case 378:
#line 1291 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_HOST; }
break;
case 379:
#line 1292 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_PROTOCOL; }
break;
case 380:
#line 1293 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_PORT; }
break;
case 381:
#line 1294 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_NEEDFRAG; }
break;
case 382:
#line 1295 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_SRCFAIL; }
break;
case 383:
#line 1296 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_NET_UNKNOWN; }
break;
case 384:
#line 1297 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_HOST_UNKNOWN; }
break;
case 385:
#line 1298 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_ISOLATED; }
break;
case 386:
#line 1299 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_NET_PROHIB; }
break;
case 387:
#line 1300 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_HOST_PROHIB; }
break;
case 388:
#line 1301 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_TOSNET; }
break;
case 389:
#line 1302 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_TOSHOST; }
break;
case 390:
#line 1303 "../tools/ipf_y.y"
{ ipf_yyval.num = ICMP_UNREACH_ADMIN_PROHIBIT; }
break;
case 391:
#line 1304 "../tools/ipf_y.y"
{ ipf_yyval.num = 14; }
break;
case 392:
#line 1305 "../tools/ipf_y.y"
{ ipf_yyval.num = 15; }
break;
case 393:
#line 1309 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_NOP); }
break;
case 394:
#line 1310 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_RR); }
break;
case 395:
#line 1311 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_ZSU); }
break;
case 396:
#line 1312 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_MTUP); }
break;
case 397:
#line 1313 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_MTUR); }
break;
case 398:
#line 1314 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_ENCODE); }
break;
case 399:
#line 1315 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_TS); }
break;
case 400:
#line 1316 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_TR); }
break;
case 401:
#line 1317 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_SECURITY); }
break;
case 402:
#line 1318 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_LSRR); }
break;
case 403:
#line 1319 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_E_SEC); }
break;
case 404:
#line 1320 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_CIPSO); }
break;
case 405:
#line 1321 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_SATID); }
break;
case 406:
#line 1322 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_SSRR); }
break;
case 407:
#line 1323 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_ADDEXT); }
break;
case 408:
#line 1324 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_VISA); }
break;
case 409:
#line 1325 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_IMITD); }
break;
case 410:
#line 1326 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_EIP); }
break;
case 411:
#line 1327 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_FINN); }
break;
case 412:
#line 1328 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_DPS); }
break;
case 413:
#line 1329 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_SDB); }
break;
case 414:
#line 1330 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_NSAPA); }
break;
case 415:
#line 1331 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_RTRALRT); }
break;
case 416:
#line 1332 "../tools/ipf_y.y"
{ ipf_yyval.num = getoptbyvalue(IPOPT_UMP); }
break;
case 417:
#line 1334 "../tools/ipf_y.y"
{ DOALL(fr->fr_mip.fi_secmsk |= ipf_yyvsp[0].num;
				if (!nowith)
					fr->fr_ip.fi_secmsk |= ipf_yyvsp[0].num;)
			  ipf_yyval.num = 0;
			  ipf_yyresetdict();
			}
break;
case 418:
#line 1343 "../tools/ipf_y.y"
{ ipf_yysetdict(ipv4secwords); }
break;
case 419:
#line 1347 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_AH); }
break;
case 420:
#line 1348 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_DSTOPTS); }
break;
case 421:
#line 1349 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_ESP); }
break;
case 422:
#line 1350 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_HOPOPTS); }
break;
case 423:
#line 1351 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_IPV6); }
break;
case 424:
#line 1352 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_NONE); }
break;
case 425:
#line 1353 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_ROUTING); }
break;
case 426:
#line 1354 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_FRAGMENT); }
break;
case 427:
#line 1355 "../tools/ipf_y.y"
{ ipf_yyval.num = getv6optbyvalue(IPPROTO_MOBILITY); }
break;
case 428:
#line 1358 "../tools/ipf_y.y"
{ setsyslog(); }
break;
case 429:
#line 1362 "../tools/ipf_y.y"
{ fr->fr_loglevel = LOG_LOCAL0|ipf_yyvsp[0].num; }
break;
case 430:
#line 1363 "../tools/ipf_y.y"
{ fr->fr_loglevel = ipf_yyvsp[-2].num | ipf_yyvsp[0].num; }
break;
case 431:
#line 1367 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_KERN; }
break;
case 432:
#line 1368 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_USER; }
break;
case 433:
#line 1369 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_MAIL; }
break;
case 434:
#line 1370 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_DAEMON; }
break;
case 435:
#line 1371 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_AUTH; }
break;
case 436:
#line 1372 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_SYSLOG; }
break;
case 437:
#line 1373 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LPR; }
break;
case 438:
#line 1374 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_NEWS; }
break;
case 439:
#line 1375 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_UUCP; }
break;
case 440:
#line 1376 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_CRON; }
break;
case 441:
#line 1377 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_FTP; }
break;
case 442:
#line 1378 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_AUTHPRIV; }
break;
case 443:
#line 1379 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_AUDIT; }
break;
case 444:
#line 1380 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LFMT; }
break;
case 445:
#line 1381 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LOCAL0; }
break;
case 446:
#line 1382 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LOCAL1; }
break;
case 447:
#line 1383 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LOCAL2; }
break;
case 448:
#line 1384 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LOCAL3; }
break;
case 449:
#line 1385 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LOCAL4; }
break;
case 450:
#line 1386 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LOCAL5; }
break;
case 451:
#line 1387 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LOCAL6; }
break;
case 452:
#line 1388 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_LOCAL7; }
break;
case 453:
#line 1389 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_SECURITY; }
break;
case 454:
#line 1393 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_EMERG; }
break;
case 455:
#line 1394 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_ALERT; }
break;
case 456:
#line 1395 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_CRIT; }
break;
case 457:
#line 1396 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_ERR; }
break;
case 458:
#line 1397 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_WARNING; }
break;
case 459:
#line 1398 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_NOTICE; }
break;
case 460:
#line 1399 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_INFO; }
break;
case 461:
#line 1400 "../tools/ipf_y.y"
{ ipf_yyval.num = LOG_DEBUG; }
break;
case 462:
#line 1404 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_EQUAL; }
break;
case 463:
#line 1405 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_NEQUAL; }
break;
case 464:
#line 1406 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_LESST; }
break;
case 465:
#line 1407 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_LESSTE; }
break;
case 466:
#line 1408 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_GREATERT; }
break;
case 467:
#line 1409 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_GREATERTE; }
break;
case 468:
#line 1412 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_INRANGE; }
break;
case 469:
#line 1413 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_OUTRANGE; }
break;
case 470:
#line 1414 "../tools/ipf_y.y"
{ ipf_yyval.num = FR_INCRANGE; }
break;
case 471:
#line 1418 "../tools/ipf_y.y"
{ ipf_yyval.str = ipf_yyvsp[0].str; }
break;
case 472:
#line 1421 "../tools/ipf_y.y"
{ ipf_yyval.str = ipf_yyvsp[0].str; }
break;
case 473:
#line 1423 "../tools/ipf_y.y"
{ ipf_yyval.str = ipf_yyvsp[-2].str;
		  fprintf(stderr, "%d: Logical interface %s:%d unsupported, "
			  "use the physical interface %s instead.\n",
			  ipf_yylineNum, ipf_yyvsp[-2].str, ipf_yyvsp[0].num, ipf_yyvsp[-2].str);
		}
break;
case 474:
#line 1430 "../tools/ipf_y.y"
{ ipf_yyval.str = ipf_yyvsp[0].str; }
break;
case 475:
#line 1431 "../tools/ipf_y.y"
{ ipf_yyval.str = strdup("-"); }
break;
case 476:
#line 1436 "../tools/ipf_y.y"
{ if (ipf_yyvsp[-2].num > 255 || ipf_yyvsp[0].num > 255) {
			ipf_yyerror("Invalid octet string for IP address");
			return 0;
		  }
		  ipf_yyval.ipa.s_addr = (ipf_yyvsp[-2].num << 24) | (ipf_yyvsp[0].num << 16);
		  ipf_yyval.ipa.s_addr = htonl(ipf_yyval.ipa.s_addr);
		}
break;
case 477:
#line 1447 "../tools/ipf_y.y"
{ if (ipf_yyvsp[0].num > 255) {
			ipf_yyerror("Invalid octet string for IP address");
			return 0;
		  }
		  ipf_yyval.ipa.s_addr |= htonl(ipf_yyvsp[0].num << 8);
		}
break;
case 478:
#line 1456 "../tools/ipf_y.y"
{ if (ipf_yyvsp[0].num > 255) {
			ipf_yyerror("Invalid octet string for IP address");
			return 0;
		  }
		  ipf_yyval.ipa.s_addr |= htonl(ipf_yyvsp[0].num);
		}
break;
#line 4751 "y.tab.c"
    }
    ipf_yyssp -= ipf_yym;
    ipf_yystate = *ipf_yyssp;
    ipf_yyvsp -= ipf_yym;
    ipf_yym = ipf_yylhs[ipf_yyn];
    if (ipf_yystate == 0 && ipf_yym == 0)
    {
#if YYDEBUG
        if (ipf_yydebug)
            printf("%sdebug: after reduction, shifting from state 0 to\
 state %d\n", YYPREFIX, YYFINAL);
#endif
        ipf_yystate = YYFINAL;
        *++ipf_yyssp = YYFINAL;
        *++ipf_yyvsp = ipf_yyval;
        if (ipf_yychar < 0)
        {
            if ((ipf_yychar = ipf_yylex()) < 0) ipf_yychar = 0;
#if YYDEBUG
            if (ipf_yydebug)
            {
                ipf_yys = 0;
                if (ipf_yychar <= YYMAXTOKEN) ipf_yys = ipf_yyname[ipf_yychar];
                if (!ipf_yys) ipf_yys = "illegal-symbol";
                printf("%sdebug: state %d, reading %d (%s)\n",
                        YYPREFIX, YYFINAL, ipf_yychar, ipf_yys);
            }
#endif
        }
        if (ipf_yychar == 0) goto ipf_yyaccept;
        goto ipf_yyloop;
    }
    if ((ipf_yyn = ipf_yygindex[ipf_yym]) && (ipf_yyn += ipf_yystate) >= 0 &&
            ipf_yyn <= YYTABLESIZE && ipf_yycheck[ipf_yyn] == ipf_yystate)
        ipf_yystate = ipf_yytable[ipf_yyn];
    else
        ipf_yystate = ipf_yydgoto[ipf_yym];
#if YYDEBUG
    if (ipf_yydebug)
        printf("%sdebug: after reduction, shifting from state %d \
to state %d\n", YYPREFIX, *ipf_yyssp, ipf_yystate);
#endif
    if (ipf_yyssp >= ipf_yysslim && ipf_yygrowstack())
    {
        goto ipf_yyoverflow;
    }
    *++ipf_yyssp = ipf_yystate;
    *++ipf_yyvsp = ipf_yyval;
    goto ipf_yyloop;

ipf_yyoverflow:
    ipf_yyerror("yacc stack overflow");

ipf_yyabort:
    return (1);

ipf_yyaccept:
    return (0);
}
